//self.aboutCopyright(copy);

define(["jquery","jqueryui","jqueryuictxm","knockout","modules/server/ioHandler","modules/fs/directories","modules/html/toolbar","modules/settings/config","modules/actions/frameActions","modules/graph/graphConstants","modules/gallery/components","modules/gallery/iconOptionsPicker","modules/gallery/portIconPicker","modules/gallery/cardinalityPicker","modules/gallery/decisionEnds","modules/erd/dbRecords","modules/erd/dbConstants","modules/flow/flowManager","modules/flow/flowUtils","modules/fs/fsBrowser","modules/diagram/mouseInteractor","modules/dialogs/newFlowDialog","modules/dialogs/newFolderDialog","modules/dialogs/openFlowDialog","modules/dialogs/nodePropsDialog","modules/dialogs/importExportDialog","modules/dialogs/findDialog","modules/dialogs/linkPropsDialog","modules/dialogs/dbTableEditor","modules/dialogs/aboutDialog","modules/util/startText","modules/dialogs/infoDialog","modules/dialogs/confirmDialog","modules/dialogs/confirmDialog2","modules/dialogs/confirmSrvDialog","modules/dialogs/thumbnailDialog","modules/settings/settingsDialog","modules/geometry/point","modules/util/utils","modules/draw/draw"],function(e,t,a,i,o,n,s,r,l,d,c,u,g,b,m,p,v,T,f,I,h,y,D,w,C,E,N,S,B,L,x,O,k,P,F,M,R,A,V,H){function _(e){e===d.flow().VERTICAL?(ye.removeClass("block-extendV"),ye.addClass("block-extendH"),De.removeClass("block-extendH"),De.addClass("block-extendV"),we.removeClass("block-shrinkV"),we.addClass("block-shrinkH"),Ce.removeClass("block-shrinkH"),Ce.addClass("block-shrinkV")):e===d.flow().HORIZONTAL&&(ye.removeClass("block-extendH"),ye.addClass("block-extendV"),De.removeClass("block-extendV"),De.addClass("block-extendH"),we.removeClass("block-shrinkH"),we.addClass("block-shrinkV"),Ce.removeClass("block-shrinkV"),Ce.addClass("block-shrinkH"))}function K(e){e===d.flow().VERTICAL?(Se.removeClass("block-extendV"),Se.addClass("block-extendH"),Be.removeClass("block-shrinkV"),Be.addClass("block-shrinkH")):e===d.flow().HORIZONTAL&&(Se.removeClass("block-extendH"),Se.addClass("block-extendV"),Be.removeClass("block-shrinkH"),Be.addClass("block-shrinkV"))}function W(e){if(Q.selectedFileType()===d.fileTypes().ALL)return e;var t=[],a=Q.selectedFileType().split(".").pop();return e.forEach(function(e){e.split(".").pop()===a&&t.push(e)}),t}function G(){e("#openSaveButtonOK").button("option","disabled",Q.isFlowSaveBlocked())}function z(e){r.setFlowDirection(e),U(e),Q.setFlowDirectionChange(),_(e),K(e),Q.getFlowManager().hasDiagramOpen()&&Q.manager.setDirty(!0),Q.setConfirmFlag(d.bValue().FALSE),Q.getFlowManager().setSettingsChanged(!0),setTimeout(function(){Q.getFlowManager().refreshDiagramOnEdit(!0),Q.getFlowManager().refreshDiagramOnEdit(!0)},200)}function U(e){e===d.flow().VERTICAL?f.updateDecisionInputs(Q.manager.getModelHandler().getFlowNodes(),d.decisionInputs().NORTH):e===d.flow().HORIZONTAL&&f.updateDecisionInputs(Q.manager.getModelHandler().getFlowNodes(),d.decisionInputs().WEST)}function Z(){Ze.detach(),Ye.detach(),je.detach(),qe.detach(),Je.detach(),Xe.detach(),$e.detach(),Qe.detach(),et.detach(),tt.detach(),at.detach(),it.detach(),ot.detach(),nt.detach(),st.detach(),rt.detach(),lt.detach(),dt.detach(),ct.detach()}function Y(e){Ze.appendTo(e),Ye.appendTo(e),je.appendTo(e),qe.appendTo(e),Je.appendTo(e),Xe.appendTo(e),$e.appendTo(e),Qe.appendTo(e),et.appendTo(e),tt.appendTo(e),at.appendTo(e),it.appendTo(e),ot.appendTo(e),nt.appendTo(e),st.appendTo(e),rt.appendTo(e),lt.appendTo(e),dt.appendTo(e),ct.appendTo(e)}function q(e){r.setToolbarPosition(e),Z(),r.getToolbarPosition()===d.toolbarPosition().SELF_ADJUST||r.getToolbarPosition()===d.toolbarPosition().HORIZONTAL?(ut.css("grid-template-rows","40px 40px auto"),bt.css("grid-template-columns","fit-content(0) auto 214px;"),Tt.css("visibility","hidden"),pt.css("visibility","hidden"),vt.css("visibility","hidden"),mt.css("visibility","visible"),gt.css("height","32px"),Y(mt),ft.removeClass("startHereVTip"),ft.addClass("startHereHTip")):r.getToolbarPosition()===d.toolbarPosition().VERTICAL&&(ut.css("grid-template-rows","40px 10px auto"),bt.css("grid-template-columns","fit-content(0) auto 214px;"),mt.css("visibility","hidden"),Tt.css("visibility","visible"),pt.css("visibility","visible"),vt.css("visibility","visible"),gt.css("height","2px"),Y(vt),ft.removeClass("startHereHTip"),ft.addClass("startHereVTip"))}function j(){var t=e(window).scrollTop(),a=document.getElementById("screenId").offsetWidth;Tt.css("height",t+"px"),vt.css("top",t+"px"),t>ht?r.getToolbarPosition()!==d.toolbarPosition().SELF_ADJUST&&r.getToolbarPosition()!==d.toolbarPosition().HORIZONTAL||q(d.toolbarPosition().VERTICAL):r.getToolbarPosition()===d.toolbarPosition().VERTICAL&&a>It&&q(d.toolbarPosition().HORIZONTAL)}function J(){Q.flowTabVisible(!1),Q.erdTabVisible(!1),Q.logTabVisible(!1),Q.procTabVisible(!1)}function X(){var e=document.getElementById("containerId").clientWidth;ee.width>e&&r.hasShowBottomMessages()&&Q.showBottomMessage("Drag the mouse on canvas to scroll")}function $(){var t=e(window).height();e(window).scrollTop();Bt.height(t-St)}var Q=this,ee=document.getElementById("canvasId"),te=document.getElementById("canvasThId"),ae=ee.getContext("2d"),ie=document.getElementById("containerId"),oe=document.getElementById("topContainerId"),ne=e("#openFlowDialogId"),se=e("#spinnerLevelsId"),re=e("#spinnerLanesId"),le=(e("#spinnerSpaceId"),e("#confirmDialogId")),de=e("#confirmDialog2Id"),ce=e("#confirmSrvDialogId"),ue=(e("#thumbnailDialogId"),document.getElementById("scaleId")),ge=e("#nodePropsTabId"),be=document.getElementById("paletteCtrId"),me="[Select Diagram Type, then Start...| Open...| Template...]",pe=!1,ve=!1,Te=!1;Q.cnxOn=i.observable(d.cnxOn()),Q.cnxOff=i.observable(d.cnxOff()),Q.diagramAllText=i.observable(x.getDiagramTextAll()),Q.titleTopText=i.observable(x.getTitleTopText()),Q.titleSelectText=i.observable(x.getTitleSelectText()),Q.titleBottomText=i.observable(x.getTitleBottomText()),Q.getERDText=i.observable(x.getERDText()),Q.getFlowText=i.observable(x.getFlowText()),Q.accHdrFlowTitle=i.observable(d.appTitles().FLOW_TITLE),Q.accHdrSideTitle=i.observable(d.appTitles().SIDE_TITLE),Q.accHdrMiscTitle=i.observable(d.appTitles().MISC_TITLE),Q.accHdrERDTitle=i.observable(d.appTitles().DB_ERD_TITLE),Q.accHdrLOGTitle=i.observable(d.appTitles().DB_LOG_TITLE),Q.accHdrPROCTitle=i.observable(d.appTitles().PROCESS_TITLE),Q.accHdrPagesTitle=i.observable(d.appTitles().PAGES_TITLE),Q.accHdrBpelTitle=i.observable(d.appTitles().BPEL_TITLE),Q.accHdrK8sTitle=i.observable(d.appTitles().K8S_TITLE),Q.getCanvas=function(){return ee},Q.setCanvas=function(e){ee=e},Q.getCanvasContext=function(){return ae},Q.getCanvasTh=function(){return te},Q.setCanvasTh=function(e){te=e},Q.getCanvasContext=function(){return ae},Q.getCanvasContainer=function(){return ie},Q.manager=new T(Q),Q.interactor=Q.manager.getMouseInteractor(),Q.dndHandler=Q.manager.getDnDHandler(),Q.updateTrigger=i.observable(!1);var fe=new I(Q);Q.getFlowManager=function(){return Q.manager},Q.isConnectionOK=i.observable(!1),Q.cnxResultOK=function(){Q.showOverlayMessage("Connected to server",1e3),Q.isConnectionOK(!0),setTimeout(function(){Q.updateWindow()},200),Q.isFirstCall(!0),Q.manager.getInstallSettings(),Q.callStartPage(!0),Q.cnxInfo(!0)},Q.setCnxValue=function(t,a){Q.isConnectionOK(t),Q.cnxInfo(t),a&&(Q.showOverlayMessage(t?"Connected to server":"No server connection",1e3),Q.isFirstCall(!0),Q.manager.getInstallSettings(),Q.callStartPage(!0)),setTimeout(function(){Q.updateWindow()},200),t||(Q.showOverlayMessage("No server connection",1200),a||(e(".ui-dialog-content").dialog("close"),Q.callStartPage(!0)),setTimeout(function(){console.clear()},2e3))},Q.cnxResultFAIL=function(e){Q.showOverlayMessage("No server connection",1e3),Q.isConnectionOK(!1),setTimeout(function(){console.clear(),Q.updateWindow()},200),Q.isFirstCall(!0),Q.manager.getInstallSettings(),Q.callStartPage(!0),Q.cnxInfo(!1)},Q.cnxInfo=i.observable(!1),Q.isFirstCall=i.observable(!1),e(document).ready(function(){function t(e){Q.isDgmFlow(e)}function a(t){return e("<img>",{style:"margin: 0 6px -2px -22px;",src:u.getIconURL(t.value)})}function o(t){return e("<img>",{style:"margin: 0 6px -2px 0;",src:u.getIconURL(t.value)})}function n(t){return e("<img>",{style:"margin: 0px 6px 2px 10px; ",src:g.getPortIconURL(t.value)})}function c(t){return e("<img>",{style:"margin: 0 6px -2px 6px; background-color: white; }",src:g.getPortIconURL(t.value)})}ae.canvas.width=0,ae.canvas.height=0,y.initDialog(Q.manager),D.initDialog(Q.manager),w.initDialog(Q.manager),R.initDialog(Q.manager),C.initDialog(Q.manager),E.initDialog(Q.manager),N.initDialog(Q.manager),S.initDialog(Q.manager),L.initDialog(Q.manager),O.initDialog(Q.manager),k.initDialog(Q.manager),P.initDialog(Q.manager),F.initDialog(Q.manager),M.initDialog(Q.manager),s.initButtons(Q),l.initActions(Q),e("#startLogoBtnId").attr("disabled",!0),e("#aboutLogoBtnId").attr("disabled",!0),e("#canvasId").contextmenu(Q.interactor.getContextMenu()),oe.addEventListener("mousemove",function(t){Q.interactor.isOverCanvas(t)||(e("#canvasId").contextmenu("close"),Q.manager.getFlowDiagram().setMousePoint(void 0))}),e("#paletteAccordionId").accordion({heightStyle:"fill",animate:{easing:"swing",duration:200},collapsible:!0,create:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header").css("height","12"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE")},activate:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE");a.newHeader.context&&a.newHeader.context.innerText;Q.updateWindow()}}),setTimeout(function(){e("#paletteAccordionId").accordion("option","icons",{header:"ui-icon-triangle-1-e",activeHeader:"ui-icon-triangle-1-s"})},100),e("#accTableFlowId").height(262),e("#accTableMiscsId").height(184),e("#accTableERDId").height(80),e("#accTableLOGId").height(184),e("#accTablePROCId").height(28),Q.isDgmFlow=i.observable(!1),e("#btnDgmModeDId").click(function(e,a){t(!0)}),e("#btnDgmModeUId").click(function(e,a){t(!1)}),Q.hasDiagram=i.observable(!1),Q.setDiagramOpen=function(e){Q.hasDiagram(e)},Q.showTemplatesOnly=i.observable(!1),e("#settingsTabId").tabs({}),e("#integrationTabId").tabs({}),e("textarea").keydown(function(t){33==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),t.target.setSelectionRange(0,0),e(this).scrollTop(0)),34==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),textareaLength=e(this).val().length,t.target.setSelectionRange(textareaLength,textareaLength),e(this).scrollTop(9999))}),ge.tabs({activate:function(e,t){1===t.newTab.index()?ge.css({overflow:"auto"}):ge.css({overflow:"hidden"})}}),e("#infoTextId").attr("visibility","hidden");var b=e("#progressBarId");b.progressbar({value:!1}),b.height(14),e.widget("nodeIcons.iconselectmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{text:u.getIconLabel(t.value)});return o(t).prependTo(a),a},_renderItem:function(t,i){var o=e("<li>"),n=e("<div>",{text:u.getIconLabel(i.value)});return a(i).prependTo(n),o.append(n).appendTo(t)},_renderMenu:function(t,a){var i=this,o=u.getOptionItems(a);e.each(o,function(e,a){i._renderItemData(t,a)})},refreshButtonItem:function(e,t){if(r.getDiagramType()===d.diagramType().FLOWCHART){var a=u.getIndexValue(e,t);this.element[0].selectedIndex=a,this.refresh()}}}),e("#nodeIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e("#settingIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e.widget("portImages.porticonmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{style:"padding-left: 16px; height: 16px; width: 100px; background-color: white"});return n(t).prependTo(a),a},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{style:"height: 16px; width: 120px"});return c(a).prependTo(o),i.append(o).appendTo(t)},_renderMenu:function(t,a){var i=this,o=g.getPortOptionItems(a);e.each(o,function(e,a){i._renderItemData(t,a)})},refreshButtonItem:function(e){var t=g.getPortIndexValue(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#selectPortIconsId").porticonmenu().porticonmenu("menuWidget").addClass("ui-menu-icons porticons"),e.widget("settings.schemenames",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.value})},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{text:a.value});return i.append(o).appendTo(t)},_renderMenu:function(t,a){var i=this,o=Q.manager.getSettingsManager().getOptionsPicker().getOptions();e.each(o,function(e,a){i._renderItemData(t,a)})},refreshButtonItem:function(e){var t=Q.manager.getSettingsManager().getOptionsPicker().getIndex(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#settingSchemesId").schemenames({width:240}).schemenames("menuWidget").addClass("ui-menu-icons schemenames"),e("#selectPartitionId").selectmenu({select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;console.log("$$$ disk select: "+a),Q.selectedPartition(a)}},change:function(e,t){e.currentTarget.textContent},create:function(e,t){setTimeout(function(){Q.manager.getDiskNames()},1e3)}}).addClass("settingsDiskMenu").css("fontSize","16px"),e("#selectFileTypeId").selectmenu({create:function(t,a){setTimeout(function(){Q.selectedFileType(d.fileTypes().ALL),e("#selectFileTypeId").selectmenu("refresh")},1e3)},select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;Q.selectedFileType(a),Q.manager.getDirContent()}}}).addClass("settingsDiskMenu"),e.widget("dbScripts.inOutmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{text:a.label});return i.append(o).appendTo(t)}}),e("#importExportId").inOutmenu({icons:{button:"ui-icon-blank"},width:160,background:"white",select:function(e,t){E.setDBSelected(document.getElementById("importExportId").value)}}).inOutmenu("menuWidget"),Q.refreshImportMenu=function(){e("#importExportId").inOutmenu("refresh")},e.widget("demomenu.demofilesmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},refreshButtonItem:function(e){this.refresh()}}),e("#selectFileId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#flowMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#dbMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#logMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#procMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#cnstrDBTypeId").selectmenu(),e("#dbCPKTypeId").selectmenu(),e("#dbCPKCol1").selectmenu(),e("#dbCPKCol2").selectmenu(),e("#dbCPKCol3").selectmenu(),e.widget("dbScripts.cstrtypes",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{text:a.label});return i.append(o).appendTo(t)},_renderMenu:function(t,a){var i=this;e.each(a,function(e,a){i._renderItemData(t,a)})}}),e("#cnstrDBTypeId").cstrtypes({icons:{button:"ui-icon-caret-1-s"},width:18}).cstrtypes("menuWidget").addClass("ui-menu-icons cstrtypes")}),Q.startHereVisible=i.pureComputed(function(){return!Q.hasDiagram()&&!Q.isStartPage()&&!Q.hasDialogsOpen()}),Q.hasDialogsOpen=i.observable(!1),Q.setHasDialogsOpen=function(e){Q.hasDialogsOpen(e),e||Q.hasDiagram()||Q.manager.clearDiagram(!0)},Q.disableInactiveTypeButtons=function(e){e?r.getDiagramType()===d.diagramType().ERD_DB?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=!e):r.getDiagramType()===d.diagramType().ERD_LOG?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e):(document.getElementById("btnFlowId").disabled=!e,document.getElementById("btnERDId").disabled=e):(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e)},Q.diagramTypeFlow=i.observable(d.diagramTypeText().FLOWCHART),Q.diagramTypeERD=i.observable(d.diagramTypeText().ERD_DB),Q.diagramTypeLOG=i.observable(d.diagramTypeText().ERD_LOG),Q.diagramTypeProc=i.observable(d.diagramTypeText().PROCESS),Q.enforceDiagramType=function(t){t===d.diagramTypeText().ERD_DB?(e("#btnERDId").prop("checked",!0),r.setDiagramType(d.diagramType().ERD_DB),r.setFlowDirection(d.flow().VERTICAL),Q.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",0),r.setShowNodeTasks(!1),r.setShowDBRecords(!0),r.setShowCardinality(!0),r.setShowRefHandles(!1),r.setShowNodeIcons(!1),r.setHideNodeNames(!1),r.setLinkStyle(d.linkStyle().STRAIGHT_LINE),r.setSegmentsGap(d.segmentsGap().MAX),r.setGridSpace(d.gridSpace().MAX),Q.isFirstCall(!1),Q.setERDTabVisible(),Q.selectedDBName().length):(e("#btnFlowId").prop("checked",!0),r.setDiagramType(d.diagramType().FLOWCHART),e("#btnHorizontal").prop("disabled",!1),document.getElementById("btnFlowVId").disabled=!1,e("#paletteAccordionId").accordion("option","active",1),r.setSegmentsGap(d.segmentsGap().MIN),r.setGridSpace(d.gridSpace().MIN),r.setHideNodeNames(!1),r.setShowDBRecords(!1),r.setShowCardinality(!1),r.setShowNodeTasks(!1),r.setLinkStyle(d.linkStyle().SINGLE_ARROW),Q.isFirstCall(!1),Q.showDBName(!1),Q.selectedDBName(""),Q.setFlowTabVisible()),Q.disableInactiveTypeButtons(!0),Q.updateWindow()},Q.showIconSelection=i.pureComputed(function(){return r.getDiagramType()===d.diagramType().FLOWCHART}),Q.dbsToImport=i.observableArray(E.currentDBTypes()),Q.dbsToExport=i.observableArray(E.currentDBTypes()),Q.showDBName=i.observable(!1),Q.selectedDBName=i.observable(""),Q.dbCallParams={},Q.isSelectedMySQL=i.computed(function(){return Q.selectedDBName()===v.mysql()}),Q.isSelectedT_SQL=i.computed(function(){return Q.selectedDBName()===v.t_sql()}),Q.dbSchemaName=i.observable(""),Q.callInOutDialog=function(){e("#importExportDialogId").dialog("open")},Q.isAutoLayoutAllowed=i.observable(r.isAllowAuto()),Q.dbNodeRecords=i.observableArray(),Q.showDBTableEditorOnLeft=i.observable(!1),Q.showDBCardinalityOnLeft=i.observable(!1),Q.showDBTable=i.observable(!0),Q.dbTableErrorMsg=i.observable(!1),Q.dbColumnKeys=i.observableArray(Q.manager.getDBTableEditor().dbColumnKeys()),Q.keyId=i.observable(""),Q.dbDataColumnTypes=i.observableArray(Q.manager.getDBTableEditor().dbColumnTypes()),Q.typeId=i.observable(""),Q.dbTableLength=i.observable(""),Q.showDBConstraints=i.observable(!1),Q.dbTableConstraints=i.observableArray(Q.manager.getDBTableEditor().dbTypeConstraints()),Q.showDBKeys=i.observable(!0),Q.showDBIndexes=i.observable(!1),Q.dbTableIndexes=i.observableArray(),Q.dbCompositePKs=i.observableArray(),Q.dbCompositePKTypes=i.observableArray(),Q.showDBCompositePK=i.observable(!0),Q.compositePKColumns=i.observableArray(),Q.isDefault=function(e){return console.log(e),"DEFAULT"!==e},Q.showDecisionEditorOnLeft=i.observable(!1),Q.nodeEmojiItems=i.pureComputed(function(){return u.getNodeIconOptions()}),Q.portIcons=i.pureComputed(function(){return g.getPortIconOptions()}),Q.cardinalityItems=i.pureComputed(function(){return b.getCardinalityList()}),Q.enableShowCardinality=i.observable(!1),Q.setEnableShowCardinality=function(e){Q.enableShowCardinality(e)},Q.enableShowDB=i.observable(!1),Q.setEnableShowDB=function(e){Q.enableShowDB(e)},Q.onOpsActionChange=function(e){},Q.isProgressBarVisible=i.observable(!1),Q.isProgressBarVisible.extend({notify:"always"}),Q.setProgressBarVisible=function(e){Q.isProgressBarVisible(e)},Q.showPageMode=i.observable(r.hasPageMode()),Q.isCanvasVisible=i.observable(!1),Q.setCanvasVisible=function(e){Q.isCanvasVisible(e)},Q.scaleValue=i.observable(r.getScale()),e("#scaleId").slider(),ue.oninput=function(){r.setScale(this.value/d.scale().FACTOR),Q.scaleValue(r.getScale()),Q.manager.clearClipboard(),Q.manager.getFlowDiagram().clearCanvas(),Q.manager.rebuildFlowData()},Q.editModeText=i.observable(r.isEditMode()&&!Q.showTemplatesOnly()?d.editModeText().EDIT:d.editModeText().VIEW),Q.setTooltipBox=function(e,t){e.length>0&&r.isEditMode()&&1===r.getScale()&&H.drawTooltip(ae,ee.getBoundingClientRect(),t,e)},Q.showTooltipBox=function(e){},Q.getCurrentShortFileName=function(){var e=Q.manager.getFileName(),t=e.indexOf(".json"),a=e.substring(0,t),i=a.lastIndexOf("/");return a.substring(i+1)};var Ie,he=document.getElementById("blockResizeId"),ye=e("#extendBlockAcrossId"),De=e("#extendBlockAlongId"),we=e("#shrinkBlockAcrossId"),Ce=e("#shrinkBlockAlongId");Q.showBlockResizeBar=function(e){var t=e.getExpandedShape(),a=r.getScale();he.style.left=ee.getBoundingClientRect().left+t.x*a+"px",he.style.top=ee.getBoundingClientRect().top+t.y*a-24+"px",ye.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),De.attr("disabled",!r.isEditMode()||!e.canExtendAlong()),we.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),Ce.attr("disabled",!r.isEditMode()||!e.canShrinkAlong()),he.style.visibility="visible"},Q.doResizeContainer=function(e){var t=Q.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().CONTAINER&&t[0].resizeOutline(e),he.style.visibility="hidden",Ie=!1},Q.isBlockResizeBarVisible=function(){return Ie},Q.hideContainerBar=function(){he.style.visibility="hidden"};var Ee,Ne=document.getElementById("switchResizeId"),Se=e("#extendSwitchAcrossId"),Be=e("#shrinkSwitchAcrossId");Q.showSwitchResizeBar=function(e){var t=e.getMenuBarPosition(),a=r.getScale();Ne.style.left=ee.getBoundingClientRect().left+t.x*a+"px",Ne.style.top=ee.getBoundingClientRect().top+t.y*a-24+"px",Se.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Be.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),Ne.style.visibility="visible"},Q.doResizeSwitch=function(e){var t=Q.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().SWITCH&&t[0].resizeOutline(e),Ne.style.visibility="hidden",Ee=!1},Q.isSwitchResizeBarVisible=function(){return Ee},Q.hideSwitchBar=function(){Ne.style.visibility="hidden"},Q.showSearchList=i.observable(!1),Q.showFindOptions=i.observable(!0),Q.searchContentList=i.observableArray(),Q.foundMatches=i.observable(),Q.onFindTableClick=function(e){var t=e.target.innerText;N.selectedNewDisk(t)},Q.onFindTableDblClick=function(e){Q.onFindTableClick(e)},Q.onPasteSearchText=function(e){N.selectedNewDisk(label)},Q.currentPath=i.observable(),Q.fsContentList=i.observableArray(),Q.selectedPath=i.observable(),Q.isOpenMode=i.observable(),Q.isSaveMode=i.observable(),Q.isImportDBMode=i.observable(),Q.isStartDBMode=i.observable(),Q.isExportDBMode=i.observable(),Q.showPartitions=i.observable(!1),Q.partitionsList=i.observableArray([""]),Q.selectedPartition=i.observable(),Q.filesTypes=i.observableArray([d.fileTypes().JSON,d.fileTypes().ALL]),Q.selectedFileType=i.observable(d.fileTypes().JSON);Q.onLogoClick=function(e){},Q.setShowTemplatesOnly=function(e){Q.showTemplatesOnly(e)},Q.callOpenFlowDialog=function(t,a){if(e("#paletteCtrId").show(),t){if(Q.setFSDialogMode(d.fsDialogMode().OPEN),Q.setShowTemplatesOnly(!0),r.getDiagramType()===d.diagramType().FLOWCHART)Q.flowTemplates(Q.manager.getTemplates().getFlowTemplatesList()),e("#flowMenuId").demofilesmenu("refresh");else if(r.getDiagramType()===d.diagramType().ERD_DB){if(!Q.selectedDBName())return void Q.callInOutDialog();Q.dbTemplates(Q.manager.getTemplates().getDBTemplatesList(Q.selectedDBName())),e("#dbMenuId").demofilesmenu("refresh")}else r.getDiagramType()===d.diagramType().ERD_LOG&&(Q.logTemplates(Q.manager.getTemplates().getLOGTemplatesList()),e("#logMenuId").demofilesmenu("refresh"));ne.dialog("open"),ne.dialog({height:180})}else a===d.importExportMode().IMPORT?(Q.setShowTemplatesOnly(!1),setTimeout(function(){Q.isConnectionOK()&&(ne.dialog({height:440}),Q.manager.getRootDir(),ne.dialog("open"))},20)):a===d.importExportMode().START?(Q.setShowTemplatesOnly(!1),setTimeout(function(){Q.isConnectionOK()&&(ne.dialog("open"),ne.dialog({height:180}))},20)):(Q.setShowTemplatesOnly(!1),setTimeout(function(){Q.isConnectionOK()?ne.dialog({height:440}):ne.dialog({height:180}),Q.manager.getRootDir(),ne.dialog("open")},20))},Q.onDiskTableClick=function(e){var t=e.target.innerText;w.selectedNewDisk(t)},Q.setFSDialogMode=function(e){fe.setFSDialogMode(e),Q.fsDialogMode(e)},Q.getFSDialogMode=function(){return fe.getFSDialogMode()},Q.fsDialogMode=i.observable(),Q.restoreWorkDir=function(){fe.restoreWorkDir()},Q.setWorkDir=function(e){fe.setWorkDir(e)},Q.getWorkDir=function(){return fe.getWorkDir()},Q.getSelectedFSDir=function(){return fe.getSelectedFSDir()},Q.getSelectedFSFile=function(){return fe.getSelectedFSFile()},Q.onDirTableClick=function(e){fe.onDirTableClick(e)},Q.deleteFSItem=function(){fe.deleteFSItem()},Q.onDirTableDblClick=function(e){fe.onDirTableDblClick(e)},Q.updateMainFSLocation=function(){fe.updateMainFSLocation()},Q.goOneDirBack=function(){fe.goOneDirBack()},Q.setDirsList=function(e,t){fe.setDirsList(e,t)},Q.setFolderContent=function(e,t){fe.setFolderContent(e,t)},Q.onFileTypeChange=function(e){fe.onFileTypeChange(e)},Q.showForegroundSelection=i.observable(!0),Q.showBackgroundSelection=i.observable(!0),Q.settingsSchemes=i.observableArray([]),Q.removeFromSettingsSchemes=function(e){for(var t=-1,a=0;a<Q.settingsSchemes().length;a++)if(Q.settingsSchemes()[a]===e){t=a;break}a>-1?Q.settingsSchemes.splice(t,1):alert("bad index for settingsSchemes: "+t)};var Le;Q.setNewAction=function(e){Le=e},Q.isNewAction=function(){return Le},Q.filesList=i.observableArray();var xe=[];Q.setFilesList=function(t){if(xe=t,Q.filesList(t),Q.filesList(W(t)),Le)e("#newFlowDialogId").dialog("open");else;},Q.selectedFile=i.observable(),Q.getSelectedFile=function(){return Q.isConnectionOK()?_selectedFile:Q.selectedFile()},Q.isInputInvalid=i.observable(!1),Q.validateMessage=i.observable(""),Q.newFSNameValue=i.observable(""),Q.nameValueEmpty=i.observable(""),Q.validateFSName=function(t,a){var i=V.trimMultipleSpaces(Q.newFSNameValue()),o=a?n.getDirectoriesLabels():Q.filesList();Q.nameValueEmpty(0===i.length);var s=(Q.isInputInvalid(),V.containsFSName(o,i)),r=V.isFSNameValid(Q.newFSNameValue()),l=i.length>0&&(!r||s);Q.isInputInvalid(l),e("#newFlowButtonOK").button("option","disabled",Q.isInputInvalid()||Q.nameValueEmpty()),e("#newFolderButtonOK").button("option","disabled",Q.isInputInvalid()||Q.nameValueEmpty()),r?s?Q.validateMessage("Duplicate name"):Q.validateMessage(""):Q.validateMessage("Only alphanumericals, slashes, dots, dashes, underscores"),t&&i.length>0&&r&&"Enter"===t.code&&(Le?(y.createNewDiagram(Q.manager),e("#newFlowDialogId").dialog("close")):(D.createNewFolder(Q.manager),e("#newFolderDialogId").dialog("close")))},Q.saveAsInputInvalid=i.observable(!1),Q.saveAsMessage=i.observable(""),Q.saveAsFileNameValue=i.observable(""),Q.saveAsNameEmpty=i.observable(""),Q.validateSaveAsFileName=function(e){var t=V.trimMultipleSpaces(Q.editNameValue());if(t.length>0){var a=V.containsFSName(Q.filesList(),t),i=V.isFSNameValid(t),o=!a&&i;Q.isEditNameInvalid(!o)}a?Q.validateNameMessage("Duplicate name"):i?Q.validateNameMessage(""):Q.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores")},Q.saveAsNewVersion=i.observable(1),Q.versionInputInvalid=i.observable(!1),Q.validateAsVersion=function(e){var t=(Q.saveAsNewVersion(),V.isVersionNumber(Q.saveAsNewVersion()));Q.versionInputInvalid(!t),G()},Q.isFlowSaveBlocked=function(){return Q.saveAsInputInvalid()||Q.saveAsNameEmpty()||Q.saveAsNewVersion()&&Q.versionInputInvalid()};var Oe=i.observable();Q.propsLinkSourceName=i.observable(),Q.propsLinkSourceLabel=i.observable(),Q.propsLinkTargetName=i.observable(),Q.propsLinkTargetLabel=i.observable(),Q.propsLinkLabel=i.observable(),Q.getPropsLink=function(){return Oe()},Q.getPropsLinkLabelValue=function(){return Q.propsLinkLabel()},Q.showLinkProps=function(t){Oe(t),Q.propsLinkSourceName(Oe().getLinkSourcePortName()),Q.propsLinkSourceLabel(Oe().getLinkSourcePortLabel()),Q.propsLinkTargetName(Oe().getLinkTargetPortName()),Q.propsLinkTargetLabel(Oe().getLinkTargetPortLabel()),Q.propsLinkLabel(Oe().getLinkLabel()),e("#linkPropsDialogId").dialog("open")},Q.propsFgndVisible=i.observable(!0),Q.setPropsFgndVisible=function(e){Q.propsFgndVisible(e)},Q.propsNodeInputs=i.observableArray();var ke,Pe;Q.getPropsNodeInputsIdx=function(){return ke},Q.getPropsNodeInputsValue=function(){return Pe},Q.propsNodeOutputs=i.observableArray();var Fe,Me;Q.getPropsNodeOutputsIdx=function(){return Fe},Q.getPropsNodeOutputsValue=function(){return Me},Q.propsNodeRefInputs=i.observableArray();var Re,Ae;Q.getPropsNodeRefInputsIdx=function(){return Re},Q.getPropsNodeRefInputsValue=function(){return Ae},Q.propsNodeRefOutputs=i.observableArray();var Ve,He;Q.getPropsNodeRefOutputsIdx=function(){return Ve},Q.getPropsNodeRefOutputsValue=function(){return He};var _e=i.observable();Q.setPropsNode=function(e){_e(e)},Q.getPropsNode=function(){return _e()},Q.propsNodeName=i.computed(function(){return _e()?_e().getName():"?"},this),Q.showNodeProps=function(t){_e(t),t.getFlowType()===d.flowType().DB_TABLE&&t.closeDBEditors(),u.setNodeCategory(t.getNodeCategory()),Q.propsNodeInputs(_e().getInputPortsProperties()),Q.propsNodeOutputs(_e().getOutputPortsProperties()),Q.propsNodeRefInputs(_e().getRefInPortsProperties()),Q.propsNodeRefOutputs(_e().getRefOutPortsProperties()),Q.dbNodeRecords(_e().getDBRecords()),e("#nodePropsDialogId").dialog("open")},Q.dbEditorPath=i.observable("?"),Q.setDBEditorPath=function(e){dbEditorPath(e)};var Ke=i.observable();Q.setPropsPort=function(e){Ke(e)},Q.getPropsPort=function(){return Ke()},Q.propsPortName=i.observable(""),Q.editPropsNodeInputLabel=function(e){ke=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeInputsTableId"),a=t.getElementsByTagName("tr");Pe=a[ke].cells[2].getElementsByTagName("input")[0].value},Q.checkPortInputCardinality=function(e){C.editPortInputCardinality(e)},Q.editPropsNodeOutputLabel=function(e){Fe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeOutputsTableId"),a=t.getElementsByTagName("tr");Me=a[Fe].cells[2].getElementsByTagName("input")[0].value},Q.checkPortOutputCardinality=function(e){C.editPortOutputCardinality(e)},Q.editPropsNodeRefInputLabel=function(e){Re=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefInputsTableId"),a=t.getElementsByTagName("tr");Ae=a[Re].cells[2].getElementsByTagName("input")[0].value},Q.checkPortRefInputCardinality=function(e){C.editPortRefInputCardinality(e)},Q.editPropsNodeRefOutputLabel=function(e){Ve=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefOutputsTableId"),a=t.getElementsByTagName("tr");He=a[Ve].cells[2].getElementsByTagName("input")[0].value},Q.checkPortRefOutputCardinality=function(e){C.editPortRefOutputCardinality(e)},Q.isEditNameInvalid=i.observable(!1),Q.editNameValue=i.observable(""),Q.newFlowNameValue=i.observable(""),Q.validateNameMessage=i.observable("");var We;Q.setOldName=function(e){We=e},Q.validateInlineNodeName=function(){var e=Q.manager.getInlineInputEditor().getCurrentValue(),t=V.trimMultipleSpaces(e);Q.validateEditName(t)},Q.validateDialogNodeName=function(){var e=V.trimMultipleSpaces(Q.editNameValue());Q.validateEditName(e)},Q.validateNewFlowName=function(){var e=V.trimMultipleSpaces(Q.editNameValue());Q.validateEditName(e)},Q.validateNewFolderName=function(){var e=V.trimMultipleSpaces(Q.editNameValue());Q.validateEditName(e)},Q.validateEditName=function(e){if(e.length>0){var t=V.getAllNames(Q.manager.getNodeNamesMap()),a=V.isDuplicateName(We,e,t),i=V.isNewNodeNameValid(e),o=!a&&i;Q.isEditNameInvalid(!o)}a?Q.validateNameMessage("Duplicate name"):i?Q.validateNameMessage(""):Q.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores")},Q.isSchemeNameInvalid=i.observable(!1),
Q.schemeNameValue=i.observable(""),Q.validateSchemeMessage=i.observable(""),Q.validateSchemeName=function(){var e=document.getElementById("newSchemeId").value;if(e.length>0){var t=Q.manager.getSettingsManager().getSchemeNames(),a=t.includes(e),i=V.isSchemeNameValid(e),o=!a&&i;Q.isSchemeNameInvalid(!o)}else Q.isSchemeNameInvalid(!1);a?Q.validateSchemeMessage("Duplicate name"):i?Q.validateSchemeMessage(""):Q.validateSchemeMessage("Only alphanumericals, dots, dashes and underscores")},Q.isLinkLabelInvalid=i.observable(!1),Q.linkLabelValue=i.observable(""),Q.validateLinkMessage=i.observable("");var Ge;Q.setOldLinkLabel=function(e){Ge=e},Q.validateLinkLabelName=function(e){var t=V.trimMultipleSpaces(Q.linkLabelValue());if(t.length>0){var a=t===Ge||V.isNewLinkLabelValid(t);Q.isLinkLabelInvalid(!a)}else Q.isLinkLabelInvalid(!1);a?Q.validateLinkMessage(""):Q.validateLinkMessage("Only alphanumericals, slashes, dots, dashes, underscores")},Q.isFieldInvalid=i.observable(!1),Q.fieldValue=i.observable(""),Q.validateFieldMessage=i.observable(""),Q.validateFieldName=function(){var e=document.getElementById("inputFieldId").value;if(e.length>0){var t=Q.manager.getDBTableEditor().getDBRecordsFields(),a=Q.manager.getDBTableEditor().getOldFieldValue(),i=t.includes(e),o=V.isDBFieldValid(e),n=e===a||!i&&o;Q.isFieldInvalid(!n)}else Q.isFieldInvalid(!1);i?Q.validateFieldMessage("Duplicate field"):o?Q.validateFieldMessage(""):Q.validateFieldMessage("Only alphanumericals, dots, dashes and underscores")},Q.isKeyInvalid=i.observable(!1),Q.validateKeyMessage=i.observable(""),Q.validateKeyValue=function(){var e=document.getElementById("inputKeyId").value,t=Q.manager.getDBTableEditor().getLabelById(Q.manager.getDBTableEditor().dbColumnKeys(),e);if(Q.isKeyInvalid(!1),t.length>0){var a=Q.manager.getDBTableEditor().getDBRecordsKeys(),i="PK"===t&&a.includes(t);Q.isKeyInvalid(i)}return i?Q.validateKeyMessage("Only composite primary key is allowed"):Q.validateKeyMessage(""),!i},Q.isCPKNameInvalid=i.observable(!1),Q.fieldCPKValue=i.observable(""),Q.validateCPKMessage=i.observable(""),Q.validateCPKName=function(){var e=Q.manager.getDBTableEditor().getNewCPKName();if(e.length>0){var t=Q.manager.getDBTableEditor().getOldCPKName(),a=V.isDBFieldValid(e),i=e===t||a;Q.isCPKNameInvalid(!i)}else Q.isCPKNameInvalid(!1);a?Q.validateCPKMessage(""):Q.validateCPKMessage("Only alphanumericals, dots, dashes and underscores")},Q.isDuplicateType=i.observable(!1),Q.duplicateConstraintMessage=i.observable("Duplicate constraint"),Q.pictureURLValue=i.observable(""),Q.isPictureURLInvalid=i.observable(!1),Q.validatePictureURL=function(e){Q.isPictureURLInvalid(!1)},Q.showNewFileName=i.observable(),Q.showEditedInfo=i.observable(),Q.showDecisionInfo=i.observable(),Q.decisionInputPicture=i.observable(),Q.decisionEndsPicture=i.observable(),Q.isNodeNameInvalid=i.observable(!1),Q.newNodeNameValue=i.observable(""),Q.invalidNameMessage=i.observable(""),Q.resetDecisionIndices=function(){Q.updateTrigger(!Q.updateTrigger()),m.resetCurrentIndices(),Q.decisionInputPicture(m.getCurrentInputPicture()),Q.decisionEndsPicture(m.getCurrentEndsPicture())},Q.btnFlowH2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&Q.changeFlowDirection(d.flow().VERTICAL)},Q.btnFlowV2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&Q.changeFlowDirection(d.flow().HORIZONTAL)},Q.changeFlowDirection=function(e){z(e)};var ze=!1;Q.hasFlowDirectionChange=function(){return ze},Q.setFlowDirectionChange=function(){ze=!0},Q.resetFlowDirectionChange=function(){ze=!1},Q.isHorizontal=i.observable(!1),Q.layoutModeText=i.observable(r.getLayoutModeText()),Q.diagramModeText=i.observable(r.getDiagramModeText());var Ue=e("#shutdownId"),Ze=e("#menuId"),Ye=e("#newId"),qe=e("#openId"),je=e("#templateId"),Je=e("#exportId"),Xe=e("#undoId"),$e=e("#redoId"),Qe=e("#deleteId"),et=e("#copyId"),tt=e("#pasteId"),at=e("#saveId"),it=e("#saveAsId"),ot=e("#refreshId"),nt=e("#findId"),st=e("#clearId"),rt=e("#leftId"),lt=e("#rightId"),dt=e("#configId"),ct=e("#helpId"),ut=(e("#btnFlowVId"),e("#btnThumbnailId"),e("#screenId")),gt=e("#navbarId"),bt=e("#topContainerId"),mt=e("#toolbarHId"),pt=e("#leftColumnId"),vt=e("#toolbarVId"),Tt=e("#tbVButtonId"),ft=e("#startHereId"),It=588,ht=36;Q.updateWindow=function(e){Q.updateTrigger(!Q.updateTrigger()),Q.isHorizontal(r.getFlowDirection()===d.flow().HORIZONTAL),Q.layoutModeText(r.getLayoutModeText()),Q.diagramModeText(r.getDiagramModeText());var t=!r.isEditMode();s.updateMenus(Q),Ue.attr("disabled",!Q.isConnectionOK()),Ye.attr("disabled",!Q.isConnectionOK()),qe.attr("disabled",!Q.isConnectionOK()),je.attr("disabled",!Q.isConnectionOK()),Je.attr("disabled",r.getDiagramType()!==d.diagramType().ERD_DB||Q.startHereVisible()||Q.isStartPage()||Q.manager.isTemplate()||Q.manager.isDirty()),Xe.attr("disabled",t||!Q.manager.canUndo()).attr("title",Q.manager.getUndoName()),$e.attr("disabled",t||!Q.manager.canRedo()).attr("title",Q.manager.getRedoName()),Qe.attr("disabled",t||!Q.manager.getSelectionManager().hasSelections()),et.attr("disabled",t||!Q.manager.canCopy()),tt.attr("disabled",t||!Q.manager.readyToPaste()),at.attr("disabled",t||!Q.isConnectionOK()||!Q.manager.isDirty()||Q.manager.isTemplate()),it.attr("disabled",t||!Q.isConnectionOK()||Q.manager.getModelHandler().isDiagramEmpty()),ot.attr("disabled",!Q.isCanvasVisible()),nt.attr("disabled",!Q.isCanvasVisible()),st.attr("disabled",t||!Q.isCanvasVisible()),rt.attr("disabled",!Q.manager.hasPreviousDiagram()),lt.attr("disabled",!Q.manager.hasNextDiagram()),"visible"!==document.getElementById("blockResizeId").style.visibility||Ie?Ie&&(document.getElementById("blockResizeId").style.visibility="hidden",Ie=!1):Ie=!0,"visible"!==document.getElementById("switchResizeId").style.visibility||Ee?Ee&&(document.getElementById("switchResizeId").style.visibility="hidden",Ee=!1):Ee=!0,Q.manager.isInitialResizeMode()&&Q.manager.getModelHandler().isDiagramEmpty()?(se.attr("disabled",!1),re.attr("disabled",!1)):(se.attr("disabled",!0),re.attr("disabled",!0)),Q.disableInactiveTypeButtons(!Q.manager.getModelHandler().isDiagramEmpty())},Q.initData=function(){Q.updateWindow()},Q.galleryFlowNodes=i.pureComputed(function(){return Q.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getFlowNodesH():c.getFlowNodesV()}),Q.galleryMiscNodes=i.pureComputed(function(){return Q.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getMiscNodesH():c.getMiscNodesV()}),Q.galleryERDNodes=i.pureComputed(function(){return Q.updateTrigger(),c.getERDNodes()}),Q.galleryLOGNodes=i.pureComputed(function(){return Q.updateTrigger(),c.getLOGNodes()}),Q.galleryProcNodes=i.pureComputed(function(){return Q.updateTrigger(),c.getProcNodes()}),Q.pageNodes=i.pureComputed(function(){Q.updateTrigger();for(var e=[],t=r.getFlowDirection()===d.flow().HORIZONTAL?c.getHPageItems():c.getVPageItems(),a=0;a<t.length;a++)e.push(t[a]);return e}),Q.diagramDisplayName=i.observable(me),Q.setDiagramDisplayName=function(e){e&&e.length>0?(Q.showTemplatesOnly()&&(e=d.templateToken()+": "+e),Q.diagramDisplayName(e)):Q.diagramDisplayName(me)},Q.taskActionInputValue=i.observable(""),Q.taskServiceInputValue=i.observable(""),Q.taskSubscribeInputValue=i.observable(""),Q.taskPublishInputValue=i.observable(""),Q.taskOperationInputValue=i.observable(""),Q.taskExpressionInputValue=i.observable(""),Q.showTaskAction=i.observable(!0),Q.showTaskService=i.observable(!0),Q.showTaskSubscribe=i.observable(!0),Q.showTaskPublish=i.observable(!0),Q.showTaskOperation=i.observable(!0),Q.showTaskExpression=i.observable(!0),Q.taskActionSelected=i.observable(!0),Q.taskServiceSelected=i.observable(!1),Q.taskSubscribeSelected=i.observable(!1),Q.taskPublishSelected=i.observable(!1),Q.taskOperationSelected=i.observable(!1),Q.taskExpressionSelected=i.observable(!1),Q.nodeActionList=i.observableArray(),Q.nodeOperationList=i.observableArray(),Q.nodeServiceList=i.observableArray(),Q.nodePublishList=i.observableArray(),Q.nodeSubscribeList=i.observableArray(),Q.showTaskEditorOnLeft=i.observable(!1),Q.aboutTitle=i.observable(""),Q.aboutVersion=i.observable(""),Q.aboutText=i.observable(""),Q.aboutSources=i.observable(""),Q.aboutCopyright=i.observable(""),Q.showAboutBox=function(t,a,i,o,n){Q.aboutTitle(t),Q.aboutVersion(a),Q.aboutText(i),Q.aboutSources(o),e("#aboutDialogId").dialog("open")},Q.welcomeTitle=i.observable(""),Q.welcomeGreeting=i.observable(""),Q.welcomeTo=i.observable(""),Q.welcomeTip=i.observable(""),Q.isStartPage=i.observable(!1);document.getElementById("startToTopBtn");Q.setStartPageOpen=function(e){Q.isStartPage(e)},Q.startTitle=i.observable(""),Q.startFlowTitle=i.observable(""),Q.startERDTitle=i.observable(""),Q.showStartPage=function(e,t,a){Q.startTitle(e),Q.startFlowTitle(t),Q.startERDTitle(a),Q.manager.getStartPageEditor().showStartPageEditor()},Q.callStartPage=function(t){var a=x.getTitle(),i=x.getFlowTitle(),o=x.getERDTitle();Q.showDBName(!1),e("#thumbnailDialogId").dialog("close"),gt.css("height","32px"),ut.css("grid-template-rows","40px 40px auto"),Q.showStartPage(a,i,o)},Q.templatesList=i.observableArray([""]),Q.flowTemplates=i.observableArray(Q.manager.getTemplates().getFlowTemplatesList()),Q.dbTemplates=i.observableArray(),Q.logTemplates=i.observableArray(Q.manager.getTemplates().getLOGTemplatesList()),Q.procTemplates=i.observableArray(Q.manager.getTemplates().getPROCTemplatesList()),Q.showFlowTemplates=i.observable(r.getDiagramType()===d.diagramType().FLOWCHART),Q.showDBTemplates=i.observable(r.getDiagramType()===d.diagramType().ERD_DB),Q.hideTextBlock=i.observable(!1),Q.setHideTextBlock=function(){Q.hideTextBlock(!0)},Q.flowTabVisible=i.observable(!1),Q.erdTabVisible=i.observable(!1),Q.logTabVisible=i.observable(),Q.procTabVisible=i.observable(),Q.setFlowTabVisible=function(){J(),Q.flowTabVisible(!0)},Q.setERDTabVisible=function(){J(),Q.erdTabVisible(!0)},Q.setLOGTabVisible=function(){J(),Q.logTabVisible(!0)},Q.setPROCTabVisible=function(){J(),Q.procTabVisible(!0)},Q.infoMessage=i.observable(""),Q.infoMessageVisible=i.observable(),Q.showInfoMessage=function(t,a){Q.infoMessage(t),Q.infoMessageVisible(!1),e("#infoDialogId").dialog("open"),a&&e("#infoDialogId").dialog("option","title",a)},e("#infoDialogId").on("dialogopen",function(t,a){setTimeout(function(){Q.infoMessageVisible(!0),e("#infoTextId").scrollTop(0)},200)});var yt;Q.getConfirmSrvFlag=function(){return yt},Q.setConfirmSrvFlag=function(e){yt=e},Q.confirmSrvMessage=i.observable(""),Q.showConfirmSrvMessage=function(t,a,i){F.initDialog(Q.manager),Q.confirmSrvMessage(t),a&&ce.dialog("option","title",a),i&&(e(e("button",ce.parent())[1]).text(i.first),e(e("button",ce.parent())[2]).text(i.second)),ce.dialog("open")};var Dt;Q.getConfirmFlag=function(){return Dt},Q.setConfirmFlag=function(e){Dt=e},Q.confirmMessage=i.observable(""),Q.showConfirmMessage=function(t,a,i){k.initDialog(Q.manager),Q.confirmMessage(t),a&&le.dialog("option","title",a),i&&(e(e("button",le.parent())[1]).text(i.first),e(e("button",le.parent())[2]).text(i.second)),le.dialog("open")};var wt;Q.getConfirmFlag2=function(){return wt},Q.setConfirmFlag2=function(e){wt=e},Q.confirmMessage2=i.observable(""),Q.showConfirmMessage2=function(t,a,i){P.initDialog(Q.manager),Q.confirmMessage2(t),a&&de.dialog("option","title",a),i&&(e(e("button",de.parent())[1]).text(i.first),e(e("button",de.parent())[2]).text(i.second)),de.dialog("open")},Q.isShowThumbnail=i.observable(),Q.btnThumbnailShow=function(){Q.isShowThumbnail(!0),e("#thumbnailDialogId").dialog("open"),Q.repaintDiagram()},Q.btnThumbnailHide=function(){Q.isShowThumbnail(!1),Q.repaintDiagram()},Q.overlayText=i.observable("");var Ct=e("#saveOverlayId");Q.showOverlayMessage=function(e,t){var a=t||1e3;Q.overlayText(e),Ct.show(),setTimeout(function(){Ct.fadeOut(a)},a+200)},Q.bottomMessageText=i.observable("");var Et=e("#bottomOverlayId");Q.showBottomMessage=function(e,t){var a=t||1e3;Q.bottomMessageText(e),Et.show(),setTimeout(function(){Et.fadeOut(a)},a+200)},ue.addEventListener("mousemove",function(e){X()},!1),ue.onchange=function(){X()};var Nt;Q.getDraggedPaletteId=function(){return Nt},Q.setDraggedPaletteId=function(e){Nt=e},Q.onPaletteDragStart=function(e){parseInt(e.target.id)===d.flowType().DB_TABLE_2||parseInt(e.target.id)===d.flowType().DB_TABLE_3||parseInt(e.target.id)===d.flowType().DB_TABLE_4?(Nt=d.flowType().DB_TABLE,e.dataTransfer.setData("text",d.flowType().DB_TABLE),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ENTITY_W?(Nt=d.flowType().ENTITY,e.dataTransfer.setData("text",d.flowType().ENTITY),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().RELATION_W?(Nt=d.flowType().RELATION,e.dataTransfer.setData("text",d.flowType().RELATION),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ATTR_MULTI||parseInt(e.target.id)===d.flowType().ATTR_DRV?(Nt=d.flowType().ATTRIBUTE,e.dataTransfer.setData("text",d.flowType().ATTRIBUTE),e.dataTransfer.setData("altType",e.target.id)):(Nt=e.target.id,e.dataTransfer.setData("text",e.target.id))},Q.onPaletteDragEnd=function(e){var t=ee.getBoundingClientRect();e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom||Q.manager.getDnDHandler().resetDrag()},Q.requestFocus=function(){},Q.isControlPressed=function(){return pe},Q.setControlPressed=function(e){pe=e},Q.isEditControlPressed=function(){return Te},Q.setEditControlPressed=function(e){Te=e},Q.isShiftPressed=function(){return ve},Q.setShiftPressed=function(e){ve=e},window.onresize=function(){be.style.height=window.innerHeight+"px",e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),$();var t=document.getElementById("screenId").offsetWidth,a=e(window).scrollTop();t<It?q(d.toolbarPosition().VERTICAL):a<ht&&q(d.toolbarPosition().HORIZONTAL),Q.manager.getInlineInputEditor().relocateInlineFieldEditor(),Q.manager.getInlineAreaEditor().relocateInlineAreaEditor(),Q.manager.getDBTableEditor().relocateDBTableEditor(),Q.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),Q.manager.getDecisionLayoutEditor().relocateDecisionLayoutEditor(),C.relocateDialog(),X(),Q.repaintDiagram()},window.onscroll=function(){Q.manager.getInlineInputEditor().relocateInlineFieldEditor(),Q.manager.getInlineAreaEditor().relocateInlineAreaEditor(),Q.manager.getDBTableEditor().relocateDBTableEditor(),Q.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),j(),e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),Q.repaintDiagram()};var St=0,Bt=e("#containerId");return Q.repaintDiagram=function(){Q.hideContainerBar(),Q.hideSwitchBar(),Q.manager.paintDiagram()},Q.initData(),{initFlowDemo:function(){window.scrollTo(0,0),Q.setProgressBarVisible(!1),o.checkConnection(Q.manager),setTimeout(function(){e(window).trigger("resize")},100)}}});