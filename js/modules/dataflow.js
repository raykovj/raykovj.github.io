//self.aboutCopyright(copy);

define(["jquery","jqueryui","jqueryuictxm","knockout","modules/server/ioHandler","modules/fs/directories","modules/html/toolbar","modules/settings/config","modules/actions/frameActions","modules/graph/graphConstants","modules/gallery/components","modules/gallery/iconOptionsPicker","modules/gallery/portIconPicker","modules/gallery/cardinalityPicker","modules/gallery/decisionEnds","modules/erd/dbRecords","modules/flow/flowManager","modules/flow/flowUtils","modules/fs/fsBrowser","modules/diagram/mouseInteractor","modules/dialogs/newFlowDialog","modules/dialogs/newFolderDialog","modules/dialogs/openFlowDialog","modules/dialogs/nodePropsDialog","modules/dialogs/findDialog","modules/dialogs/linkPropsDialog","modules/dialogs/dbTableEditor","modules/dialogs/aboutDialog","modules/util/welcomeText","modules/util/startText","modules/dialogs/welcomeDialog","modules/dialogs/infoDialog","modules/dialogs/confirmDialog","modules/dialogs/thumbnailDialog","modules/settings/settingsDialog","modules/geometry/point","modules/util/utils","modules/draw/draw","modules/controller/flowCache","modules/exportLayout/demoFlow","modules/util/integrationText"],function(e,t,a,n,i,o,s,r,l,d,c,u,g,b,m,p,v,T,f,I,h,y,w,D,E,N,S,L,C,k,F,O,M,B,x,R,P,A,V,H,_){function G(e){e===d.flow().VERTICAL?(fe.removeClass("block-extendV"),fe.addClass("block-extendH"),Ie.removeClass("block-extendH"),Ie.addClass("block-extendV"),he.removeClass("block-shrinkV"),he.addClass("block-shrinkH"),ye.removeClass("block-shrinkH"),ye.addClass("block-shrinkV")):e===d.flow().HORIZONTAL&&(fe.removeClass("block-extendH"),fe.addClass("block-extendV"),Ie.removeClass("block-extendV"),Ie.addClass("block-extendH"),he.removeClass("block-shrinkH"),he.addClass("block-shrinkV"),ye.removeClass("block-shrinkV"),ye.addClass("block-shrinkH"))}function W(e){e===d.flow().VERTICAL?(Ee.removeClass("block-extendV"),Ee.addClass("block-extendH"),Ne.removeClass("block-shrinkV"),Ne.addClass("block-shrinkH")):e===d.flow().HORIZONTAL&&(Ee.removeClass("block-extendH"),Ee.addClass("block-extendV"),Ne.removeClass("block-shrinkH"),Ne.addClass("block-shrinkV"))}function K(e){if(q.selectedFileType()===d.fileTypes().ALL)return e;var t=[],a=q.selectedFileType().split(".").pop();return e.forEach(function(e){e.split(".").pop()===a&&t.push(e)}),t}function z(){e("#openSaveButtonOK").button("option","disabled",q.isFlowSaveBlocked())}function U(e){r.setFlowDirection(e),Z(e),q.setFlowDirectionChange(),G(e),W(e),q.getFlowManager().hasDiagramOpen()&&q.manager.setDirty(!0),q.setConfirmFlag(d.bValue().FALSE),q.getFlowManager().setSettingsChanged(!0),setTimeout(function(){q.getFlowManager().refreshDiagramOnEdit(!0),q.getFlowManager().refreshDiagramOnEdit(!0)},200)}function Z(e){e===d.flow().VERTICAL?T.updateDecisionInputs(q.manager.getModelHandler().getFlowNodes(),d.decisionInputs().NORTH):e===d.flow().HORIZONTAL&&T.updateDecisionInputs(q.manager.getModelHandler().getFlowNodes(),d.decisionInputs().WEST)}function Y(){q.flowTabVisible(!1),q.erdTabVisible(!1),q.logTabVisible(!1),q.procTabVisible(!1)}function X(){var e=document.getElementById("containerId").clientWidth;J.width>e&&r.hasShowBottomMessages()&&q.showBottomMessage("Drag the mouse on canvas to scroll")}function j(){var t=e(window).height();e(window).scrollTop();rt.height(t-st)}var q=this,J=document.getElementById("canvasId"),$=document.getElementById("canvasThId"),Q=J.getContext("2d"),ee=document.getElementById("containerId"),te=document.getElementById("topContainerId"),ae=e("#openFlowDialogId"),ne=e("#spinnerLevelsId"),ie=e("#spinnerLanesId"),oe=(e("#spinnerSpaceId"),e("#confirmDialogId")),se=(e("#thumbnailDialogId"),document.getElementById("scaleId")),re=e("#nodePropsTabId"),le=document.getElementById("paletteCtrId"),de="[Select diagram type or 'Open Diagram / Template...']",ce=!1,ue=!1,ge=!1;q.accHdrFlowTitle=n.observable(d.appTitles().FLOW_TITLE),q.accHdrSideTitle=n.observable(d.appTitles().SIDE_TITLE),q.accHdrMiscTitle=n.observable(d.appTitles().MISC_TITLE),q.accHdrERDTitle=n.observable(d.appTitles().DB_ERD_TITLE),q.accHdrLOGTitle=n.observable(d.appTitles().DB_LOG_TITLE),q.accHdrPROCTitle=n.observable(d.appTitles().PROCESS_TITLE),q.accHdrPagesTitle=n.observable(d.appTitles().PAGES_TITLE),q.accHdrBpelTitle=n.observable(d.appTitles().BPEL_TITLE),q.accHdrK8sTitle=n.observable(d.appTitles().K8S_TITLE),q.getCanvas=function(){return J},q.setCanvas=function(e){J=e},q.getCanvasContext=function(){return Q},q.getCanvasTh=function(){return $},q.setCanvasTh=function(e){$=e},q.getCanvasContext=function(){return Q},q.getCanvasContainer=function(){return ee},q.getTopContainer=function(){return te},q.manager=new v(q),q.interactor=q.manager.getMouseInteractor(),q.dndHandler=q.manager.getDnDHandler(),q.updateTrigger=n.observable(!1);var be=new f(q);q.getFlowManager=function(){return q.manager};var me=Date.now(),pe=!1;q.isConnectionOK=n.observable(pe),q.cnxResultOK=function(){pe=!0,q.showOverlayMessage("Connected",500),q.isConnectionOK(pe),setTimeout(function(){q.updateWindow()},200),q.manager.getInstallSettings(),q.callStartPage(!0)},q.cnxResultFAIL=function(e){Date.now()-me<3e3?(pe=!1,console.log("*** connection FAIL: "+e.readyState),setTimeout(function(){q.showOverlayMessage("No server connection",500)},200)):(pe=!0,q.showOverlayMessage("Connected",500)),q.isConnectionOK(pe),setTimeout(function(){console.clear(),q.updateWindow()},200),q.manager.getInstallSettings(),q.callStartPage(!0)},e(document).ready(function(){function t(e){q.isDgmFlow(e)}function a(t){return e("<img>",{style:"margin: 0 6px -2px -22px;",src:u.getIconURL(t.value)})}function i(t){return e("<img>",{style:"margin: 0 6px -2px 0;",src:u.getIconURL(t.value)})}function o(t){return e("<img>",{style:"margin: 0px 6px 2px 10px; ",src:g.getPortIconURL(t.value)})}function c(t){return e("<img>",{style:"margin: 0 6px -2px 6px; background-color: white; }",src:g.getPortIconURL(t.value)})}Q.canvas.width=0,Q.canvas.height=0,h.initDialog(q.manager),y.initDialog(q.manager),w.initDialog(q.manager),x.initDialog(q.manager),D.initDialog(q.manager),E.initDialog(q.manager),N.initDialog(q.manager),L.initDialog(q.manager),O.initDialog(q.manager),M.initDialog(q.manager),B.initDialog(q.manager),F.initDialog(q.manager),s.initButtons(q),l.initActions(q),e("#canvasId").contextmenu(q.interactor.getContextMenu()),te.addEventListener("mousemove",function(t){q.interactor.isOverCanvas(t)||(e("#canvasId").contextmenu("close"),q.manager.getFlowDiagram().setMousePoint(void 0))}),e("#paletteAccordionId").accordion({heightStyle:"fill",animate:{easing:"swing",duration:200},collapsible:!0,create:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header").css("height","12"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE")},activate:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE");a.newHeader.context&&a.newHeader.context.innerText;q.updateWindow()}}),setTimeout(function(){e("#paletteAccordionId").accordion("option","icons",{header:"ui-icon-triangle-1-e",activeHeader:"ui-icon-triangle-1-s"})},100),e("#accTableFlowId").height(262),e("#accTableMiscsId").height(184),e("#accTableERDId").height(80),e("#accTableLOGId").height(184),e("#accTablePROCId").height(28),q.isDgmFlow=n.observable(!1),e("#btnDgmModeDId").click(function(e,a){t(!0)}),e("#btnDgmModeUId").click(function(e,a){t(!1)}),q.hasDiagram=n.observable(!1),q.setDiagramOpen=function(e){q.hasDiagram(e)},e("#settingsTabId").tabs({}),e("#integrationTabId").tabs({}),e("textarea").keydown(function(t){33==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),t.target.setSelectionRange(0,0),e(this).scrollTop(0)),34==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),textareaLength=e(this).val().length,t.target.setSelectionRange(textareaLength,textareaLength),e(this).scrollTop(9999))}),re.tabs({activate:function(e,t){1===t.newTab.index()?re.css({overflow:"auto"}):re.css({overflow:"hidden"})}}),e("#infoTextId").attr("visibility","hidden"),ne.spinner({step:1,min:d.canvasRange().MIN,max:d.canvasRange().MAX,numberFormat:"n"}),ne.spinner("value",d.initial().LEVELS),ne.spinner("enable"),ie.spinner({step:1,min:d.canvasRange().MIN,max:d.canvasRange().MAX,numberFormat:"n"}),ie.spinner("value",d.initial().LANES),ie.spinner("enable");var b=e("#progressBarId");b.progressbar({value:!1}),b.height(14),e.widget("nodeIcons.iconselectmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{text:u.getIconLabel(t.value)});return i(t).prependTo(a),a},_renderItem:function(t,n){var i=e("<li>"),o=e("<div>",{text:u.getIconLabel(n.value)});return a(n).prependTo(o),i.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this,i=u.getOptionItems(a);e.each(i,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e,t){if(r.getDiagramType()===d.diagramType().FLOWCHART){var a=u.getIndexValue(e,t);this.element[0].selectedIndex=a,this.refresh()}}}),e("#nodeIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e("#settingIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e.widget("portImages.porticonmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{style:"padding-left: 16px; height: 16px; width: 100px; background-color: white"});return o(t).prependTo(a),a},_renderItem:function(t,a){var n=e("<li>"),i=e("<div>",{style:"height: 16px; width: 120px"});return c(a).prependTo(i),n.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,i=g.getPortOptionItems(a);e.each(i,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=g.getPortIndexValue(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#selectPortIconsId").porticonmenu().porticonmenu("menuWidget").addClass("ui-menu-icons porticons");document.getElementById("settingSchemesId");e.widget("settings.schemenames",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.value})},_renderItem:function(t,a){var n=e("<li>"),i=e("<div>",{text:a.value});return n.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,i=q.manager.getSettingsManager().getOptionsPicker().getOptions();e.each(i,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=q.manager.getSettingsManager().getOptionsPicker().getIndex(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#settingSchemesId").schemenames({width:240}).schemenames("menuWidget").addClass("ui-menu-icons schemenames"),e("#selectPartitionId").selectmenu({select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;console.log("$$$ disk select: "+a),q.selectedPartition(a)}},change:function(e,t){var a=e.currentTarget.textContent;console.log("### disk change: "+a)},create:function(e,t){setTimeout(function(){q.manager.getDiskNames()},1e3)}}).addClass("settingsDiskMenu").css("fontSize","16px"),e("#selectFileTypeId").selectmenu({create:function(t,a){setTimeout(function(){q.selectedFileType(d.fileTypes().JSON),e("#selectFileTypeId").selectmenu("refresh")},1e3)},select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;q.selectedFileType(a),q.manager.getDirContent()}}}).addClass("settingsDiskMenu"),e.widget("demomenu.demofilesmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},refreshButtonItem:function(e){this.refresh()}}),e("#selectFileId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#flowMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#dbMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#logMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#procMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles")}),q.startHereVisible=n.pureComputed(function(){return!q.hasDiagram()&&!q.isStartPage()&&!q.someDialogsOpen()}),q.someDialogsOpen=n.observable(!1),q.setSomeDialogsOpen=function(e){q.someDialogsOpen(e)},q.disableInactiveTypeButtons=function(e){e?r.getDiagramType()===d.diagramType().ERD_DB?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=!e,document.getElementById("btnLOGId").disabled=e):r.getDiagramType()===d.diagramType().ERD_LOG?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=!e):(document.getElementById("btnFlowId").disabled=!e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e):(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e)},e("#btnFlowId").prop("checked",!0),e('input[id="btnFlowId"]').on("change",function(e){q.enforceDiagramType(d.diagramTypeText().FLOWCHART)}),e('input[id="btnERDId"]').on("change",function(e){q.enforceDiagramType(d.diagramTypeText().ERD_DB)}),e('input[id="btnLOGId"]').on("change",function(e){q.enforceDiagramType(d.diagramTypeText().ERD_LOG)}),q.diagramTypeFlow=n.observable(d.diagramTypeText().FLOWCHART),q.diagramTypeERD=n.observable(d.diagramTypeText().ERD_DB),q.diagramTypeLOG=n.observable(d.diagramTypeText().ERD_LOG),q.diagramTypeProc=n.observable(d.diagramTypeText().PROCESS),q.enforceDiagramType=function(t){t===d.diagramTypeText().ERD_DB?(e("#btnERDId").prop("checked",!0),r.setDiagramType(d.diagramType().ERD_DB),r.setFlowDirection(d.flow().VERTICAL),q.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",2),r.setShowNodeTasks(!1),r.setShowDBRecords(!0),r.setShowCardinality(!0),r.setShowRefHandles(!1),r.setShowNodeIcons(!1),r.setHideNodeNames(!1),r.setLinkStyle(d.linkStyle().STRAIGHT_LINE),r.setSegmentsGap(d.segmentsGap().MAX),r.setGridSpace(d.gridSpace().MAX),q.setERDTabVisible()):t===d.diagramTypeText().ERD_LOG?(e("#btnLOGId").prop("checked",!0),r.setDiagramType(d.diagramType().ERD_LOG),r.setFlowDirection(d.flow().VERTICAL),q.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",3),r.setShowNodeTasks(!1),r.setShowDBRecords(!0),r.setShowCardinality(!0),r.setShowRefHandles(!1),r.setShowNodeIcons(!1),r.setHideNodeNames(!1),r.setLinkStyle(d.linkStyle().STRAIGHT_LINE),r.setSegmentsGap(d.segmentsGap().MIN),r.setGridSpace(d.gridSpace().MIN),q.setLOGTabVisible()):(e("#btnFlowId").prop("checked",!0),r.setDiagramType(d.diagramType().FLOWCHART),e("#btnHorizontal").prop("disabled",!1),document.getElementById("btnFlowVId").disabled=!1,e("#paletteAccordionId").accordion("option","active",0),r.setSegmentsGap(d.segmentsGap().MIN),r.setGridSpace(d.gridSpace().MIN),r.setShowDBRecords(!1),r.setShowCardinality(!1),r.setShowNodeTasks(!1),q.setFlowTabVisible()),q.updateWindow()},q.showIconSelection=n.pureComputed(function(){return r.getDiagramType()===d.diagramType().FLOWCHART}),q.isAutoLayoutAllowed=n.observable(r.isAllowAuto()),q.forceTestAutoMode=function(e){r.setLayoutMode(d.layoutMode().AUTO),q.manager.getSelectionManager().clearSelections(),q.manager.resetScale(),q.runTestAutoMode()},q.resetTestAutoMode=function(){q.manager.clearDiagram(),r.setLayoutMode(d.layoutMode().MANUAL)},q.runTestAutoMode=function(){},q.dbNodeRecords=n.observableArray(),q.showDBTableEditorOnLeft=n.observable(!1),q.showDBCardinalityOnLeft=n.observable(!1),q.dbTableErrorMsg=n.observable(!1),q.dbTableKeys=n.observableArray(q.manager.getDBTableEditor().dbTableKeys()),q.keyId=n.observable(""),q.dbTableTypes=n.observableArray(q.manager.getDBTableEditor().dbTableTypes()),q.typeId=n.observable(""),q.dbTableLength=n.observable(""),q.dbTableAutoIncr=n.observableArray(q.manager.getDBTableEditor().dbTableAutoIncr()),q.autoIncrId=n.observable(""),q.dbTableNotNull=n.observableArray(q.manager.getDBTableEditor().dbTableNotNull()),q.notNullId=n.observable(""),q.showDecisionEditorOnLeft=n.observable(!1),q.nodeEmojiItems=n.pureComputed(function(){return u.getNodeIconOptions()}),q.portIcons=n.pureComputed(function(){return g.getPortIconOptions()}),q.cardinalityItems=n.pureComputed(function(){return b.getCardinalityList()}),q.enableShowCardinality=n.observable(!1),q.setEnableShowCardinality=function(e){q.enableShowCardinality(e)},q.enableShowDB=n.observable(!1),q.setEnableShowDB=function(e){q.enableShowDB(e)},q.onOpsActionChange=function(e){},q.isProgressBarVisible=n.observable(!1),q.isProgressBarVisible.extend({notify:"always"}),q.setProgressBarVisible=function(e){q.isProgressBarVisible(e)},q.showPageMode=n.observable(r.hasPageMode()),q.isCanvasVisible=n.observable(!1),q.setCanvasVisible=function(e){q.isCanvasVisible(e)},q.scaleValue=n.observable(r.getScale()),e("#scaleId").slider(),se.oninput=function(){r.setScale(this.value/d.scale().FACTOR),q.scaleValue(r.getScale()),q.manager.clearClipboard(),q.manager.getFlowDiagram().clearCanvas(),q.manager.rebuildFlowData()},q.editModeText=n.observable(r.isEditMode()?d.editModeText().EDIT:d.editModeText().VIEW),q.setEditModeText=function(e){e===d.editMode().EDIT_ALL?q.editModeText(d.editModeText().EDIT):q.editModeText(d.editModeText().VIEW)},q.setTooltipBox=function(e,t){e.length>0&&r.isEditMode()&&1===r.getScale()&&A.drawTooltip(Q,J.getBoundingClientRect(),t,e)},q.showTooltipBox=function(e){},q.getCurrentShortFileName=function(){var e=q.manager.getFileName(),t=e.indexOf(".json"),a=e.substring(0,t),n=a.lastIndexOf("/");return a.substring(n+1)};var ve,Te=document.getElementById("blockResizeId"),fe=e("#extendBlockAcrossId"),Ie=e("#extendBlockAlongId"),he=e("#shrinkBlockAcrossId"),ye=e("#shrinkBlockAlongId");q.showBlockResizeBar=function(e){var t=e.getExpandedShape(),a=r.getScale();Te.style.left=J.getBoundingClientRect().left+t.x*a+"px",Te.style.top=J.getBoundingClientRect().top+t.y*a-24+"px",fe.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Ie.attr("disabled",!r.isEditMode()||!e.canExtendAlong()),he.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),ye.attr("disabled",!r.isEditMode()||!e.canShrinkAlong()),Te.style.visibility="visible"},q.doResizeContainer=function(e){var t=q.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().CONTAINER&&t[0].resizeOutline(e),Te.style.visibility="hidden",ve=!1},q.isBlockResizeBarVisible=function(){return ve},q.hideContainerBar=function(){Te.style.visibility="hidden"};var we,De=document.getElementById("switchResizeId"),Ee=e("#extendSwitchAcrossId"),Ne=e("#shrinkSwitchAcrossId");q.showSwitchResizeBar=function(e){var t=e.getMenuBarPosition(),a=r.getScale();De.style.left=J.getBoundingClientRect().left+t.x*a+"px",De.style.top=J.getBoundingClientRect().top+t.y*a-24+"px",Ee.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Ne.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),De.style.visibility="visible"},q.doResizeSwitch=function(e){var t=q.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().SWITCH&&t[0].resizeOutline(e),De.style.visibility="hidden",we=!1},q.isSwitchResizeBarVisible=function(){return we},q.hideSwitchBar=function(){De.style.visibility="hidden"},q.showSearchList=n.observable(!1),q.showFindOptions=n.observable(!0),q.searchContentList=n.observableArray(),q.foundMatches=n.observable(),q.onFindTableClick=function(e){var t=e.target.innerText;E.selectedNewDisk(t)},q.onFindTableDblClick=function(e){q.onFindTableClick(e)},q.onPasteSearchText=function(e){E.selectedNewDisk(label)},q.currentPath=n.observable(),q.fsContentList=n.observableArray(),q.selectedPath=n.observable(),q.isOpenMode=n.observable(),q.isSaveMode=n.observable(),q.showPartitions=n.observable(!1),q.partitionsList=n.observableArray([""]),q.selectedPartition=n.observable(),q.filesTypes=n.observableArray([d.fileTypes().JSON,d.fileTypes().ALL]),q.selectedFileType=n.observable(d.fileTypes().JSON);q.showTemplatesOnly=n.observable(!1),q.setShowTemplatesOnly=function(e){q.showTemplatesOnly(e)},q.callOpenFlowDialog=function(e){e?(q.setFSDialogMode(d.fsDialogMode().OPEN),q.setShowTemplatesOnly(!0),setTimeout(function(){ae.dialog("open"),ae.dialog({height:180})},200)):(q.setShowTemplatesOnly(!1),setTimeout(function(){q.isConnectionOK()?ae.dialog({height:440}):ae.dialog({height:180}),q.manager.getRootDir(),ae.dialog("open")},200))},q.onDiskTableClick=function(e){var t=e.target.innerText;w.selectedNewDisk(t)},q.setFSDialogMode=function(e){be.setFSDialogMode(e)},q.getFSDialogMode=function(){return be.getFSDialogMode()},q.restoreWorkDir=function(){be.restoreWorkDir()},q.setWorkDir=function(e){be.setWorkDir(e)},q.getWorkDir=function(){return be.getWorkDir()},q.getSelectedFSDir=function(){return be.getSelectedFSDir()},q.getSelectedFSFile=function(){return be.getSelectedFSFile()},q.onDirTableClick=function(e){be.onDirTableClick(e)},q.deleteFSItem=function(){be.deleteFSItem()},q.onDirTableDblClick=function(e){be.onDirTableDblClick(e)},q.updateMainFSLocation=function(){be.updateMainFSLocation()},q.goOneDirBack=function(){be.goOneDirBack()},q.setDirsList=function(e,t){be.setDirsList(e,t)},q.setFolderContent=function(e,t){be.setFolderContent(e,t)},q.onFileTypeChange=function(e){be.onFileTypeChange(e)},q.showForegroundSelection=n.observable(!0),q.showBackgroundSelection=n.observable(!0),q.settingsSchemes=n.observableArray([]),q.removeFromSettingsSchemes=function(e){for(var t=-1,a=0;a<q.settingsSchemes().length;a++)if(q.settingsSchemes()[a]===e){t=a;break}a>-1?q.settingsSchemes.splice(t,1):alert("bad index for settingsSchemes: "+t)};var Se;q.setNewAction=function(e){Se=e},q.isNewAction=function(){return Se},q.filesList=n.observableArray();var Le=[];q.setFilesList=function(t){if(Le=t,q.filesList(t),q.filesList(K(t)),Se)e("#newFlowDialogId").dialog("open");else;},q.selectedFile=n.observable(),q.getSelectedFile=function(){return q.isConnectionOK()?_selectedFile:q.selectedFile()},q.isInputInvalid=n.observable(!1),q.validateMessage=n.observable(""),q.newFSNameValue=n.observable(""),q.nameValueEmpty=n.observable(""),q.validateFSName=function(t,a){var n=P.trimMultipleSpaces(q.newFSNameValue()),i=a?o.getDirectoriesLabels():q.filesList();q.nameValueEmpty(0===n.length);var s=(q.isInputInvalid(),P.containsFSName(i,n)),r=P.isFSNameValid(q.newFSNameValue()),l=n.length>0&&(!r||s);q.isInputInvalid(l),e("#newFlowButtonOK").button("option","disabled",q.isInputInvalid()||q.nameValueEmpty()),e("#newFolderButtonOK").button("option","disabled",q.isInputInvalid()||q.nameValueEmpty()),r?s?q.validateMessage("Duplicate name"):q.validateMessage(""):q.validateMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces"),t&&n.length>0&&r&&"Enter"===t.code&&(Se?(h.createNewDiagram(q.manager),e("#newFlowDialogId").dialog("close")):(y.createNewFolder(q.manager),e("#newFolderDialogId").dialog("close")))},q.saveAsInputInvalid=n.observable(!1),q.saveAsMessage=n.observable(""),q.saveAsFileNameValue=n.observable(""),q.saveAsNameEmpty=n.observable(""),q.validateSaveAsFileName=function(e){var t=P.trimMultipleSpaces(q.editNameValue());if(t.length>0){var a=P.containsFSName(q.filesList(),t),n=P.isFSNameValid(t),i=!a&&n;q.isEditNameInvalid(!i)}else q.isEditNameInvalid(!0);a?q.validateNameMessage("Duplicate name"):n?q.validateNameMessage(""):q.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},q.saveAsNewVersion=n.observable(1),q.versionInputInvalid=n.observable(!1),q.validateAsVersion=function(e){var t=(q.saveAsNewVersion(),P.isVersionNumber(q.saveAsNewVersion()));q.versionInputInvalid(!t),z()},q.isFlowSaveBlocked=function(){return q.saveAsInputInvalid()||q.saveAsNameEmpty()||q.saveAsNewVersion()&&q.versionInputInvalid()};var Ce=n.observable();q.propsLinkSourceName=n.observable(),q.propsLinkSourceLabel=n.observable(),q.propsLinkTargetName=n.observable(),q.propsLinkTargetLabel=n.observable(),q.propsLinkLabel=n.observable(),q.getPropsLink=function(){return Ce()},q.getPropsLinkLabelValue=function(){return q.propsLinkLabel()},q.showLinkProps=function(t){Ce(t),q.propsLinkSourceName(Ce().getLinkSourcePortName()),q.propsLinkSourceLabel(Ce().getLinkSourcePortLabel()),q.propsLinkTargetName(Ce().getLinkTargetPortName()),q.propsLinkTargetLabel(Ce().getLinkTargetPortLabel()),q.propsLinkLabel(Ce().getLinkLabel()),e("#linkPropsDialogId").dialog("open")},q.propsFgndVisible=n.observable(!0),q.setPropsFgndVisible=function(e){q.propsFgndVisible(e)},q.propsNodeInputs=n.observableArray();var ke,Fe;q.getPropsNodeInputsIdx=function(){return ke},q.getPropsNodeInputsValue=function(){return Fe},q.propsNodeOutputs=n.observableArray();var Oe,Me;q.getPropsNodeOutputsIdx=function(){return Oe},q.getPropsNodeOutputsValue=function(){return Me},q.propsNodeRefInputs=n.observableArray();var Be,xe;q.getPropsNodeRefInputsIdx=function(){return Be},q.getPropsNodeRefInputsValue=function(){return xe},q.propsNodeRefOutputs=n.observableArray();var Re,Pe;q.getPropsNodeRefOutputsIdx=function(){return Re},q.getPropsNodeRefOutputsValue=function(){return Pe};var Ae=n.observable();q.setPropsNode=function(e){Ae(e)},q.getPropsNode=function(){return Ae()},q.propsNodeName=n.computed(function(){return Ae()?Ae().getName():"?"},this),q.showNodeProps=function(t){Ae(t),t.getFlowType()===d.flowType().DB_TABLE&&t.closeDBEditors(),u.setNodeCategory(t.getNodeCategory()),q.propsNodeInputs(Ae().getInputPortsProperties()),q.propsNodeOutputs(Ae().getOutputPortsProperties()),q.propsNodeRefInputs(Ae().getRefInPortsProperties()),q.propsNodeRefOutputs(Ae().getRefOutPortsProperties()),q.dbNodeRecords(Ae().getDBRecords()),e("#nodePropsDialogId").dialog("open")};var Ve=n.observable();q.setPropsPort=function(e){Ve(e)},q.getPropsPort=function(){return Ve()},q.propsPortName=n.computed(function(){return Ve()?Ve().getName():"?"},this),q.editPropsNodeInputLabel=function(e){ke=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeInputsTableId"),a=t.getElementsByTagName("tr");Fe=a[ke].cells[2].getElementsByTagName("input")[0].value},q.checkPortInputCardinality=function(e){D.editPortInputCardinality(e)},q.editPropsNodeOutputLabel=function(e){Oe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeOutputsTableId"),a=t.getElementsByTagName("tr");Me=a[Oe].cells[2].getElementsByTagName("input")[0].value},q.checkPortOutputCardinality=function(e){D.editPortOutputCardinality(e)},q.editPropsNodeRefInputLabel=function(e){Be=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefInputsTableId"),a=t.getElementsByTagName("tr");xe=a[Be].cells[2].getElementsByTagName("input")[0].value},q.checkPortRefInputCardinality=function(e){D.editPortRefInputCardinality(e)},q.editPropsNodeRefOutputLabel=function(e){Re=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefOutputsTableId"),a=t.getElementsByTagName("tr");Pe=a[Re].cells[2].getElementsByTagName("input")[0].value},q.checkPortRefOutputCardinality=function(e){D.editPortRefOutputCardinality(e)},q.isEditNameInvalid=n.observable(!1),q.editNameValue=n.observable(""),q.newFlowNameValue=n.observable(""),q.validateNameMessage=n.observable("");var He;q.setOldName=function(e){He=e},q.validateInlineNodeName=function(){var e=q.manager.getInlineInputEditor().getCurrentValue(),t=P.trimMultipleSpaces(e);q.validateEditName(t)},q.validateDialogNodeName=function(){var e=P.trimMultipleSpaces(q.editNameValue());q.validateEditName(e)},q.validateNewFlowName=function(){var e=P.trimMultipleSpaces(q.editNameValue());q.validateEditName(e)},q.validateNewFolderName=function(){var e=P.trimMultipleSpaces(q.editNameValue());q.validateEditName(e)},q.validateEditName=function(e){if(e.length>0){var t=P.getAllNames(q.manager.getNodeNamesMap()),a=P.isDuplicateName(He,e,t),n=P.isNewNodeNameValid(e),i=!a&&n;q.isEditNameInvalid(!i)}else q.isEditNameInvalid(!0);a?q.validateNameMessage("Duplicate name"):n?q.validateNameMessage(""):q.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},q.isSchemeNameInvalid=n.observable(!1),q.schemeNameValue=n.observable(""),q.validateSchemeMessage=n.observable(""),q.validateSchemeName=function(){var e=document.getElementById("newSchemeId").value;if(e.length>0){var t=q.manager.getSettingsManager().getSchemeNames(),a=t.includes(e),n=P.isSchemeNameValid(e),i=!a&&n;q.isSchemeNameInvalid(!i)}else q.isSchemeNameInvalid(!1);a?q.validateSchemeMessage("Duplicate name"):n?q.validateSchemeMessage(""):q.validateSchemeMessage("Only alphanumericals, dots, dashes and underscores")},q.isLinkLabelInvalid=n.observable(!1),q.linkLabelValue=n.observable(""),q.validateLinkMessage=n.observable("");var _e;q.setOldLinkLabel=function(e){_e=e},q.validateLinkLabelName=function(e){var t=P.trimMultipleSpaces(q.linkLabelValue());if(t.length>0){var a=t===_e||P.isNewLinkLabelValid(t);q.isLinkLabelInvalid(!a)}else q.isLinkLabelInvalid(!1);a?q.validateLinkMessage(""):q.validateLinkMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},q.isFieldInvalid=n.observable(!1),q.fieldValue=n.observable(""),q.validateFieldMessage=n.observable(""),q.validateFieldName=function(){var e=document.getElementById("inputFieldId").value;if(e.length>0){var t=q.manager.getDBTableEditor().getDBRecordsFields(),a=q.manager.getDBTableEditor().getOldFieldValue(),n=t.includes(e),i=P.isDBFieldValid(e),o=e===a||!n&&i;q.isFieldInvalid(!o)}else q.isFieldInvalid(!1);n?q.validateFieldMessage("Duplicate field"):i?q.validateFieldMessage(""):q.validateFieldMessage("Only alphanumericals, dots, \tdashes and underscores")},q.isKeyInvalid=n.observable(!1),q.validateKeyMessage=n.observable(""),q.validateKeyValue=function(){var e=document.getElementById("inputKeyId").value,t=q.manager.getDBTableEditor().getLabelById(q.manager.getDBTableEditor().dbTableKeys(),e);if(q.isKeyInvalid(!1),t.length>0){var a=q.manager.getDBTableEditor().getDBRecordsKeys(),n="PK"===t&&a.includes(t);q.isKeyInvalid(n)}return n?q.validateKeyMessage("Only composite primary key is allowed"):q.validateKeyMessage(""),!n},q.pictureURLValue=n.observable(""),q.isPictureURLInvalid=n.observable(!1),q.validatePictureURL=function(e){q.isPictureURLInvalid(!1)},q.showNewFileName=n.observable(),q.showEditedInfo=n.observable(),q.showDecisionInfo=n.observable(),q.decisionInputPicture=n.observable(),q.decisionEndsPicture=n.observable(),q.isNodeNameInvalid=n.observable(!1),q.newNodeNameValue=n.observable(""),q.invalidNameMessage=n.observable(""),q.resetDecisionIndices=function(){q.updateTrigger(!q.updateTrigger()),m.resetCurrentIndices(),q.decisionInputPicture(m.getCurrentInputPicture()),q.decisionEndsPicture(m.getCurrentEndsPicture())},q.btnFlowH2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&q.changeFlowDirection(d.flow().VERTICAL)},q.btnFlowV2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&q.changeFlowDirection(d.flow().HORIZONTAL)},q.changeFlowDirection=function(e){U(e)};var Ge=!1;q.hasFlowDirectionChange=function(){return Ge},q.setFlowDirectionChange=function(){Ge=!0},q.resetFlowDirectionChange=function(){Ge=!1},q.isHorizontal=n.observable(!1),q.layoutModeText=n.observable(r.getLayoutModeText()),q.diagramModeText=n.observable(r.getDiagramModeText());var We=(e("#newId"),e("#openId")),Ke=(e("#importId"),e("#undoId")),ze=e("#redoId"),Ue=e("#findId"),Ze=e("#refreshId"),Ye=e("#clearId"),Xe=e("#leftId"),je=e("#rightId"),qe=e("#deleteId"),Je=e("#copyId"),$e=e("#pasteId"),Qe=e("#saveId"),et=e("#saveAsId"),tt=e("#btnFlowVId");e("#btnThumbnailId");q.updateWindow=function(t){q.updateTrigger(!q.updateTrigger()),q.isHorizontal(r.getFlowDirection()===d.flow().HORIZONTAL),q.layoutModeText(r.getLayoutModeText()),
q.diagramModeText(r.getDiagramModeText());var a=!r.isEditMode();s.updateMenus(q),We.attr("disabled",!q.isConnectionOK()),Ke.attr("disabled",a||!q.manager.canUndo()).attr("title",q.manager.getUndoName()),ze.attr("disabled",a||!q.manager.canRedo()).attr("title",q.manager.getRedoName()),qe.attr("disabled",a||!q.manager.getSelectionManager().hasSelections()),Je.attr("disabled",a||!q.manager.canCopy()),$e.attr("disabled",a||!q.manager.readyToPaste()),Qe.attr("disabled",a||!q.isConnectionOK()||!q.manager.isDirty()||q.manager.isTemplate()),et.attr("disabled",a||!q.isConnectionOK()||q.manager.getModelHandler().isDiagramEmpty()),Ze.attr("disabled",!q.isCanvasVisible()),Ue.attr("disabled",!q.isCanvasVisible()),Ye.attr("disabled",a||!q.isCanvasVisible()),Xe.attr("disabled",!q.manager.hasPreviousDiagram()),je.attr("disabled",!q.manager.hasNextDiagram()),tt.attr("disabled",r.getAppMode()!==d.appMode().FLOW_MODE),e("#btnFlowHId").attr("disabled",a),e("#btnFlowVId").attr("disabled",a),"visible"!==document.getElementById("blockResizeId").style.visibility||ve?ve&&(document.getElementById("blockResizeId").style.visibility="hidden",ve=!1):ve=!0,"visible"!==document.getElementById("switchResizeId").style.visibility||we?we&&(document.getElementById("switchResizeId").style.visibility="hidden",we=!1):we=!0,q.manager.isInitialResizeMode()&&q.manager.getModelHandler().isDiagramEmpty()?(ne.spinner("enable"),ie.spinner("enable")):(ne.spinner("disable"),ie.spinner("disable")),q.disableInactiveTypeButtons(!q.manager.getModelHandler().isDiagramEmpty())},q.initData=function(){q.updateWindow()},q.galleryFlowNodes=n.pureComputed(function(){return q.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getFlowNodesH():c.getFlowNodesV()}),q.galleryMiscNodes=n.pureComputed(function(){return q.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getMiscNodesH():c.getMiscNodesV()}),q.galleryERDNodes=n.pureComputed(function(){return q.updateTrigger(),c.getERDNodes()}),q.galleryLOGNodes=n.pureComputed(function(){return q.updateTrigger(),c.getLOGNodes()}),q.galleryProcNodes=n.pureComputed(function(){return q.updateTrigger(),c.getProcNodes()}),q.pageNodes=n.pureComputed(function(){q.updateTrigger();for(var e=[],t=r.getFlowDirection()===d.flow().HORIZONTAL?c.getHPageItems():c.getVPageItems(),a=0;a<t.length;a++)e.push(t[a]);return e}),q.diagramDisplayName=n.observable(de),q.setDiagramDisplayName=function(e){e&&e.length>0?(q.showTemplatesOnly()&&(e=d.templateToken()+": "+e),q.diagramDisplayName(e)):q.diagramDisplayName(de)},q.taskActionInputValue=n.observable(""),q.taskServiceInputValue=n.observable(""),q.taskSubscribeInputValue=n.observable(""),q.taskPublishInputValue=n.observable(""),q.taskOperationInputValue=n.observable(""),q.taskExpressionInputValue=n.observable(""),q.showTaskAction=n.observable(!0),q.showTaskService=n.observable(!0),q.showTaskSubscribe=n.observable(!0),q.showTaskPublish=n.observable(!0),q.showTaskOperation=n.observable(!0),q.showTaskExpression=n.observable(!0),q.taskActionSelected=n.observable(!0),q.taskServiceSelected=n.observable(!1),q.taskSubscribeSelected=n.observable(!1),q.taskPublishSelected=n.observable(!1),q.taskOperationSelected=n.observable(!1),q.taskExpressionSelected=n.observable(!1),q.nodeActionList=n.observableArray(),q.nodeOperationList=n.observableArray(),q.nodeServiceList=n.observableArray(),q.nodePublishList=n.observableArray(),q.nodeSubscribeList=n.observableArray(),q.showTaskEditorOnLeft=n.observable(!1),q.aboutTitle=n.observable(""),q.aboutVersion=n.observable(""),q.aboutText=n.observable(""),q.aboutSources=n.observable(""),q.aboutCopyright=n.observable(""),q.showAboutBox=function(t,a,n,i,o){q.aboutTitle(t),q.aboutVersion(a),q.aboutText(n),q.aboutSources(i),e("#aboutDialogId").dialog("open")},q.welcomeTitle=n.observable(""),q.welcomeGreeting=n.observable(""),q.welcomeTo=n.observable(""),q.welcomeTip=n.observable(""),q.showWelcomeBox=function(t,a,n,i){q.welcomeTitle(t),q.welcomeGreeting(a),q.welcomeTo(n),q.welcomeTip(i),e("#welcomeDialogId").dialog("open")},q.isStartPage=n.observable(!1);document.getElementById("startToTopBtn");q.isStartPageOpen=function(){return q.isStartPage()},q.setStartPageOpen=function(e){q.isStartPage(e)},q.onStartToTopClick=function(t){e("#navbarId").show(),setTimeout(function(){e("#topContainerId").show(),q.manager.refreshDiagramOnEdit(!0)},20)},q.startTitle=n.observable(""),q.startTopText1=n.observable(""),q.startTopText2=n.observable(""),q.startFlowTitle=n.observable(""),q.startERDTitle=n.observable(""),q.startLOGTitle=n.observable(""),q.startProcessTitle=n.observable(""),q.showStartPage=function(e,t,a,n,i,o,s){q.startTitle(e),q.startTopText1(t),q.startTopText2(a),q.startFlowTitle(n),q.startERDTitle(i),q.startLOGTitle(o),q.startProcessTitle(s),q.manager.getStartPageEditor().showStartPageEditor(q.manager)},q.callStartPage=function(t){var a=k.getTitle(),n=k.getTopText1(),i=k.getTopText2(),o=k.getFlowTitle(),s=k.getERDTitle(),r=k.getLOGTitle();procTitle=k.getProcessTitle(),e("#paletteCtrId").hide(),q.manager.clearNamesCache(),q.getFlowManager().clearDiagram(),q.getFlowManager().refreshDiagram(),q.showStartPage(a,n,i,o,s,r,procTitle)},q.templatesList=n.observableArray([""]),q.flowTemplates=n.observableArray(q.manager.getTemplates().getFlowTemplatesList()),q.dbTemplates=n.observableArray(q.manager.getTemplates().getDBTemplatesList()),q.logTemplates=n.observableArray(q.manager.getTemplates().getLOGTemplatesList()),q.procTemplates=n.observableArray(q.manager.getTemplates().getPROCTemplatesList()),q.showFlowTemplates=n.observable(r.getDiagramType()===d.diagramType().FLOWCHART),q.showDBTemplates=n.observable(r.getDiagramType()===d.diagramType().ERD_DB),q.showLOGTemplates=n.observable(r.getDiagramType()===d.diagramType().ERD_LOG),q.showPROCTemplates=n.observable(r.getDiagramType()===d.diagramType().PROCESS),q.flowTabVisible=n.observable(),q.erdTabVisible=n.observable(),q.logTabVisible=n.observable(),q.procTabVisible=n.observable(),q.setFlowTabVisible=function(){Y(),q.flowTabVisible(!0)},q.setERDTabVisible=function(){Y(),q.erdTabVisible(!0)},q.setLOGTabVisible=function(){Y(),q.logTabVisible(!0)},q.setPROCTabVisible=function(){Y(),q.procTabVisible(!0)},q.infoMessage=n.observable(""),q.infoMessageVisible=n.observable(),q.showInfoMessage=function(t,a){q.infoMessage(t),q.infoMessageVisible(!1),e("#infoDialogId").dialog("open"),a&&e("#infoDialogId").dialog("option","title",a)},e("#infoDialogId").on("dialogopen",function(t,a){setTimeout(function(){q.infoMessageVisible(!0),e("#infoTextId").scrollTop(0)},200)});var at;q.getConfirmFlag=function(){return at},q.setConfirmFlag=function(e){at=e},q.confirmMessage=n.observable(""),q.showConfirmMessage=function(t,a,n){M.initDialog(q.manager),q.confirmMessage(t),a&&oe.dialog("option","title",a),n&&(e(e("button",oe.parent())[1]).text(n.first),e(e("button",oe.parent())[2]).text(n.second)),oe.dialog("open")},q.isShowThumbnail=n.observable(),q.btnThumbnailShow=function(){q.isShowThumbnail(!0),e("#thumbnailDialogId").dialog("open"),q.repaintDiagram()},q.btnThumbnailHide=function(){q.isShowThumbnail(!1),q.repaintDiagram()},q.overlayText=n.observable("");var nt=e("#saveOverlayId");q.showOverlayMessage=function(e,t){var a=t||400;q.overlayText(e),nt.show(),setTimeout(function(){nt.fadeOut(a)},a+200)},q.bottomMessageText=n.observable("");var it=e("#bottomOverlayId");q.showBottomMessage=function(e,t){var a=t||1e3;q.bottomMessageText(e),it.show(),setTimeout(function(){it.fadeOut(a)},a+200)},ee.addEventListener("scroll",function(e){e.currentTarget.scrollLeft||e.currentTarget.scrollRight}),se.addEventListener("mousemove",function(e){X()},!1),se.onchange=function(){X()};var ot;q.getDraggedPaletteId=function(){return ot},q.setDraggedPaletteId=function(e){ot=e},q.onPaletteDragStart=function(e){parseInt(e.target.id)===d.flowType().DB_TABLE_2||parseInt(e.target.id)===d.flowType().DB_TABLE_3||parseInt(e.target.id)===d.flowType().DB_TABLE_4?(ot=d.flowType().DB_TABLE,e.dataTransfer.setData("text",d.flowType().DB_TABLE),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ENTITY_W?(ot=d.flowType().ENTITY,e.dataTransfer.setData("text",d.flowType().ENTITY),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().RELATION_W?(ot=d.flowType().RELATION,e.dataTransfer.setData("text",d.flowType().RELATION),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ATTR_MULTI||parseInt(e.target.id)===d.flowType().ATTR_DRV?(ot=d.flowType().ATTRIBUTE,e.dataTransfer.setData("text",d.flowType().ATTRIBUTE),e.dataTransfer.setData("altType",e.target.id)):(ot=e.target.id,e.dataTransfer.setData("text",e.target.id))},q.onPaletteDragEnd=function(e){var t=J.getBoundingClientRect();e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom||q.manager.getDnDHandler().resetDrag()},q.requestFocus=function(){},q.isControlPressed=function(){return ce},q.setControlPressed=function(e){ce=e},q.isEditControlPressed=function(){return ge},q.setEditControlPressed=function(e){ge=e},q.isShiftPressed=function(){return ue},q.setShiftPressed=function(e){ue=e},window.onresize=function(){le.style.height=window.innerHeight+"px",e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),j(),q.manager.getInlineInputEditor().relocateInlineFieldEditor(),q.manager.getInlineAreaEditor().relocateInlineAreaEditor(),q.manager.getDBTableEditor().relocateDBTableEditor(),q.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),q.manager.getDecisionLayoutEditor().relocateDecisionLayoutEditor(),q.manager.getFlowTasksEditor().relocateFlowTasksEditor(),X(),q.repaintDiagram()},window.onscroll=function(){e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),q.repaintDiagram()};var st=0,rt=e("#containerId");return q.repaintDiagram=function(){q.hideContainerBar(),q.hideSwitchBar(),q.manager.paintDiagram()},n.applyBindings(q),q.initData(),{initFlowDemo:function(){window.scrollTo(0,0),e(window).trigger("resize"),q.setProgressBarVisible(!1),q.showOverlayMessage("Connecting to server...",1e3),i.checkServerConnection(q.manager)}}});