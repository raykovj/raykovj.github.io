//self.aboutCopyright(copy);

define(["jquery","jqueryui","jqueryuictxm","knockout","modules/server/ioHandler","modules/fs/directories","modules/html/toolbar","modules/settings/config","modules/actions/frameActions","modules/graph/graphConstants","modules/gallery/components","modules/gallery/iconOptionsPicker","modules/gallery/portIconPicker","modules/gallery/cardinalityPicker","modules/gallery/decisionEnds","modules/erd/dbRecords","modules/erd/dbConstants","modules/flow/flowManager","modules/flow/flowUtils","modules/fs/fsBrowser","modules/diagram/mouseInteractor","modules/dialogs/newFlowDialog","modules/dialogs/newFolderDialog","modules/dialogs/openFlowDialog","modules/dialogs/nodePropsDialog","modules/dialogs/importExportDialog","modules/dialogs/findDialog","modules/dialogs/linkPropsDialog","modules/dialogs/dbTableEditor","modules/dialogs/aboutDialog","modules/util/startText","modules/dialogs/infoDialog","modules/dialogs/confirmDialog","modules/dialogs/confirmDialog2","modules/dialogs/confirmSrvDialog","modules/dialogs/thumbnailDialog","modules/settings/settingsDialog","modules/geometry/point","modules/util/utils","modules/draw/draw","modules/controller/flowCache","modules/util/integrationText"],function(e,t,a,i,o,n,s,r,l,d,c,g,u,b,m,p,v,T,f,I,h,D,y,w,C,E,N,S,L,x,B,O,P,F,k,M,R,A,V,H,_,K){function W(e){e===d.flow().VERTICAL?(we.removeClass("block-extendV"),we.addClass("block-extendH"),Ce.removeClass("block-extendH"),Ce.addClass("block-extendV"),Ee.removeClass("block-shrinkV"),Ee.addClass("block-shrinkH"),Ne.removeClass("block-shrinkH"),Ne.addClass("block-shrinkV")):e===d.flow().HORIZONTAL&&(we.removeClass("block-extendH"),we.addClass("block-extendV"),Ce.removeClass("block-extendV"),Ce.addClass("block-extendH"),Ee.removeClass("block-shrinkH"),Ee.addClass("block-shrinkV"),Ne.removeClass("block-shrinkV"),Ne.addClass("block-shrinkH"))}function G(e){e===d.flow().VERTICAL?(xe.removeClass("block-extendV"),xe.addClass("block-extendH"),Be.removeClass("block-shrinkV"),Be.addClass("block-shrinkH")):e===d.flow().HORIZONTAL&&(xe.removeClass("block-extendH"),xe.addClass("block-extendV"),Be.removeClass("block-shrinkH"),Be.addClass("block-shrinkV"))}function z(e){if(te.selectedFileType()===d.fileTypes().ALL)return e;var t=[],a=te.selectedFileType().split(".").pop();return e.forEach(function(e){e.split(".").pop()===a&&t.push(e)}),t}function U(){e("#openSaveButtonOK").button("option","disabled",te.isFlowSaveBlocked())}function Z(e){r.setFlowDirection(e),Y(e),te.setFlowDirectionChange(),W(e),G(e),te.getFlowManager().hasDiagramOpen()&&te.manager.setDirty(!0),te.setConfirmFlag(d.bValue().FALSE),te.getFlowManager().setSettingsChanged(!0),setTimeout(function(){te.getFlowManager().refreshDiagramOnEdit(!0),te.getFlowManager().refreshDiagramOnEdit(!0)},200)}function Y(e){e===d.flow().VERTICAL?f.updateDecisionInputs(te.manager.getModelHandler().getFlowNodes(),d.decisionInputs().NORTH):e===d.flow().HORIZONTAL&&f.updateDecisionInputs(te.manager.getModelHandler().getFlowNodes(),d.decisionInputs().WEST)}function q(){qe.detach(),je.detach(),Je.detach(),Xe.detach(),$e.detach(),Qe.detach(),et.detach(),tt.detach(),at.detach(),it.detach(),ot.detach(),nt.detach(),st.detach(),rt.detach(),lt.detach(),dt.detach(),ct.detach(),gt.detach(),ut.detach()}function j(e){qe.appendTo(e),je.appendTo(e),Je.appendTo(e),Xe.appendTo(e),$e.appendTo(e),Qe.appendTo(e),et.appendTo(e),tt.appendTo(e),at.appendTo(e),it.appendTo(e),ot.appendTo(e),nt.appendTo(e),st.appendTo(e),rt.appendTo(e),lt.appendTo(e),dt.appendTo(e),ct.appendTo(e),gt.appendTo(e),ut.appendTo(e)}function J(e){r.setToolbarPosition(e),q(),r.getToolbarPosition()===d.toolbarPosition().SELF_ADJUST||r.getToolbarPosition()===d.toolbarPosition().HORIZONTAL?(bt.css("grid-template-rows","40px 40px auto"),pt.css("grid-template-columns","fit-content(0) auto 214px;"),It.css("visibility","hidden"),Tt.css("visibility","hidden"),ft.css("visibility","hidden"),vt.css("visibility","visible"),mt.css("height","32px"),j(vt),ht.removeClass("startHereVTip"),ht.addClass("startHereHTip")):r.getToolbarPosition()===d.toolbarPosition().VERTICAL&&(bt.css("grid-template-rows","40px 10px auto"),pt.css("grid-template-columns","fit-content(0) auto 214px;"),vt.css("visibility","hidden"),It.css("visibility","visible"),Tt.css("visibility","visible"),ft.css("visibility","visible"),mt.css("height","2px"),j(ft),ht.removeClass("startHereHTip"),ht.addClass("startHereVTip"))}function X(){var t=e(window).scrollTop(),a=document.getElementById("screenId").offsetWidth;It.css("height",t+"px"),ft.css("top",t+"px"),t>yt?r.getToolbarPosition()!==d.toolbarPosition().SELF_ADJUST&&r.getToolbarPosition()!==d.toolbarPosition().HORIZONTAL||J(d.toolbarPosition().VERTICAL):r.getToolbarPosition()===d.toolbarPosition().VERTICAL&&a>Dt&&J(d.toolbarPosition().HORIZONTAL)}function $(){te.flowTabVisible(!1),te.erdTabVisible(!1),te.logTabVisible(!1),te.procTabVisible(!1)}function Q(){var e=document.getElementById("containerId").clientWidth;ae.width>e&&r.hasShowBottomMessages()&&te.showBottomMessage("Drag the mouse on canvas to scroll")}function ee(){var t=e(window).height();e(window).scrollTop();Bt.height(t-xt)}var te=this,ae=document.getElementById("canvasId"),ie=document.getElementById("canvasThId"),oe=ae.getContext("2d"),ne=document.getElementById("containerId"),se=document.getElementById("topContainerId"),re=e("#openFlowDialogId"),le=e("#spinnerLevelsId"),de=e("#spinnerLanesId"),ce=(e("#spinnerSpaceId"),e("#confirmDialogId")),ge=e("#confirmDialog2Id"),ue=e("#confirmSrvDialogId"),be=(e("#thumbnailDialogId"),document.getElementById("scaleId")),me=e("#nodePropsTabId"),pe=document.getElementById("paletteCtrId"),ve="[Select Diagram Type, then Start...| Open...| Template...]",Te=!1,fe=!1,Ie=!1;te.cnxOn=i.observable(d.cnxOn()),te.cnxOff=i.observable(d.cnxOff()),te.diagramTextOn=i.observable(B.getDiagramTextON()),te.diagramTextOff=i.observable(B.getDiagramTextOFF()),te.diagramTextFLOW=i.observable(B.getDiagramTextFLOW()),te.diagramTextERD=i.observable(B.getDiagramTextERD()),te.diagramTextLOG=i.observable(B.getDiagramTextLOG()),te.diagramEndText=i.observable(B.getDiagramEndText()),te.diagramAllText=i.observable(B.getDiagramTextAll()),te.accHdrFlowTitle=i.observable(d.appTitles().FLOW_TITLE),te.accHdrSideTitle=i.observable(d.appTitles().SIDE_TITLE),te.accHdrMiscTitle=i.observable(d.appTitles().MISC_TITLE),te.accHdrERDTitle=i.observable(d.appTitles().DB_ERD_TITLE),te.accHdrLOGTitle=i.observable(d.appTitles().DB_LOG_TITLE),te.accHdrPROCTitle=i.observable(d.appTitles().PROCESS_TITLE),te.accHdrPagesTitle=i.observable(d.appTitles().PAGES_TITLE),te.accHdrBpelTitle=i.observable(d.appTitles().BPEL_TITLE),te.accHdrK8sTitle=i.observable(d.appTitles().K8S_TITLE),te.getCanvas=function(){return ae},te.setCanvas=function(e){ae=e},te.getCanvasContext=function(){return oe},te.getCanvasTh=function(){return ie},te.setCanvasTh=function(e){ie=e},te.getCanvasContext=function(){return oe},te.getCanvasContainer=function(){return ne},te.manager=new T(te),te.interactor=te.manager.getMouseInteractor(),te.dndHandler=te.manager.getDnDHandler(),te.updateTrigger=i.observable(!1);var he=new I(te);te.getFlowManager=function(){return te.manager},te.isConnectionOK=i.observable(!1),te.cnxResultOK=function(){te.showOverlayMessage("Connected to server",1e3),te.isConnectionOK(!0),setTimeout(function(){te.updateWindow()},200),te.isFirstCall(!0),te.manager.getInstallSettings(),te.callStartPage(!0),te.cnxInfo(!0)},te.setCnxValue=function(t,a){te.isConnectionOK(t),te.cnxInfo(t),a&&(te.showOverlayMessage(t?"Connected to server":"No server connection",1e3),te.isFirstCall(!0),te.manager.getInstallSettings(),te.callStartPage(!0)),setTimeout(function(){te.updateWindow()},200),t||(te.showOverlayMessage("No server connection",1200),a||(e(".ui-dialog-content").dialog("close"),te.callStartPage(!0)),setTimeout(function(){console.clear()},2e3))},te.cnxResultFAIL=function(e){te.showOverlayMessage("No server connection",1e3),te.isConnectionOK(!1),setTimeout(function(){console.clear(),te.updateWindow()},200),te.isFirstCall(!0),te.manager.getInstallSettings(),te.callStartPage(!0),te.cnxInfo(!1)},te.cnxInfo=i.observable(!1),te.isFirstCall=i.observable(!1),e(document).ready(function(){function t(e){te.isDgmFlow(e)}function a(t){return e("<img>",{style:"margin: 0 6px -2px -22px;",src:g.getIconURL(t.value)})}function o(t){return e("<img>",{style:"margin: 0 6px -2px 0;",src:g.getIconURL(t.value)})}function n(t){return e("<img>",{style:"margin: 0px 6px 2px 10px; ",src:u.getPortIconURL(t.value)})}function c(t){return e("<img>",{style:"margin: 0 6px -2px 6px; background-color: white; }",src:u.getPortIconURL(t.value)})}oe.canvas.width=0,oe.canvas.height=0,D.initDialog(te.manager),y.initDialog(te.manager),w.initDialog(te.manager),R.initDialog(te.manager),C.initDialog(te.manager),E.initDialog(te.manager),N.initDialog(te.manager),S.initDialog(te.manager),x.initDialog(te.manager),O.initDialog(te.manager),P.initDialog(te.manager),F.initDialog(te.manager),k.initDialog(te.manager),M.initDialog(te.manager),s.initButtons(te),l.initActions(te),e("#startLogoBtnId").attr("disabled",!0),e("#aboutLogoBtnId").attr("disabled",!0),e("#canvasId").contextmenu(te.interactor.getContextMenu()),se.addEventListener("mousemove",function(t){te.interactor.isOverCanvas(t)||(e("#canvasId").contextmenu("close"),te.manager.getFlowDiagram().setMousePoint(void 0))}),e("#paletteAccordionId").accordion({heightStyle:"fill",animate:{easing:"swing",duration:200},collapsible:!0,create:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header").css("height","12"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE")},activate:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE");a.newHeader.context&&a.newHeader.context.innerText;te.updateWindow()}}),setTimeout(function(){e("#paletteAccordionId").accordion("option","icons",{header:"ui-icon-triangle-1-e",activeHeader:"ui-icon-triangle-1-s"})},100),e("#accTableFlowId").height(262),e("#accTableMiscsId").height(184),e("#accTableERDId").height(80),e("#accTableLOGId").height(184),e("#accTablePROCId").height(28),te.isDgmFlow=i.observable(!1),e("#btnDgmModeDId").click(function(e,a){t(!0)}),e("#btnDgmModeUId").click(function(e,a){t(!1)}),te.hasDiagram=i.observable(!1),te.setDiagramOpen=function(e){te.hasDiagram(e)},e("#settingsTabId").tabs({}),e("#integrationTabId").tabs({}),e("textarea").keydown(function(t){33==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),t.target.setSelectionRange(0,0),e(this).scrollTop(0)),34==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),textareaLength=e(this).val().length,t.target.setSelectionRange(textareaLength,textareaLength),e(this).scrollTop(9999))}),me.tabs({activate:function(e,t){1===t.newTab.index()?me.css({overflow:"auto"}):me.css({overflow:"hidden"})}}),e("#infoTextId").attr("visibility","hidden");var b=e("#progressBarId");b.progressbar({value:!1}),b.height(14),e.widget("nodeIcons.iconselectmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{text:g.getIconLabel(t.value)});return o(t).prependTo(a),a},_renderItem:function(t,i){var o=e("<li>"),n=e("<div>",{text:g.getIconLabel(i.value)});return a(i).prependTo(n),o.append(n).appendTo(t)},_renderMenu:function(t,a){var i=this,o=g.getOptionItems(a);e.each(o,function(e,a){i._renderItemData(t,a)})},refreshButtonItem:function(e,t){if(r.getDiagramType()===d.diagramType().FLOWCHART){var a=g.getIndexValue(e,t);this.element[0].selectedIndex=a,this.refresh()}}}),e("#nodeIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e("#settingIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e.widget("portImages.porticonmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{style:"padding-left: 16px; height: 16px; width: 100px; background-color: white"});return n(t).prependTo(a),a},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{style:"height: 16px; width: 120px"});return c(a).prependTo(o),i.append(o).appendTo(t)},_renderMenu:function(t,a){var i=this,o=u.getPortOptionItems(a);e.each(o,function(e,a){i._renderItemData(t,a)})},refreshButtonItem:function(e){var t=u.getPortIndexValue(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#selectPortIconsId").porticonmenu().porticonmenu("menuWidget").addClass("ui-menu-icons porticons"),e.widget("settings.schemenames",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.value})},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{text:a.value});return i.append(o).appendTo(t)},_renderMenu:function(t,a){var i=this,o=te.manager.getSettingsManager().getOptionsPicker().getOptions();e.each(o,function(e,a){i._renderItemData(t,a)})},refreshButtonItem:function(e){var t=te.manager.getSettingsManager().getOptionsPicker().getIndex(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#settingSchemesId").schemenames({width:240}).schemenames("menuWidget").addClass("ui-menu-icons schemenames"),e("#selectPartitionId").selectmenu({select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;console.log("$$$ disk select: "+a),te.selectedPartition(a)}},change:function(e,t){e.currentTarget.textContent},create:function(e,t){setTimeout(function(){te.manager.getDiskNames()},1e3)}}).addClass("settingsDiskMenu").css("fontSize","16px"),e("#selectFileTypeId").selectmenu({create:function(t,a){setTimeout(function(){te.selectedFileType(d.fileTypes().ALL),e("#selectFileTypeId").selectmenu("refresh")},1e3)},select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;te.selectedFileType(a),te.manager.getDirContent()}}}).addClass("settingsDiskMenu"),e.widget("dbScripts.inOutmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{text:a.label});return i.append(o).appendTo(t)}}),e("#importExportId").inOutmenu({icons:{button:"ui-icon-blank"},width:160,background:"white",select:function(e,t){E.setDBSelected(document.getElementById("importExportId").value)}}).inOutmenu("menuWidget"),te.refreshImportMenu=function(){e("#importExportId").inOutmenu("refresh")},e.widget("demomenu.demofilesmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},refreshButtonItem:function(e){this.refresh()}}),e("#selectFileId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#flowMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#dbMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#logMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#procMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#cnstrDBTypeId").selectmenu(),e("#dbCPKTypeId").selectmenu(),e("#dbCPKCol1").selectmenu(),e("#dbCPKCol2").selectmenu(),e("#dbCPKCol3").selectmenu(),e.widget("dbScripts.cstrtypes",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var i=e("<li>"),o=e("<div>",{text:a.label});return i.append(o).appendTo(t)},_renderMenu:function(t,a){var i=this;e.each(a,function(e,a){i._renderItemData(t,a)})}}),e("#cnstrDBTypeId").cstrtypes({icons:{button:"ui-icon-caret-1-s"},width:18}).cstrtypes("menuWidget").addClass("ui-menu-icons cstrtypes")}),te.startHereVisible=i.pureComputed(function(){return!te.hasDiagram()&&!te.isStartPage()&&!te.hasDialogsOpen()}),te.hasDialogsOpen=i.observable(!1),te.setHasDialogsOpen=function(e){te.hasDialogsOpen(e),e||te.hasDiagram()||te.manager.clearDiagram(!0)},te.disableInactiveTypeButtons=function(e){e?r.getDiagramType()===d.diagramType().ERD_DB?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=!e):r.getDiagramType()===d.diagramType().ERD_LOG?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e):(document.getElementById("btnFlowId").disabled=!e,document.getElementById("btnERDId").disabled=e):(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e)},te.diagramTypeFlow=i.observable(d.diagramTypeText().FLOWCHART),te.diagramTypeERD=i.observable(d.diagramTypeText().ERD_DB),te.diagramTypeLOG=i.observable(d.diagramTypeText().ERD_LOG),te.diagramTypeProc=i.observable(d.diagramTypeText().PROCESS),te.enforceDiagramType=function(t){t===d.diagramTypeText().ERD_DB?(e("#btnERDId").prop("checked",!0),r.setDiagramType(d.diagramType().ERD_DB),r.setFlowDirection(d.flow().VERTICAL),te.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",0),r.setShowNodeTasks(!1),r.setShowDBRecords(!0),r.setShowCardinality(!0),r.setShowRefHandles(!1),r.setShowNodeIcons(!1),r.setHideNodeNames(!1),r.setLinkStyle(d.linkStyle().STRAIGHT_LINE),r.setSegmentsGap(d.segmentsGap().MAX),r.setGridSpace(d.gridSpace().MAX),te.isFirstCall(!1),te.setERDTabVisible(),te.selectedDBName().length):(e("#btnFlowId").prop("checked",!0),r.setDiagramType(d.diagramType().FLOWCHART),e("#btnHorizontal").prop("disabled",!1),document.getElementById("btnFlowVId").disabled=!1,e("#paletteAccordionId").accordion("option","active",1),r.setSegmentsGap(d.segmentsGap().MIN),r.setGridSpace(d.gridSpace().MIN),r.setHideNodeNames(!1),r.setShowDBRecords(!1),r.setShowCardinality(!1),r.setShowNodeTasks(!1),r.setLinkStyle(d.linkStyle().SINGLE_ARROW),te.isFirstCall(!1),te.showDBName(!1),te.selectedDBName(""),te.setFlowTabVisible()),te.disableInactiveTypeButtons(!0),te.updateWindow()},te.showIconSelection=i.pureComputed(function(){return r.getDiagramType()===d.diagramType().FLOWCHART}),te.dbsToImport=i.observableArray(E.currentDBTypes()),te.dbsToExport=i.observableArray(E.currentDBTypes()),te.showDBName=i.observable(!1),te.selectedDBName=i.observable(""),te.dbCallParams={},te.isSelectedMySQL=i.computed(function(){return te.selectedDBName()===v.mysql()}),te.isSelectedT_SQL=i.computed(function(){return te.selectedDBName()===v.t_sql()}),te.dbSchemaName=i.observable(""),te.callInOutDialog=function(){e("#importExportDialogId").dialog("open")},te.isAutoLayoutAllowed=i.observable(r.isAllowAuto()),te.dbNodeRecords=i.observableArray(),te.showDBTableEditorOnLeft=i.observable(!1),te.showDBCardinalityOnLeft=i.observable(!1),te.showDBTable=i.observable(!0),te.dbTableErrorMsg=i.observable(!1),te.dbColumnKeys=i.observableArray(te.manager.getDBTableEditor().dbColumnKeys()),te.keyId=i.observable(""),te.dbDataColumnTypes=i.observableArray(te.manager.getDBTableEditor().dbColumnTypes()),te.typeId=i.observable(""),te.dbTableLength=i.observable(""),te.showDBConstraints=i.observable(!1),te.dbTableConstraints=i.observableArray(te.manager.getDBTableEditor().dbTypeConstraints()),te.showDBKeys=i.observable(!0),te.showDBIndexes=i.observable(!1),te.dbTableIndexes=i.observableArray(),te.dbCompositePKs=i.observableArray(),te.dbCompositePKTypes=i.observableArray(),te.showDBCompositePK=i.observable(!0),te.compositePKColumns=i.observableArray(),te.isDefault=function(e){return console.log(e),"DEFAULT"!==e},te.showDecisionEditorOnLeft=i.observable(!1),te.nodeEmojiItems=i.pureComputed(function(){return g.getNodeIconOptions()}),te.portIcons=i.pureComputed(function(){return u.getPortIconOptions()}),te.cardinalityItems=i.pureComputed(function(){return b.getCardinalityList()}),te.enableShowCardinality=i.observable(!1),te.setEnableShowCardinality=function(e){te.enableShowCardinality(e)},te.enableShowDB=i.observable(!1),te.setEnableShowDB=function(e){te.enableShowDB(e)},te.onOpsActionChange=function(e){},te.isProgressBarVisible=i.observable(!1),te.isProgressBarVisible.extend({notify:"always"}),te.setProgressBarVisible=function(e){te.isProgressBarVisible(e)},te.showPageMode=i.observable(r.hasPageMode()),te.isCanvasVisible=i.observable(!1),te.setCanvasVisible=function(e){te.isCanvasVisible(e)},te.scaleValue=i.observable(r.getScale()),e("#scaleId").slider(),be.oninput=function(){r.setScale(this.value/d.scale().FACTOR),te.scaleValue(r.getScale()),te.manager.clearClipboard(),te.manager.getFlowDiagram().clearCanvas(),te.manager.rebuildFlowData()},te.editModeText=i.observable(r.isEditMode()?d.editModeText().EDIT:d.editModeText().VIEW),te.setEditModeText=function(e){e===d.editMode().EDIT_ALL?te.editModeText(d.editModeText().EDIT):te.editModeText(d.editModeText().VIEW)},te.setTooltipBox=function(e,t){e.length>0&&r.isEditMode()&&1===r.getScale()&&H.drawTooltip(oe,ae.getBoundingClientRect(),t,e)},te.showTooltipBox=function(e){},te.getCurrentShortFileName=function(){var e=te.manager.getFileName(),t=e.indexOf(".json"),a=e.substring(0,t),i=a.lastIndexOf("/");return a.substring(i+1)};var De,ye=document.getElementById("blockResizeId"),we=e("#extendBlockAcrossId"),Ce=e("#extendBlockAlongId"),Ee=e("#shrinkBlockAcrossId"),Ne=e("#shrinkBlockAlongId");te.showBlockResizeBar=function(e){var t=e.getExpandedShape(),a=r.getScale();ye.style.left=ae.getBoundingClientRect().left+t.x*a+"px",ye.style.top=ae.getBoundingClientRect().top+t.y*a-24+"px",we.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Ce.attr("disabled",!r.isEditMode()||!e.canExtendAlong()),Ee.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),Ne.attr("disabled",!r.isEditMode()||!e.canShrinkAlong()),ye.style.visibility="visible"},te.doResizeContainer=function(e){var t=te.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().CONTAINER&&t[0].resizeOutline(e),ye.style.visibility="hidden",De=!1},te.isBlockResizeBarVisible=function(){return De},te.hideContainerBar=function(){ye.style.visibility="hidden"};var Se,Le=document.getElementById("switchResizeId"),xe=e("#extendSwitchAcrossId"),Be=e("#shrinkSwitchAcrossId");te.showSwitchResizeBar=function(e){var t=e.getMenuBarPosition(),a=r.getScale();Le.style.left=ae.getBoundingClientRect().left+t.x*a+"px",Le.style.top=ae.getBoundingClientRect().top+t.y*a-24+"px",xe.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Be.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),Le.style.visibility="visible"},te.doResizeSwitch=function(e){var t=te.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().SWITCH&&t[0].resizeOutline(e),Le.style.visibility="hidden",Se=!1},te.isSwitchResizeBarVisible=function(){return Se},te.hideSwitchBar=function(){Le.style.visibility="hidden"},te.showSearchList=i.observable(!1),te.showFindOptions=i.observable(!0),te.searchContentList=i.observableArray(),te.foundMatches=i.observable(),te.onFindTableClick=function(e){var t=e.target.innerText;N.selectedNewDisk(t)},te.onFindTableDblClick=function(e){te.onFindTableClick(e)},te.onPasteSearchText=function(e){N.selectedNewDisk(label)},te.currentPath=i.observable(),te.fsContentList=i.observableArray(),te.selectedPath=i.observable(),te.isOpenMode=i.observable(),te.isSaveMode=i.observable(),te.isImportDBMode=i.observable(),te.isStartDBMode=i.observable(),te.isExportDBMode=i.observable(),te.showPartitions=i.observable(!1),te.partitionsList=i.observableArray([""]),te.selectedPartition=i.observable(),te.filesTypes=i.observableArray([d.fileTypes().JSON,d.fileTypes().ALL]),te.selectedFileType=i.observable(d.fileTypes().JSON);te.onLogoClick=function(e){},te.showTemplatesOnly=i.observable(!1),te.setShowTemplatesOnly=function(e){te.showTemplatesOnly(e)},te.callOpenFlowDialog=function(t,a){if(t){if(te.setFSDialogMode(d.fsDialogMode().OPEN),te.setShowTemplatesOnly(!0),r.getDiagramType()===d.diagramType().FLOWCHART)te.flowTemplates(te.manager.getTemplates().getFlowTemplatesList()),e("#flowMenuId").demofilesmenu("refresh");else if(r.getDiagramType()===d.diagramType().ERD_DB){if(!te.selectedDBName())return void te.callInOutDialog();te.dbTemplates(te.manager.getTemplates().getDBTemplatesList(te.selectedDBName())),e("#dbMenuId").demofilesmenu("refresh")}else r.getDiagramType()===d.diagramType().ERD_LOG&&(te.logTemplates(te.manager.getTemplates().getLOGTemplatesList()),e("#logMenuId").demofilesmenu("refresh"));re.dialog("open"),re.dialog({height:180})}else a===d.importExportMode().IMPORT?(te.setShowTemplatesOnly(!1),setTimeout(function(){te.isConnectionOK()&&(re.dialog({height:440}),te.manager.getRootDir(),re.dialog("open"))},20)):a===d.importExportMode().START?(te.setShowTemplatesOnly(!1),setTimeout(function(){te.isConnectionOK()&&(re.dialog("open"),re.dialog({height:180}))},20)):(te.setShowTemplatesOnly(!1),setTimeout(function(){te.isConnectionOK()?re.dialog({height:440}):re.dialog({height:180}),te.manager.getRootDir(),re.dialog("open")},20))},te.onDiskTableClick=function(e){var t=e.target.innerText;w.selectedNewDisk(t)},te.setFSDialogMode=function(e){he.setFSDialogMode(e),te.fsDialogMode(e)},te.getFSDialogMode=function(){return he.getFSDialogMode()},te.fsDialogMode=i.observable(),te.restoreWorkDir=function(){he.restoreWorkDir()},te.setWorkDir=function(e){he.setWorkDir(e)},te.getWorkDir=function(){return he.getWorkDir()},te.getSelectedFSDir=function(){return he.getSelectedFSDir()},te.getSelectedFSFile=function(){return he.getSelectedFSFile()},te.onDirTableClick=function(e){he.onDirTableClick(e)},te.deleteFSItem=function(){he.deleteFSItem()},te.onDirTableDblClick=function(e){he.onDirTableDblClick(e)},te.updateMainFSLocation=function(){he.updateMainFSLocation()},te.goOneDirBack=function(){he.goOneDirBack()},te.setDirsList=function(e,t){he.setDirsList(e,t)},te.setFolderContent=function(e,t){he.setFolderContent(e,t)},te.onFileTypeChange=function(e){he.onFileTypeChange(e)},te.showForegroundSelection=i.observable(!0),te.showBackgroundSelection=i.observable(!0),te.settingsSchemes=i.observableArray([]),te.removeFromSettingsSchemes=function(e){for(var t=-1,a=0;a<te.settingsSchemes().length;a++)if(te.settingsSchemes()[a]===e){t=a;break}a>-1?te.settingsSchemes.splice(t,1):alert("bad index for settingsSchemes: "+t)};var Oe;te.setNewAction=function(e){Oe=e},te.isNewAction=function(){return Oe},te.filesList=i.observableArray();var Pe=[];te.setFilesList=function(t){if(Pe=t,te.filesList(t),te.filesList(z(t)),Oe)e("#newFlowDialogId").dialog("open");else;},te.selectedFile=i.observable(),te.getSelectedFile=function(){return te.isConnectionOK()?_selectedFile:te.selectedFile()},te.isInputInvalid=i.observable(!1),te.validateMessage=i.observable(""),te.newFSNameValue=i.observable(""),te.nameValueEmpty=i.observable(""),te.validateFSName=function(t,a){var i=V.trimMultipleSpaces(te.newFSNameValue()),o=a?n.getDirectoriesLabels():te.filesList();te.nameValueEmpty(0===i.length);var s=(te.isInputInvalid(),V.containsFSName(o,i)),r=V.isFSNameValid(te.newFSNameValue()),l=i.length>0&&(!r||s);te.isInputInvalid(l),e("#newFlowButtonOK").button("option","disabled",te.isInputInvalid()||te.nameValueEmpty()),e("#newFolderButtonOK").button("option","disabled",te.isInputInvalid()||te.nameValueEmpty()),r?s?te.validateMessage("Duplicate name"):te.validateMessage(""):te.validateMessage("Only alphanumericals, slashes, dots, dashes, underscores"),t&&i.length>0&&r&&"Enter"===t.code&&(Oe?(D.createNewDiagram(te.manager),e("#newFlowDialogId").dialog("close")):(y.createNewFolder(te.manager),e("#newFolderDialogId").dialog("close")))},te.saveAsInputInvalid=i.observable(!1),te.saveAsMessage=i.observable(""),te.saveAsFileNameValue=i.observable(""),te.saveAsNameEmpty=i.observable(""),te.validateSaveAsFileName=function(e){var t=V.trimMultipleSpaces(te.editNameValue());if(t.length>0){var a=V.containsFSName(te.filesList(),t),i=V.isFSNameValid(t),o=!a&&i;te.isEditNameInvalid(!o)}a?te.validateNameMessage("Duplicate name"):i?te.validateNameMessage(""):te.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores")},te.saveAsNewVersion=i.observable(1),te.versionInputInvalid=i.observable(!1),te.validateAsVersion=function(e){var t=(te.saveAsNewVersion(),V.isVersionNumber(te.saveAsNewVersion()));te.versionInputInvalid(!t),U()},te.isFlowSaveBlocked=function(){return te.saveAsInputInvalid()||te.saveAsNameEmpty()||te.saveAsNewVersion()&&te.versionInputInvalid()};var Fe=i.observable();te.propsLinkSourceName=i.observable(),te.propsLinkSourceLabel=i.observable(),te.propsLinkTargetName=i.observable(),te.propsLinkTargetLabel=i.observable(),te.propsLinkLabel=i.observable(),te.getPropsLink=function(){return Fe()},te.getPropsLinkLabelValue=function(){return te.propsLinkLabel()},te.showLinkProps=function(t){Fe(t),te.propsLinkSourceName(Fe().getLinkSourcePortName()),te.propsLinkSourceLabel(Fe().getLinkSourcePortLabel()),te.propsLinkTargetName(Fe().getLinkTargetPortName()),te.propsLinkTargetLabel(Fe().getLinkTargetPortLabel()),te.propsLinkLabel(Fe().getLinkLabel()),e("#linkPropsDialogId").dialog("open")},te.propsFgndVisible=i.observable(!0),te.setPropsFgndVisible=function(e){te.propsFgndVisible(e)},te.propsNodeInputs=i.observableArray();var ke,Me;te.getPropsNodeInputsIdx=function(){return ke},te.getPropsNodeInputsValue=function(){return Me},te.propsNodeOutputs=i.observableArray();var Re,Ae;te.getPropsNodeOutputsIdx=function(){return Re},te.getPropsNodeOutputsValue=function(){return Ae},te.propsNodeRefInputs=i.observableArray();var Ve,He;te.getPropsNodeRefInputsIdx=function(){return Ve},te.getPropsNodeRefInputsValue=function(){return He},te.propsNodeRefOutputs=i.observableArray();var _e,Ke;te.getPropsNodeRefOutputsIdx=function(){return _e},te.getPropsNodeRefOutputsValue=function(){return Ke};var We=i.observable();te.setPropsNode=function(e){We(e)},te.getPropsNode=function(){return We()},te.propsNodeName=i.computed(function(){return We()?We().getName():"?"},this),te.showNodeProps=function(t){We(t),t.getFlowType()===d.flowType().DB_TABLE&&t.closeDBEditors(),g.setNodeCategory(t.getNodeCategory()),te.propsNodeInputs(We().getInputPortsProperties()),te.propsNodeOutputs(We().getOutputPortsProperties()),te.propsNodeRefInputs(We().getRefInPortsProperties()),te.propsNodeRefOutputs(We().getRefOutPortsProperties()),te.dbNodeRecords(We().getDBRecords()),e("#nodePropsDialogId").dialog("open")},te.dbEditorPath=i.observable("?"),te.setDBEditorPath=function(e){dbEditorPath(e)};var Ge=i.observable();te.setPropsPort=function(e){Ge(e)},te.getPropsPort=function(){return Ge()},te.propsPortName=i.observable(""),te.editPropsNodeInputLabel=function(e){ke=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeInputsTableId"),a=t.getElementsByTagName("tr");Me=a[ke].cells[2].getElementsByTagName("input")[0].value},te.checkPortInputCardinality=function(e){C.editPortInputCardinality(e)},te.editPropsNodeOutputLabel=function(e){Re=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeOutputsTableId"),a=t.getElementsByTagName("tr");Ae=a[Re].cells[2].getElementsByTagName("input")[0].value},te.checkPortOutputCardinality=function(e){C.editPortOutputCardinality(e)},te.editPropsNodeRefInputLabel=function(e){Ve=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefInputsTableId"),a=t.getElementsByTagName("tr");He=a[Ve].cells[2].getElementsByTagName("input")[0].value},te.checkPortRefInputCardinality=function(e){C.editPortRefInputCardinality(e)},te.editPropsNodeRefOutputLabel=function(e){_e=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefOutputsTableId"),a=t.getElementsByTagName("tr");Ke=a[_e].cells[2].getElementsByTagName("input")[0].value},te.checkPortRefOutputCardinality=function(e){C.editPortRefOutputCardinality(e)},te.isEditNameInvalid=i.observable(!1),te.editNameValue=i.observable(""),te.newFlowNameValue=i.observable(""),te.validateNameMessage=i.observable("");var ze;te.setOldName=function(e){ze=e},te.validateInlineNodeName=function(){var e=te.manager.getInlineInputEditor().getCurrentValue(),t=V.trimMultipleSpaces(e);te.validateEditName(t)},te.validateDialogNodeName=function(){var e=V.trimMultipleSpaces(te.editNameValue())
;te.validateEditName(e)},te.validateNewFlowName=function(){var e=V.trimMultipleSpaces(te.editNameValue());te.validateEditName(e)},te.validateNewFolderName=function(){var e=V.trimMultipleSpaces(te.editNameValue());te.validateEditName(e)},te.validateEditName=function(e){if(e.length>0){var t=V.getAllNames(te.manager.getNodeNamesMap()),a=V.isDuplicateName(ze,e,t),i=V.isNewNodeNameValid(e),o=!a&&i;te.isEditNameInvalid(!o)}a?te.validateNameMessage("Duplicate name"):i?te.validateNameMessage(""):te.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores")},te.isSchemeNameInvalid=i.observable(!1),te.schemeNameValue=i.observable(""),te.validateSchemeMessage=i.observable(""),te.validateSchemeName=function(){var e=document.getElementById("newSchemeId").value;if(e.length>0){var t=te.manager.getSettingsManager().getSchemeNames(),a=t.includes(e),i=V.isSchemeNameValid(e),o=!a&&i;te.isSchemeNameInvalid(!o)}else te.isSchemeNameInvalid(!1);a?te.validateSchemeMessage("Duplicate name"):i?te.validateSchemeMessage(""):te.validateSchemeMessage("Only alphanumericals, dots, dashes and underscores")},te.isLinkLabelInvalid=i.observable(!1),te.linkLabelValue=i.observable(""),te.validateLinkMessage=i.observable("");var Ue;te.setOldLinkLabel=function(e){Ue=e},te.validateLinkLabelName=function(e){var t=V.trimMultipleSpaces(te.linkLabelValue());if(t.length>0){var a=t===Ue||V.isNewLinkLabelValid(t);te.isLinkLabelInvalid(!a)}else te.isLinkLabelInvalid(!1);a?te.validateLinkMessage(""):te.validateLinkMessage("Only alphanumericals, slashes, dots, dashes, underscores")},te.isFieldInvalid=i.observable(!1),te.fieldValue=i.observable(""),te.validateFieldMessage=i.observable(""),te.validateFieldName=function(){var e=document.getElementById("inputFieldId").value;if(e.length>0){var t=te.manager.getDBTableEditor().getDBRecordsFields(),a=te.manager.getDBTableEditor().getOldFieldValue(),i=t.includes(e),o=V.isDBFieldValid(e),n=e===a||!i&&o;te.isFieldInvalid(!n)}else te.isFieldInvalid(!1);i?te.validateFieldMessage("Duplicate field"):o?te.validateFieldMessage(""):te.validateFieldMessage("Only alphanumericals, dots, dashes and underscores")},te.isKeyInvalid=i.observable(!1),te.validateKeyMessage=i.observable(""),te.validateKeyValue=function(){var e=document.getElementById("inputKeyId").value,t=te.manager.getDBTableEditor().getLabelById(te.manager.getDBTableEditor().dbColumnKeys(),e);if(te.isKeyInvalid(!1),t.length>0){var a=te.manager.getDBTableEditor().getDBRecordsKeys(),i="PK"===t&&a.includes(t);te.isKeyInvalid(i)}return i?te.validateKeyMessage("Only composite primary key is allowed"):te.validateKeyMessage(""),!i},te.isCPKNameInvalid=i.observable(!1),te.fieldCPKValue=i.observable(""),te.validateCPKMessage=i.observable(""),te.validateCPKName=function(){var e=te.manager.getDBTableEditor().getNewCPKName();if(e.length>0){var t=te.manager.getDBTableEditor().getOldCPKName(),a=V.isDBFieldValid(e),i=e===t||a;te.isCPKNameInvalid(!i)}else te.isCPKNameInvalid(!1);a?te.validateCPKMessage(""):te.validateCPKMessage("Only alphanumericals, dots, dashes and underscores")},te.isDuplicateType=i.observable(!1),te.duplicateConstraintMessage=i.observable("Duplicate constraint"),te.pictureURLValue=i.observable(""),te.isPictureURLInvalid=i.observable(!1),te.validatePictureURL=function(e){te.isPictureURLInvalid(!1)},te.showNewFileName=i.observable(),te.showEditedInfo=i.observable(),te.showDecisionInfo=i.observable(),te.decisionInputPicture=i.observable(),te.decisionEndsPicture=i.observable(),te.isNodeNameInvalid=i.observable(!1),te.newNodeNameValue=i.observable(""),te.invalidNameMessage=i.observable(""),te.resetDecisionIndices=function(){te.updateTrigger(!te.updateTrigger()),m.resetCurrentIndices(),te.decisionInputPicture(m.getCurrentInputPicture()),te.decisionEndsPicture(m.getCurrentEndsPicture())},te.btnFlowH2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&te.changeFlowDirection(d.flow().VERTICAL)},te.btnFlowV2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&te.changeFlowDirection(d.flow().HORIZONTAL)},te.changeFlowDirection=function(e){Z(e)};var Ze=!1;te.hasFlowDirectionChange=function(){return Ze},te.setFlowDirectionChange=function(){Ze=!0},te.resetFlowDirectionChange=function(){Ze=!1},te.isHorizontal=i.observable(!1),te.layoutModeText=i.observable(r.getLayoutModeText()),te.diagramModeText=i.observable(r.getDiagramModeText());var Ye=e("#shutdownId"),qe=e("#menuId"),je=e("#newId"),Je=e("#openId"),Xe=e("#templateId"),$e=e("#inOutId"),Qe=e("#undoId"),et=e("#redoId"),tt=e("#deleteId"),at=e("#copyId"),it=e("#pasteId"),ot=e("#saveId"),nt=e("#saveAsId"),st=e("#refreshId"),rt=e("#findId"),lt=e("#clearId"),dt=e("#leftId"),ct=e("#rightId"),gt=e("#configId"),ut=e("#helpId"),bt=(e("#btnFlowVId"),e("#btnThumbnailId"),e("#screenId")),mt=e("#navbarId"),pt=e("#topContainerId"),vt=e("#toolbarHId"),Tt=e("#leftColumnId"),ft=e("#toolbarVId"),It=e("#tbVButtonId"),ht=e("#startHereId"),Dt=588,yt=36;te.updateWindow=function(e){te.updateTrigger(!te.updateTrigger()),te.isHorizontal(r.getFlowDirection()===d.flow().HORIZONTAL),te.layoutModeText(r.getLayoutModeText()),te.diagramModeText(r.getDiagramModeText());var t=!r.isEditMode();s.updateMenus(te),Ye.attr("disabled",!te.isConnectionOK()),je.attr("disabled",!te.isConnectionOK()),Je.attr("disabled",!te.isConnectionOK()),Xe.attr("disabled",!te.isConnectionOK()),$e.attr("disabled",r.getDiagramType()!==d.diagramType().ERD_DB||te.startHereVisible()||te.isStartPage()||te.manager.isTemplate()||te.manager.isDirty()),Qe.attr("disabled",t||!te.manager.canUndo()).attr("title",te.manager.getUndoName()),et.attr("disabled",t||!te.manager.canRedo()).attr("title",te.manager.getRedoName()),tt.attr("disabled",t||!te.manager.getSelectionManager().hasSelections()),at.attr("disabled",t||!te.manager.canCopy()),it.attr("disabled",t||!te.manager.readyToPaste()),ot.attr("disabled",t||!te.isConnectionOK()||!te.manager.isDirty()||te.manager.isTemplate()),nt.attr("disabled",t||!te.isConnectionOK()||te.manager.getModelHandler().isDiagramEmpty()),st.attr("disabled",!te.isCanvasVisible()),rt.attr("disabled",!te.isCanvasVisible()),lt.attr("disabled",t||!te.isCanvasVisible()),dt.attr("disabled",!te.manager.hasPreviousDiagram()),ct.attr("disabled",!te.manager.hasNextDiagram()),"visible"!==document.getElementById("blockResizeId").style.visibility||De?De&&(document.getElementById("blockResizeId").style.visibility="hidden",De=!1):De=!0,"visible"!==document.getElementById("switchResizeId").style.visibility||Se?Se&&(document.getElementById("switchResizeId").style.visibility="hidden",Se=!1):Se=!0,te.manager.isInitialResizeMode()&&te.manager.getModelHandler().isDiagramEmpty()?(le.attr("disabled",!1),de.attr("disabled",!1)):(le.attr("disabled",!0),de.attr("disabled",!0)),te.disableInactiveTypeButtons(!te.manager.getModelHandler().isDiagramEmpty())},te.initData=function(){te.updateWindow()},te.galleryFlowNodes=i.pureComputed(function(){return te.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getFlowNodesH():c.getFlowNodesV()}),te.galleryMiscNodes=i.pureComputed(function(){return te.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getMiscNodesH():c.getMiscNodesV()}),te.galleryERDNodes=i.pureComputed(function(){return te.updateTrigger(),c.getERDNodes()}),te.galleryLOGNodes=i.pureComputed(function(){return te.updateTrigger(),c.getLOGNodes()}),te.galleryProcNodes=i.pureComputed(function(){return te.updateTrigger(),c.getProcNodes()}),te.pageNodes=i.pureComputed(function(){te.updateTrigger();for(var e=[],t=r.getFlowDirection()===d.flow().HORIZONTAL?c.getHPageItems():c.getVPageItems(),a=0;a<t.length;a++)e.push(t[a]);return e}),te.diagramDisplayName=i.observable(ve),te.setDiagramDisplayName=function(e){e&&e.length>0?(te.showTemplatesOnly()&&(e=d.templateToken()+": "+e),te.diagramDisplayName(e)):te.diagramDisplayName(ve)},te.taskActionInputValue=i.observable(""),te.taskServiceInputValue=i.observable(""),te.taskSubscribeInputValue=i.observable(""),te.taskPublishInputValue=i.observable(""),te.taskOperationInputValue=i.observable(""),te.taskExpressionInputValue=i.observable(""),te.showTaskAction=i.observable(!0),te.showTaskService=i.observable(!0),te.showTaskSubscribe=i.observable(!0),te.showTaskPublish=i.observable(!0),te.showTaskOperation=i.observable(!0),te.showTaskExpression=i.observable(!0),te.taskActionSelected=i.observable(!0),te.taskServiceSelected=i.observable(!1),te.taskSubscribeSelected=i.observable(!1),te.taskPublishSelected=i.observable(!1),te.taskOperationSelected=i.observable(!1),te.taskExpressionSelected=i.observable(!1),te.nodeActionList=i.observableArray(),te.nodeOperationList=i.observableArray(),te.nodeServiceList=i.observableArray(),te.nodePublishList=i.observableArray(),te.nodeSubscribeList=i.observableArray(),te.showTaskEditorOnLeft=i.observable(!1),te.aboutTitle=i.observable(""),te.aboutVersion=i.observable(""),te.aboutText=i.observable(""),te.aboutSources=i.observable(""),te.aboutCopyright=i.observable(""),te.showAboutBox=function(t,a,i,o,n){te.aboutTitle(t),te.aboutVersion(a),te.aboutText(i),te.aboutSources(o),e("#aboutDialogId").dialog("open")},te.welcomeTitle=i.observable(""),te.welcomeGreeting=i.observable(""),te.welcomeTo=i.observable(""),te.welcomeTip=i.observable(""),te.isStartPage=i.observable(!1);document.getElementById("startToTopBtn");te.setStartPageOpen=function(e){te.isStartPage(e)},te.startTitle=i.observable(""),te.startTopText1=i.observable(""),te.startTopText2=i.observable(""),te.startFlowTitle=i.observable(""),te.startERDTitle=i.observable(""),te.startLOGTitle=i.observable(""),te.startProcessTitle=i.observable(""),te.showStartPage=function(e,t,a,i,o,n,s){te.startTitle(e),te.startTopText1(t),te.startTopText2(a),te.startFlowTitle(i),te.startERDTitle(o),te.startLOGTitle(n),te.startProcessTitle(s),te.manager.getStartPageEditor().showStartPageEditor()},te.callStartPage=function(t){var a=B.getTitle(),i=B.getTopText1(),o=B.getTopText2(),n=B.getFlowTitle(),s=B.getERDTitle(),r=B.getLOGTitle();procTitle=B.getProcessTitle(),te.showDBName(!1),e("#thumbnailDialogId").dialog("close"),te.getFlowManager().clearDiagram(),te.getFlowManager().refreshDiagram(),mt.css("height","32px"),bt.css("grid-template-rows","40px 40px auto"),te.showStartPage(a,i,o,n,s,r,procTitle)},te.templatesList=i.observableArray([""]),te.flowTemplates=i.observableArray(te.manager.getTemplates().getFlowTemplatesList()),te.dbTemplates=i.observableArray(),te.logTemplates=i.observableArray(te.manager.getTemplates().getLOGTemplatesList()),te.procTemplates=i.observableArray(te.manager.getTemplates().getPROCTemplatesList()),te.showFlowTemplates=i.observable(r.getDiagramType()===d.diagramType().FLOWCHART),te.showDBTemplates=i.observable(r.getDiagramType()===d.diagramType().ERD_DB),te.showLOGTemplates=i.observable(r.getDiagramType()===d.diagramType().ERD_LOG),te.showPROCTemplates=i.observable(r.getDiagramType()===d.diagramType().PROCESS),te.hideTextBlock=i.observable(!1),te.setHideTextBlock=function(){te.hideTextBlock(!0)},te.flowTabVisible=i.observable(),te.erdTabVisible=i.observable(),te.logTabVisible=i.observable(),te.procTabVisible=i.observable(),te.setFlowTabVisible=function(){$(),te.flowTabVisible(!0)},te.setERDTabVisible=function(){$(),te.erdTabVisible(!0)},te.setLOGTabVisible=function(){$(),te.logTabVisible(!0)},te.setPROCTabVisible=function(){$(),te.procTabVisible(!0)},te.infoMessage=i.observable(""),te.infoMessageVisible=i.observable(),te.showInfoMessage=function(t,a){te.infoMessage(t),te.infoMessageVisible(!1),e("#infoDialogId").dialog("open"),a&&e("#infoDialogId").dialog("option","title",a)},e("#infoDialogId").on("dialogopen",function(t,a){setTimeout(function(){te.infoMessageVisible(!0),e("#infoTextId").scrollTop(0)},200)});var wt;te.getConfirmSrvFlag=function(){return wt},te.setConfirmSrvFlag=function(e){wt=e},te.confirmSrvMessage=i.observable(""),te.showConfirmSrvMessage=function(t,a,i){k.initDialog(te.manager),te.confirmSrvMessage(t),a&&ue.dialog("option","title",a),i&&(e(e("button",ue.parent())[1]).text(i.first),e(e("button",ue.parent())[2]).text(i.second)),ue.dialog("open")};var Ct;te.getConfirmFlag=function(){return Ct},te.setConfirmFlag=function(e){Ct=e},te.confirmMessage=i.observable(""),te.showConfirmMessage=function(t,a,i){P.initDialog(te.manager),te.confirmMessage(t),a&&ce.dialog("option","title",a),i&&(e(e("button",ce.parent())[1]).text(i.first),e(e("button",ce.parent())[2]).text(i.second)),ce.dialog("open")};var Et;te.getConfirmFlag2=function(){return Et},te.setConfirmFlag2=function(e){Et=e},te.confirmMessage2=i.observable(""),te.showConfirmMessage2=function(t,a,i){F.initDialog(te.manager),te.confirmMessage2(t),a&&ge.dialog("option","title",a),i&&(e(e("button",ge.parent())[1]).text(i.first),e(e("button",ge.parent())[2]).text(i.second)),ge.dialog("open")},te.isShowThumbnail=i.observable(),te.btnThumbnailShow=function(){te.isShowThumbnail(!0),e("#thumbnailDialogId").dialog("open"),te.repaintDiagram()},te.btnThumbnailHide=function(){te.isShowThumbnail(!1),te.repaintDiagram()},te.overlayText=i.observable("");var Nt=e("#saveOverlayId");te.showOverlayMessage=function(e,t){var a=t||1e3;te.overlayText(e),Nt.show(),setTimeout(function(){Nt.fadeOut(a)},a+200)},te.bottomMessageText=i.observable("");var St=e("#bottomOverlayId");te.showBottomMessage=function(e,t){var a=t||1e3;te.bottomMessageText(e),St.show(),setTimeout(function(){St.fadeOut(a)},a+200)},be.addEventListener("mousemove",function(e){Q()},!1),be.onchange=function(){Q()};var Lt;te.getDraggedPaletteId=function(){return Lt},te.setDraggedPaletteId=function(e){Lt=e},te.onPaletteDragStart=function(e){parseInt(e.target.id)===d.flowType().DB_TABLE_2||parseInt(e.target.id)===d.flowType().DB_TABLE_3||parseInt(e.target.id)===d.flowType().DB_TABLE_4?(Lt=d.flowType().DB_TABLE,e.dataTransfer.setData("text",d.flowType().DB_TABLE),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ENTITY_W?(Lt=d.flowType().ENTITY,e.dataTransfer.setData("text",d.flowType().ENTITY),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().RELATION_W?(Lt=d.flowType().RELATION,e.dataTransfer.setData("text",d.flowType().RELATION),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ATTR_MULTI||parseInt(e.target.id)===d.flowType().ATTR_DRV?(Lt=d.flowType().ATTRIBUTE,e.dataTransfer.setData("text",d.flowType().ATTRIBUTE),e.dataTransfer.setData("altType",e.target.id)):(Lt=e.target.id,e.dataTransfer.setData("text",e.target.id))},te.onPaletteDragEnd=function(e){var t=ae.getBoundingClientRect();e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom||te.manager.getDnDHandler().resetDrag()},te.requestFocus=function(){},te.isControlPressed=function(){return Te},te.setControlPressed=function(e){Te=e},te.isEditControlPressed=function(){return Ie},te.setEditControlPressed=function(e){Ie=e},te.isShiftPressed=function(){return fe},te.setShiftPressed=function(e){fe=e},window.onresize=function(){pe.style.height=window.innerHeight+"px",e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),ee();var t=document.getElementById("screenId").offsetWidth,a=e(window).scrollTop();t<Dt?J(d.toolbarPosition().VERTICAL):a<yt&&J(d.toolbarPosition().HORIZONTAL),te.manager.getInlineInputEditor().relocateInlineFieldEditor(),te.manager.getInlineAreaEditor().relocateInlineAreaEditor(),te.manager.getDBTableEditor().relocateDBTableEditor(),te.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),te.manager.getDecisionLayoutEditor().relocateDecisionLayoutEditor(),C.relocateDialog(),Q(),te.repaintDiagram()},window.onscroll=function(){te.manager.getInlineInputEditor().relocateInlineFieldEditor(),te.manager.getInlineAreaEditor().relocateInlineAreaEditor(),te.manager.getDBTableEditor().relocateDBTableEditor(),te.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),X(),e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),te.repaintDiagram()};var xt=0,Bt=e("#containerId");return te.repaintDiagram=function(){te.hideContainerBar(),te.hideSwitchBar(),te.manager.paintDiagram()},te.initData(),{initFlowDemo:function(){window.scrollTo(0,0),te.setProgressBarVisible(!1),o.checkConnection(te.manager),setTimeout(function(){e(window).trigger("resize")},100)}}});