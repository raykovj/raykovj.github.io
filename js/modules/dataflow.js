//self.aboutCopyright(copy);

define(["jquery","jqueryui","jqueryuictxm","knockout","modules/server/ioHandler","modules/fs/directories","modules/html/toolbar","modules/settings/config","modules/actions/frameActions","modules/graph/graphConstants","modules/gallery/components","modules/gallery/iconOptionsPicker","modules/gallery/portIconPicker","modules/gallery/cardinalityPicker","modules/gallery/decisionEnds","modules/erd/dbRecords","modules/flow/flowManager","modules/flow/flowUtils","modules/fs/fsBrowser","modules/diagram/mouseInteractor","modules/dialogs/newFlowDialog","modules/dialogs/newFolderDialog","modules/dialogs/openFlowDialog","modules/dialogs/nodePropsDialog","modules/dialogs/importExportDialog","modules/dialogs/findDialog","modules/dialogs/linkPropsDialog","modules/dialogs/dbTableEditor","modules/dialogs/aboutDialog","modules/util/welcomeText","modules/util/startText","modules/dialogs/welcomeDialog","modules/dialogs/infoDialog","modules/dialogs/confirmDialog","modules/dialogs/thumbnailDialog","modules/settings/settingsDialog","modules/geometry/point","modules/util/utils","modules/draw/draw","modules/controller/flowCache","modules/exportLayout/demoFlow","modules/util/integrationText"],function(e,t,a,n,i,o,s,r,l,d,c,u,g,b,m,p,v,T,f,I,h,y,D,w,E,C,N,S,L,B,M,O,F,k,x,P,R,A,V,H,_,K){function G(e){e===d.flow().VERTICAL?(fe.removeClass("block-extendV"),fe.addClass("block-extendH"),Ie.removeClass("block-extendH"),Ie.addClass("block-extendV"),he.removeClass("block-shrinkV"),he.addClass("block-shrinkH"),ye.removeClass("block-shrinkH"),ye.addClass("block-shrinkV")):e===d.flow().HORIZONTAL&&(fe.removeClass("block-extendH"),fe.addClass("block-extendV"),Ie.removeClass("block-extendV"),Ie.addClass("block-extendH"),he.removeClass("block-shrinkH"),he.addClass("block-shrinkV"),ye.removeClass("block-shrinkV"),ye.addClass("block-shrinkH"))}function W(e){e===d.flow().VERTICAL?(Ee.removeClass("block-extendV"),Ee.addClass("block-extendH"),Ce.removeClass("block-shrinkV"),Ce.addClass("block-shrinkH")):e===d.flow().HORIZONTAL&&(Ee.removeClass("block-extendH"),Ee.addClass("block-extendV"),Ce.removeClass("block-shrinkH"),Ce.addClass("block-shrinkV"))}function z(e){if(Q.selectedFileType()===d.fileTypes().ALL)return e;var t=[],a=Q.selectedFileType().split(".").pop();return e.forEach(function(e){e.split(".").pop()===a&&t.push(e)}),t}function U(){e("#openSaveButtonOK").button("option","disabled",Q.isFlowSaveBlocked())}function Z(e){r.setFlowDirection(e),X(e),Q.setFlowDirectionChange(),G(e),W(e),Q.getFlowManager().hasDiagramOpen()&&Q.manager.setDirty(!0),Q.setConfirmFlag(d.bValue().FALSE),Q.getFlowManager().setSettingsChanged(!0),setTimeout(function(){Q.getFlowManager().refreshDiagramOnEdit(!0),Q.getFlowManager().refreshDiagramOnEdit(!0)},200)}function X(e){e===d.flow().VERTICAL?T.updateDecisionInputs(Q.manager.getModelHandler().getFlowNodes(),d.decisionInputs().NORTH):e===d.flow().HORIZONTAL&&T.updateDecisionInputs(Q.manager.getModelHandler().getFlowNodes(),d.decisionInputs().WEST)}function Y(){Q.flowTabVisible(!1),Q.erdTabVisible(!1),Q.logTabVisible(!1),Q.procTabVisible(!1)}function j(){var e=document.getElementById("containerId").clientWidth;$.width>e&&r.hasShowBottomMessages()&&Q.showBottomMessage("Drag the mouse on canvas to scroll")}function q(){var t=e(window).height();e(window).scrollTop();lt.height(t-rt)}var Q=this,$=document.getElementById("canvasId"),J=document.getElementById("canvasThId"),ee=$.getContext("2d"),te=document.getElementById("containerId"),ae=document.getElementById("topContainerId"),ne=e("#openFlowDialogId"),ie=e("#spinnerLevelsId"),oe=e("#spinnerLanesId"),se=(e("#spinnerSpaceId"),e("#confirmDialogId")),re=(e("#thumbnailDialogId"),document.getElementById("scaleId")),le=e("#nodePropsTabId"),de=document.getElementById("paletteCtrId"),ce="[Select Diagram Type, then Start.../ Open.../ Template...]",ue=!1,ge=!1,be=!1;Q.accHdrFlowTitle=n.observable(d.appTitles().FLOW_TITLE),Q.accHdrSideTitle=n.observable(d.appTitles().SIDE_TITLE),Q.accHdrMiscTitle=n.observable(d.appTitles().MISC_TITLE),Q.accHdrERDTitle=n.observable(d.appTitles().DB_ERD_TITLE),Q.accHdrLOGTitle=n.observable(d.appTitles().DB_LOG_TITLE),Q.accHdrPROCTitle=n.observable(d.appTitles().PROCESS_TITLE),Q.accHdrPagesTitle=n.observable(d.appTitles().PAGES_TITLE),Q.accHdrBpelTitle=n.observable(d.appTitles().BPEL_TITLE),Q.accHdrK8sTitle=n.observable(d.appTitles().K8S_TITLE),Q.getCanvas=function(){return $},Q.setCanvas=function(e){$=e},Q.getCanvasContext=function(){return ee},Q.getCanvasTh=function(){return J},Q.setCanvasTh=function(e){J=e},Q.getCanvasContext=function(){return ee},Q.getCanvasContainer=function(){return te},Q.getTopContainer=function(){return ae},Q.manager=new v(Q),Q.interactor=Q.manager.getMouseInteractor(),Q.dndHandler=Q.manager.getDnDHandler(),Q.updateTrigger=n.observable(!1);var me=new f(Q);Q.getFlowManager=function(){return Q.manager};var pe=(Date.now(),!1);Q.isConnectionOK=n.observable(pe),Q.cnxResultOK=function(){pe=!0,Q.showOverlayMessage("Connected",800),Q.isConnectionOK(pe),setTimeout(function(){Q.updateWindow()},200),Q.isFirstCall(!0),Q.manager.getInstallSettings(),Q.callStartPage(!0),Q.cnxInfo(!0)},Q.cnxResultFAIL=function(e){Date.now();pe=!1,console.clear(),setTimeout(function(){Q.showOverlayMessage("No server connection",800)},200),Q.isConnectionOK(pe),setTimeout(function(){console.clear(),Q.updateWindow()},200),Q.isFirstCall(!0),Q.manager.getInstallSettings(),Q.callStartPage(!0),Q.cnxInfo(!1)},Q.isFirstCall=n.observable(),e(document).ready(function(){function t(e){Q.isDgmFlow(e)}function a(t){return e("<img>",{style:"margin: 0 6px -2px -22px;",src:u.getIconURL(t.value)})}function i(t){return e("<img>",{style:"margin: 0 6px -2px 0;",src:u.getIconURL(t.value)})}function o(t){return e("<img>",{style:"margin: 0px 6px 2px 10px; ",src:g.getPortIconURL(t.value)})}function c(t){return e("<img>",{style:"margin: 0 6px -2px 6px; background-color: white; }",src:g.getPortIconURL(t.value)})}ee.canvas.width=0,ee.canvas.height=0,h.initDialog(Q.manager),y.initDialog(Q.manager),D.initDialog(Q.manager),P.initDialog(Q.manager),w.initDialog(Q.manager),E.initDialog(Q.manager),C.initDialog(Q.manager),N.initDialog(Q.manager),L.initDialog(Q.manager),F.initDialog(Q.manager),k.initDialog(Q.manager),x.initDialog(Q.manager),O.initDialog(Q.manager),s.initButtons(Q),l.initActions(Q),e("#canvasId").contextmenu(Q.interactor.getContextMenu()),ae.addEventListener("mousemove",function(t){Q.interactor.isOverCanvas(t)||(e("#canvasId").contextmenu("close"),Q.manager.getFlowDiagram().setMousePoint(void 0))}),e("#paletteAccordionId").accordion({heightStyle:"fill",animate:{easing:"swing",duration:200},collapsible:!0,create:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header").css("height","12"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE")},activate:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE");a.newHeader.context&&a.newHeader.context.innerText;Q.updateWindow()}}),setTimeout(function(){e("#paletteAccordionId").accordion("option","icons",{header:"ui-icon-triangle-1-e",activeHeader:"ui-icon-triangle-1-s"})},100),e("#accTableFlowId").height(262),e("#accTableMiscsId").height(184),e("#accTableERDId").height(80),e("#accTableLOGId").height(184),e("#accTablePROCId").height(28),Q.isDgmFlow=n.observable(!1),e("#btnDgmModeDId").click(function(e,a){t(!0)}),e("#btnDgmModeUId").click(function(e,a){t(!1)}),Q.hasDiagram=n.observable(!1),Q.setDiagramOpen=function(e){Q.hasDiagram(e)},e("#settingsTabId").tabs({}),e("#integrationTabId").tabs({}),e("textarea").keydown(function(t){33==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),t.target.setSelectionRange(0,0),e(this).scrollTop(0)),34==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),textareaLength=e(this).val().length,t.target.setSelectionRange(textareaLength,textareaLength),e(this).scrollTop(9999))}),le.tabs({activate:function(e,t){1===t.newTab.index()?le.css({overflow:"auto"}):le.css({overflow:"hidden"})}}),e("#infoTextId").attr("visibility","hidden"),ie.spinner({step:1,min:d.canvasRange().MIN,max:d.canvasRange().MAX,numberFormat:"n"}),ie.spinner("value",d.initial().LEVELS),ie.spinner("enable"),oe.spinner({step:1,min:d.canvasRange().MIN,max:d.canvasRange().MAX,numberFormat:"n"}),oe.spinner("value",d.initial().LANES),oe.spinner("enable");var b=e("#progressBarId");b.progressbar({value:!1}),b.height(14),e.widget("nodeIcons.iconselectmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{text:u.getIconLabel(t.value)});return i(t).prependTo(a),a},_renderItem:function(t,n){var i=e("<li>"),o=e("<div>",{text:u.getIconLabel(n.value)});return a(n).prependTo(o),i.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this,i=u.getOptionItems(a);e.each(i,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e,t){if(r.getDiagramType()===d.diagramType().FLOWCHART){var a=u.getIndexValue(e,t);this.element[0].selectedIndex=a,this.refresh()}}}),e("#nodeIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e("#settingIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e.widget("portImages.porticonmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{style:"padding-left: 16px; height: 16px; width: 100px; background-color: white"});return o(t).prependTo(a),a},_renderItem:function(t,a){var n=e("<li>"),i=e("<div>",{style:"height: 16px; width: 120px"});return c(a).prependTo(i),n.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,i=g.getPortOptionItems(a);e.each(i,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=g.getPortIndexValue(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#selectPortIconsId").porticonmenu().porticonmenu("menuWidget").addClass("ui-menu-icons porticons"),e.widget("settings.schemenames",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.value})},_renderItem:function(t,a){var n=e("<li>"),i=e("<div>",{text:a.value});return n.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,i=Q.manager.getSettingsManager().getOptionsPicker().getOptions();e.each(i,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=Q.manager.getSettingsManager().getOptionsPicker().getIndex(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#settingSchemesId").schemenames({width:240}).schemenames("menuWidget").addClass("ui-menu-icons schemenames"),e("#selectPartitionId").selectmenu({select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;console.log("$$$ disk select: "+a),Q.selectedPartition(a)}},change:function(e,t){e.currentTarget.textContent},create:function(e,t){setTimeout(function(){Q.manager.getDiskNames()},1e3)}}).addClass("settingsDiskMenu").css("fontSize","16px"),e("#selectFileTypeId").selectmenu({create:function(t,a){setTimeout(function(){Q.selectedFileType(d.fileTypes().ALL),e("#selectFileTypeId").selectmenu("refresh")},1e3)},select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;Q.selectedFileType(a),Q.manager.getDirContent()}}}).addClass("settingsDiskMenu"),e.widget("dbScripts.inOutmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var n=e("<li>"),i=e("<div>",{text:a.label});return n.append(i).appendTo(t)}}),e("#importExportId").inOutmenu({icons:{button:"ui-icon-blank"},width:160,background:"white",select:function(e,t){E.setDBSelected(document.getElementById("importExportId").value)}}).inOutmenu("menuWidget"),Q.refreshImportMenu=function(){e("#importExportId").inOutmenu("refresh")},e.widget("demomenu.demofilesmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},refreshButtonItem:function(e){this.refresh()}}),e("#selectFileId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#flowMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#dbMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#logMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#procMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#cnstrDBTypeId").selectmenu(),e("#dbCPKTypeId").selectmenu(),e("#dbCPKCol1").selectmenu(),e("#dbCPKCol2").selectmenu(),e("#dbCPKCol3").selectmenu(),e.widget("dbScripts.cstrtypes",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var n=e("<li>"),i=e("<div>",{text:a.label});return n.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this;e.each(a,function(e,a){n._renderItemData(t,a)})}}),e("#cnstrDBTypeId").cstrtypes({icons:{button:"ui-icon-blank"},width:18}).cstrtypes("menuWidget").addClass("ui-menu-icons cstrtypes")}),Q.startHereVisible=n.pureComputed(function(){return!Q.hasDiagram()&&!Q.isStartPage()&&!Q.hasDialogsOpen()}),Q.hasDialogsOpen=n.observable(!1),Q.setHasDialogsOpen=function(e){Q.hasDialogsOpen(e)},Q.disableInactiveTypeButtons=function(e){e?r.getDiagramType()===d.diagramType().ERD_DB?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=!e,document.getElementById("btnLOGId").disabled=e):r.getDiagramType()===d.diagramType().ERD_LOG?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=!e):(document.getElementById("btnFlowId").disabled=!e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e):(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e)},e("#btnFlowId").prop("checked",!0),e('input[id="btnFlowId"]').on("change",function(e){Q.enforceDiagramType(d.diagramTypeText().FLOWCHART)}),e('input[id="btnERDId"]').on("change",function(e){Q.enforceDiagramType(d.diagramTypeText().ERD_DB)}),e('input[id="btnLOGId"]').on("change",function(e){Q.enforceDiagramType(d.diagramTypeText().ERD_LOG)}),Q.diagramTypeFlow=n.observable(d.diagramTypeText().FLOWCHART),Q.diagramTypeERD=n.observable(d.diagramTypeText().ERD_DB),Q.diagramTypeLOG=n.observable(d.diagramTypeText().ERD_LOG),Q.diagramTypeProc=n.observable(d.diagramTypeText().PROCESS),Q.enforceDiagramType=function(t){t===d.diagramTypeText().ERD_DB?(e("#btnERDId").prop("checked",!0),r.setDiagramType(d.diagramType().ERD_DB),r.setFlowDirection(d.flow().VERTICAL),Q.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",2),r.setShowNodeTasks(!1),r.setShowDBRecords(!0),r.setShowCardinality(!0),r.setShowRefHandles(!1),r.setShowNodeIcons(!1),r.setHideNodeNames(!1),r.setLinkStyle(d.linkStyle().STRAIGHT_LINE),r.setSegmentsGap(d.segmentsGap().MAX),r.setGridSpace(d.gridSpace().MAX),Q.isFirstCall(!1),Q.setERDTabVisible(),Q.selectedDBName().length):t===d.diagramTypeText().ERD_LOG?(e("#btnLOGId").prop("checked",!0),r.setDiagramType(d.diagramType().ERD_LOG),r.setFlowDirection(d.flow().VERTICAL),Q.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",3),r.setShowNodeTasks(!1),r.setShowDBRecords(!0),r.setShowCardinality(!0),r.setShowRefHandles(!1),r.setShowNodeIcons(!1),r.setHideNodeNames(!1),r.setLinkStyle(d.linkStyle().STRAIGHT_LINE),r.setSegmentsGap(d.segmentsGap().MIN),r.setGridSpace(d.gridSpace().MIN),Q.isFirstCall(!1),Q.showDBName(!1),Q.selectedDBName(""),Q.setLOGTabVisible()):(e("#btnFlowId").prop("checked",!0),r.setDiagramType(d.diagramType().FLOWCHART),e("#btnHorizontal").prop("disabled",!1),document.getElementById("btnFlowVId").disabled=!1,e("#paletteAccordionId").accordion("option","active",0),r.setSegmentsGap(d.segmentsGap().MIN),r.setGridSpace(d.gridSpace().MIN),r.setShowDBRecords(!1),r.setShowCardinality(!1),r.setShowNodeTasks(!1),Q.isFirstCall(!1),Q.showDBName(!1),Q.selectedDBName(""),Q.setFlowTabVisible()),Q.updateWindow()},Q.showIconSelection=n.pureComputed(function(){return r.getDiagramType()===d.diagramType().FLOWCHART}),Q.dbsToImport=n.observableArray(E.currentDBTypes()),Q.dbsToExport=n.observableArray(E.currentDBTypes()),Q.showDBName=n.observable(!1),Q.selectedDBName=n.observable(""),Q.dbCallParams={},Q.isSelectedMySQL=n.computed(function(){return"MySQL"===Q.selectedDBName()}),Q.isExportMySQL=n.computed(function(){return"MySQL"===Q.selectedDBName()&&Q.fsDialogMode()===d.fsDialogMode().EXPORT_DB}),Q.callInOutDialog=function(){e("#importExportDialogId").dialog("open")},Q.isAutoLayoutAllowed=n.observable(r.isAllowAuto()),Q.forceTestAutoMode=function(e){r.setLayoutMode(d.layoutMode().AUTO),Q.manager.getSelectionManager().clearSelections(),Q.manager.resetScale(),Q.runTestAutoMode()},Q.resetTestAutoMode=function(){Q.manager.clearDiagram(),r.setLayoutMode(d.layoutMode().MANUAL)},Q.runTestAutoMode=function(){},Q.dbNodeRecords=n.observableArray(),Q.showDBTableEditorOnLeft=n.observable(!1),Q.showDBCardinalityOnLeft=n.observable(!1),Q.showDBTable=n.observable(!0),Q.dbTableErrorMsg=n.observable(!1),Q.dbColumnKeys=n.observableArray(Q.manager.getDBTableEditor().dbColumnKeys()),Q.keyId=n.observable(""),Q.dbDataColumnTypes=n.observableArray(Q.manager.getDBTableEditor().dbColumnTypes()),Q.typeId=n.observable(""),Q.dbTableLength=n.observable(""),Q.showDBConstraints=n.observable(!1),Q.dbTableConstraints=n.observableArray(Q.manager.getDBTableEditor().dbTypeConstraints()),Q.showDBKeys=n.observable(!0),Q.showDBIndexes=n.observable(!1),Q.dbTableIndexes=n.observableArray(),Q.dbCompositePKs=n.observableArray(),Q.dbCompositePKTypes=n.observableArray(),Q.showDBCompositePK=n.observable(!0),Q.compositePKColumns=n.observableArray(),Q.isDefault=function(e){return console.log(e),"DEFAULT"!==e},Q.showDecisionEditorOnLeft=n.observable(!1),Q.nodeEmojiItems=n.pureComputed(function(){return u.getNodeIconOptions()}),Q.portIcons=n.pureComputed(function(){return g.getPortIconOptions()}),Q.cardinalityItems=n.pureComputed(function(){return b.getCardinalityList()}),Q.enableShowCardinality=n.observable(!1),Q.setEnableShowCardinality=function(e){Q.enableShowCardinality(e)},Q.enableShowDB=n.observable(!1),Q.setEnableShowDB=function(e){Q.enableShowDB(e)},Q.onOpsActionChange=function(e){},Q.isProgressBarVisible=n.observable(!1),Q.isProgressBarVisible.extend({notify:"always"}),Q.setProgressBarVisible=function(e){Q.isProgressBarVisible(e)},Q.showPageMode=n.observable(r.hasPageMode()),Q.isCanvasVisible=n.observable(!1),Q.setCanvasVisible=function(e){Q.isCanvasVisible(e)},Q.scaleValue=n.observable(r.getScale()),e("#scaleId").slider(),re.oninput=function(){r.setScale(this.value/d.scale().FACTOR),Q.scaleValue(r.getScale()),Q.manager.clearClipboard(),Q.manager.getFlowDiagram().clearCanvas(),Q.manager.rebuildFlowData()},Q.editModeText=n.observable(r.isEditMode()?d.editModeText().EDIT:d.editModeText().VIEW),Q.setEditModeText=function(e){e===d.editMode().EDIT_ALL?Q.editModeText(d.editModeText().EDIT):Q.editModeText(d.editModeText().VIEW)},Q.setTooltipBox=function(e,t){e.length>0&&r.isEditMode()&&1===r.getScale()&&V.drawTooltip(ee,$.getBoundingClientRect(),t,e)},Q.showTooltipBox=function(e){},Q.getCurrentShortFileName=function(){var e=Q.manager.getFileName(),t=e.indexOf(".json"),a=e.substring(0,t),n=a.lastIndexOf("/");return a.substring(n+1)};var ve,Te=document.getElementById("blockResizeId"),fe=e("#extendBlockAcrossId"),Ie=e("#extendBlockAlongId"),he=e("#shrinkBlockAcrossId"),ye=e("#shrinkBlockAlongId");Q.showBlockResizeBar=function(e){var t=e.getExpandedShape(),a=r.getScale();Te.style.left=$.getBoundingClientRect().left+t.x*a+"px",Te.style.top=$.getBoundingClientRect().top+t.y*a-24+"px",fe.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Ie.attr("disabled",!r.isEditMode()||!e.canExtendAlong()),he.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),ye.attr("disabled",!r.isEditMode()||!e.canShrinkAlong()),Te.style.visibility="visible"},Q.doResizeContainer=function(e){var t=Q.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().CONTAINER&&t[0].resizeOutline(e),Te.style.visibility="hidden",ve=!1},Q.isBlockResizeBarVisible=function(){return ve},Q.hideContainerBar=function(){Te.style.visibility="hidden"};var De,we=document.getElementById("switchResizeId"),Ee=e("#extendSwitchAcrossId"),Ce=e("#shrinkSwitchAcrossId");Q.showSwitchResizeBar=function(e){var t=e.getMenuBarPosition(),a=r.getScale();we.style.left=$.getBoundingClientRect().left+t.x*a+"px",we.style.top=$.getBoundingClientRect().top+t.y*a-24+"px",Ee.attr("disabled",!r.isEditMode()||!e.canExtendAcross()),Ce.attr("disabled",!r.isEditMode()||!e.canShrinkAcross()),we.style.visibility="visible"},Q.doResizeSwitch=function(e){var t=Q.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===d.flowType().SWITCH&&t[0].resizeOutline(e),we.style.visibility="hidden",De=!1},Q.isSwitchResizeBarVisible=function(){return De},Q.hideSwitchBar=function(){we.style.visibility="hidden"},Q.showSearchList=n.observable(!1),Q.showFindOptions=n.observable(!0),Q.searchContentList=n.observableArray(),Q.foundMatches=n.observable(),Q.onFindTableClick=function(e){var t=e.target.innerText;C.selectedNewDisk(t)},Q.onFindTableDblClick=function(e){Q.onFindTableClick(e)},Q.onPasteSearchText=function(e){C.selectedNewDisk(label)},Q.currentPath=n.observable(),Q.fsContentList=n.observableArray(),Q.selectedPath=n.observable(),Q.isOpenMode=n.observable(),Q.isSaveMode=n.observable(),Q.isImportDBMode=n.observable(),Q.isExportDBMode=n.observable(),Q.showPartitions=n.observable(!1),Q.partitionsList=n.observableArray([""]),Q.selectedPartition=n.observable(),Q.filesTypes=n.observableArray([d.fileTypes().JSON,d.fileTypes().ALL]),Q.selectedFileType=n.observable(d.fileTypes().JSON);Q.showTemplatesOnly=n.observable(!1),Q.setShowTemplatesOnly=function(e){Q.showTemplatesOnly(e)},Q.callOpenFlowDialog=function(t,a){t?(Q.setFSDialogMode(d.fsDialogMode().OPEN),Q.setShowTemplatesOnly(!0),r.getDiagramType()===d.diagramType().FLOWCHART?(Q.flowTemplates(Q.manager.getTemplates().getFlowTemplatesList()),e("#flowMenuId").demofilesmenu("refresh")):r.getDiagramType()===d.diagramType().ERD_DB?(Q.dbTemplates(Q.manager.getTemplates().getDBTemplatesList(Q.selectedDBName())),e("#dbMenuId").demofilesmenu("refresh")):r.getDiagramType()===d.diagramType().ERD_LOG&&(Q.logTemplates(Q.manager.getTemplates().getLOGTemplatesList()),e("#logMenuId").demofilesmenu("refresh")),ne.dialog("open"),ne.dialog({height:180})):a===d.importExportMode().IMPORT?(Q.setShowTemplatesOnly(!1),setTimeout(function(){Q.isConnectionOK()&&(ne.dialog({height:440}),Q.manager.getRootDir(),ne.dialog("open"))},20)):(Q.setShowTemplatesOnly(!1),setTimeout(function(){Q.isConnectionOK()?ne.dialog({height:440}):ne.dialog({height:180}),Q.manager.getRootDir(),ne.dialog("open")},20))},Q.onDiskTableClick=function(e){var t=e.target.innerText;D.selectedNewDisk(t)},Q.setFSDialogMode=function(e){me.setFSDialogMode(e),Q.fsDialogMode(e)},Q.getFSDialogMode=function(){return me.getFSDialogMode()},Q.fsDialogMode=n.observable(),Q.restoreWorkDir=function(){me.restoreWorkDir()},Q.setWorkDir=function(e){me.setWorkDir(e)},Q.getWorkDir=function(){return me.getWorkDir()},Q.getSelectedFSDir=function(){return me.getSelectedFSDir()},Q.getSelectedFSFile=function(){return me.getSelectedFSFile()},Q.onDirTableClick=function(e){me.onDirTableClick(e)},Q.deleteFSItem=function(){me.deleteFSItem()},Q.onDirTableDblClick=function(e){me.onDirTableDblClick(e)},Q.updateMainFSLocation=function(){me.updateMainFSLocation()},Q.goOneDirBack=function(){me.goOneDirBack()},Q.setDirsList=function(e,t){me.setDirsList(e,t)},Q.setFolderContent=function(e,t){me.setFolderContent(e,t)},Q.onFileTypeChange=function(e){me.onFileTypeChange(e)},Q.showForegroundSelection=n.observable(!0),Q.showBackgroundSelection=n.observable(!0),Q.settingsSchemes=n.observableArray([]),Q.removeFromSettingsSchemes=function(e){for(var t=-1,a=0;a<Q.settingsSchemes().length;a++)if(Q.settingsSchemes()[a]===e){t=a;break}a>-1?Q.settingsSchemes.splice(t,1):alert("bad index for settingsSchemes: "+t)};var Ne;Q.setNewAction=function(e){Ne=e},Q.isNewAction=function(){return Ne},Q.filesList=n.observableArray();var Se=[];Q.setFilesList=function(t){if(Se=t,Q.filesList(t),Q.filesList(z(t)),Ne)e("#newFlowDialogId").dialog("open");else;},Q.selectedFile=n.observable(),Q.getSelectedFile=function(){return Q.isConnectionOK()?_selectedFile:Q.selectedFile()},Q.isInputInvalid=n.observable(!1),Q.validateMessage=n.observable(""),Q.newFSNameValue=n.observable(""),Q.nameValueEmpty=n.observable(""),Q.validateFSName=function(t,a){var n=A.trimMultipleSpaces(Q.newFSNameValue()),i=a?o.getDirectoriesLabels():Q.filesList();Q.nameValueEmpty(0===n.length);var s=(Q.isInputInvalid(),A.containsFSName(i,n)),r=A.isFSNameValid(Q.newFSNameValue()),l=n.length>0&&(!r||s);Q.isInputInvalid(l),e("#newFlowButtonOK").button("option","disabled",Q.isInputInvalid()||Q.nameValueEmpty()),e("#newFolderButtonOK").button("option","disabled",Q.isInputInvalid()||Q.nameValueEmpty()),r?s?Q.validateMessage("Duplicate name"):Q.validateMessage(""):Q.validateMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces"),t&&n.length>0&&r&&"Enter"===t.code&&(Ne?(h.createNewDiagram(Q.manager),e("#newFlowDialogId").dialog("close")):(y.createNewFolder(Q.manager),e("#newFolderDialogId").dialog("close")))},Q.saveAsInputInvalid=n.observable(!1),Q.saveAsMessage=n.observable(""),Q.saveAsFileNameValue=n.observable(""),Q.saveAsNameEmpty=n.observable(""),Q.validateSaveAsFileName=function(e){var t=A.trimMultipleSpaces(Q.editNameValue());if(t.length>0){var a=A.containsFSName(Q.filesList(),t),n=A.isFSNameValid(t),i=!a&&n;Q.isEditNameInvalid(!i)}a?Q.validateNameMessage("Duplicate name"):n?Q.validateNameMessage(""):Q.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},Q.saveAsNewVersion=n.observable(1),Q.versionInputInvalid=n.observable(!1),Q.validateAsVersion=function(e){var t=(Q.saveAsNewVersion(),A.isVersionNumber(Q.saveAsNewVersion()));Q.versionInputInvalid(!t),U()},Q.isFlowSaveBlocked=function(){return Q.saveAsInputInvalid()||Q.saveAsNameEmpty()||Q.saveAsNewVersion()&&Q.versionInputInvalid()};var Le=n.observable();Q.propsLinkSourceName=n.observable(),Q.propsLinkSourceLabel=n.observable(),Q.propsLinkTargetName=n.observable(),Q.propsLinkTargetLabel=n.observable(),Q.propsLinkLabel=n.observable(),Q.getPropsLink=function(){return Le()},Q.getPropsLinkLabelValue=function(){return Q.propsLinkLabel()},Q.showLinkProps=function(t){Le(t),Q.propsLinkSourceName(Le().getLinkSourcePortName()),Q.propsLinkSourceLabel(Le().getLinkSourcePortLabel()),Q.propsLinkTargetName(Le().getLinkTargetPortName()),Q.propsLinkTargetLabel(Le().getLinkTargetPortLabel()),Q.propsLinkLabel(Le().getLinkLabel()),e("#linkPropsDialogId").dialog("open")},Q.propsFgndVisible=n.observable(!0),Q.setPropsFgndVisible=function(e){Q.propsFgndVisible(e)},Q.propsNodeInputs=n.observableArray();var Be,Me;Q.getPropsNodeInputsIdx=function(){return Be},Q.getPropsNodeInputsValue=function(){return Me},Q.propsNodeOutputs=n.observableArray();var Oe,Fe;Q.getPropsNodeOutputsIdx=function(){return Oe},Q.getPropsNodeOutputsValue=function(){return Fe},Q.propsNodeRefInputs=n.observableArray();var ke,xe;Q.getPropsNodeRefInputsIdx=function(){return ke},Q.getPropsNodeRefInputsValue=function(){return xe},Q.propsNodeRefOutputs=n.observableArray();var Pe,Re;Q.getPropsNodeRefOutputsIdx=function(){return Pe},Q.getPropsNodeRefOutputsValue=function(){return Re};var Ae=n.observable();Q.setPropsNode=function(e){Ae(e)},Q.getPropsNode=function(){return Ae()},Q.propsNodeName=n.computed(function(){return Ae()?Ae().getName():"?"},this),Q.showNodeProps=function(t){Ae(t),t.getFlowType()===d.flowType().DB_TABLE&&t.closeDBEditors(),u.setNodeCategory(t.getNodeCategory()),Q.propsNodeInputs(Ae().getInputPortsProperties()),Q.propsNodeOutputs(Ae().getOutputPortsProperties()),Q.propsNodeRefInputs(Ae().getRefInPortsProperties()),Q.propsNodeRefOutputs(Ae().getRefOutPortsProperties()),Q.dbNodeRecords(Ae().getDBRecords()),e("#nodePropsDialogId").dialog("open")},Q.dbEditorPath=n.observable("?"),Q.setDBEditorPath=function(e){dbEditorPath(e)};var Ve=n.observable();Q.setPropsPort=function(e){Ve(e)},Q.getPropsPort=function(){return Ve()},Q.propsPortName=n.observable(""),Q.editPropsNodeInputLabel=function(e){Be=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeInputsTableId"),a=t.getElementsByTagName("tr");Me=a[Be].cells[2].getElementsByTagName("input")[0].value},Q.checkPortInputCardinality=function(e){w.editPortInputCardinality(e)},Q.editPropsNodeOutputLabel=function(e){Oe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeOutputsTableId"),a=t.getElementsByTagName("tr");Fe=a[Oe].cells[2].getElementsByTagName("input")[0].value},Q.checkPortOutputCardinality=function(e){w.editPortOutputCardinality(e)},Q.editPropsNodeRefInputLabel=function(e){ke=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefInputsTableId"),a=t.getElementsByTagName("tr");xe=a[ke].cells[2].getElementsByTagName("input")[0].value},Q.checkPortRefInputCardinality=function(e){w.editPortRefInputCardinality(e)},Q.editPropsNodeRefOutputLabel=function(e){Pe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefOutputsTableId"),a=t.getElementsByTagName("tr");Re=a[Pe].cells[2].getElementsByTagName("input")[0].value},Q.checkPortRefOutputCardinality=function(e){w.editPortRefOutputCardinality(e)},Q.isEditNameInvalid=n.observable(!1),Q.editNameValue=n.observable(""),Q.newFlowNameValue=n.observable(""),Q.validateNameMessage=n.observable("");var He;Q.setOldName=function(e){He=e},Q.validateInlineNodeName=function(){var e=Q.manager.getInlineInputEditor().getCurrentValue(),t=A.trimMultipleSpaces(e);Q.validateEditName(t)},Q.validateDialogNodeName=function(){var e=A.trimMultipleSpaces(Q.editNameValue());Q.validateEditName(e)},Q.validateNewFlowName=function(){var e=A.trimMultipleSpaces(Q.editNameValue());Q.validateEditName(e)},Q.validateNewFolderName=function(){var e=A.trimMultipleSpaces(Q.editNameValue());Q.validateEditName(e)},Q.validateEditName=function(e){if(e.length>0){var t=A.getAllNames(Q.manager.getNodeNamesMap()),a=A.isDuplicateName(He,e,t),n=A.isNewNodeNameValid(e),i=!a&&n;Q.isEditNameInvalid(!i)}a?Q.validateNameMessage("Duplicate name"):n?Q.validateNameMessage(""):Q.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},Q.isSchemeNameInvalid=n.observable(!1),Q.schemeNameValue=n.observable(""),Q.validateSchemeMessage=n.observable(""),Q.validateSchemeName=function(){var e=document.getElementById("newSchemeId").value;if(e.length>0){var t=Q.manager.getSettingsManager().getSchemeNames(),a=t.includes(e),n=A.isSchemeNameValid(e),i=!a&&n;Q.isSchemeNameInvalid(!i)}else Q.isSchemeNameInvalid(!1);a?Q.validateSchemeMessage("Duplicate name"):n?Q.validateSchemeMessage(""):Q.validateSchemeMessage("Only alphanumericals, dots, dashes and underscores")},Q.isLinkLabelInvalid=n.observable(!1),Q.linkLabelValue=n.observable(""),Q.validateLinkMessage=n.observable("");var _e;Q.setOldLinkLabel=function(e){_e=e},Q.validateLinkLabelName=function(e){var t=A.trimMultipleSpaces(Q.linkLabelValue());if(t.length>0){var a=t===_e||A.isNewLinkLabelValid(t);Q.isLinkLabelInvalid(!a)}else Q.isLinkLabelInvalid(!1);a?Q.validateLinkMessage(""):Q.validateLinkMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},Q.isFieldInvalid=n.observable(!1),Q.fieldValue=n.observable(""),Q.validateFieldMessage=n.observable(""),
Q.validateFieldName=function(){var e=document.getElementById("inputFieldId").value;if(e.length>0){var t=Q.manager.getDBTableEditor().getDBRecordsFields(),a=Q.manager.getDBTableEditor().getOldFieldValue(),n=t.includes(e),i=A.isDBFieldValid(e),o=e===a||!n&&i;Q.isFieldInvalid(!o)}else Q.isFieldInvalid(!1);n?Q.validateFieldMessage("Duplicate field"):i?Q.validateFieldMessage(""):Q.validateFieldMessage("Only alphanumericals, dots, dashes and underscores")},Q.isKeyInvalid=n.observable(!1),Q.validateKeyMessage=n.observable(""),Q.validateKeyValue=function(){var e=document.getElementById("inputKeyId").value,t=Q.manager.getDBTableEditor().getLabelById(Q.manager.getDBTableEditor().dbColumnKeys(),e);if(Q.isKeyInvalid(!1),t.length>0){var a=Q.manager.getDBTableEditor().getDBRecordsKeys(),n="PK"===t&&a.includes(t);Q.isKeyInvalid(n)}return n?Q.validateKeyMessage("Only composite primary key is allowed"):Q.validateKeyMessage(""),!n},Q.isCPKNameInvalid=n.observable(!1),Q.fieldCPKValue=n.observable(""),Q.validateCPKMessage=n.observable(""),Q.validateCPKName=function(){var e=Q.manager.getDBTableEditor().getNewCPKName();if(e.length>0){var t=Q.manager.getDBTableEditor().getOldCPKName(),a=A.isDBFieldValid(e),n=e===t||a;Q.isCPKNameInvalid(!n)}else Q.isCPKNameInvalid(!1);a?Q.validateCPKMessage(""):Q.validateCPKMessage("Only alphanumericals, dots, dashes and underscores")},Q.isDuplicateType=n.observable(!1),Q.duplicateConstraintMessage=n.observable("Duplicate constraint"),Q.pictureURLValue=n.observable(""),Q.isPictureURLInvalid=n.observable(!1),Q.validatePictureURL=function(e){Q.isPictureURLInvalid(!1)},Q.showNewFileName=n.observable(),Q.showEditedInfo=n.observable(),Q.showDecisionInfo=n.observable(),Q.decisionInputPicture=n.observable(),Q.decisionEndsPicture=n.observable(),Q.isNodeNameInvalid=n.observable(!1),Q.newNodeNameValue=n.observable(""),Q.invalidNameMessage=n.observable(""),Q.resetDecisionIndices=function(){Q.updateTrigger(!Q.updateTrigger()),m.resetCurrentIndices(),Q.decisionInputPicture(m.getCurrentInputPicture()),Q.decisionEndsPicture(m.getCurrentEndsPicture())},Q.btnFlowH2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&Q.changeFlowDirection(d.flow().VERTICAL)},Q.btnFlowV2click=function(){r.getDiagramType()!=d.diagramType().ERD_DB&&r.getDiagramType()!=d.diagramType().ERD_LOG&&Q.changeFlowDirection(d.flow().HORIZONTAL)},Q.changeFlowDirection=function(e){Z(e)};var Ke=!1;Q.hasFlowDirectionChange=function(){return Ke},Q.setFlowDirectionChange=function(){Ke=!0},Q.resetFlowDirectionChange=function(){Ke=!1},Q.isHorizontal=n.observable(!1),Q.layoutModeText=n.observable(r.getLayoutModeText()),Q.diagramModeText=n.observable(r.getDiagramModeText());var Ge=(e("#newId"),e("#openId")),We=(e("#templatetId"),e("#inOutId")),ze=e("#undoId"),Ue=e("#redoId"),Ze=e("#findId"),Xe=e("#refreshId"),Ye=e("#clearId"),je=e("#leftId"),qe=e("#rightId"),Qe=e("#deleteId"),$e=e("#copyId"),Je=e("#pasteId"),et=e("#saveId"),tt=e("#saveAsId"),at=e("#btnFlowVId");e("#btnThumbnailId");Q.updateWindow=function(t){Q.updateTrigger(!Q.updateTrigger()),Q.isHorizontal(r.getFlowDirection()===d.flow().HORIZONTAL),Q.layoutModeText(r.getLayoutModeText()),Q.diagramModeText(r.getDiagramModeText());var a=!r.isEditMode();s.updateMenus(Q),Ge.attr("disabled",!Q.isConnectionOK()),We.attr("disabled",r.getDiagramType()!==d.diagramType().ERD_DB||Q.startHereVisible()||Q.isStartPage()||Q.manager.isTemplate()||Q.manager.isDirty()),ze.attr("disabled",a||!Q.manager.canUndo()).attr("title",Q.manager.getUndoName()),Ue.attr("disabled",a||!Q.manager.canRedo()).attr("title",Q.manager.getRedoName()),Qe.attr("disabled",a||!Q.manager.getSelectionManager().hasSelections()),$e.attr("disabled",a||!Q.manager.canCopy()),Je.attr("disabled",a||!Q.manager.readyToPaste()),et.attr("disabled",a||!Q.isConnectionOK()||!Q.manager.isDirty()||Q.manager.isTemplate()),tt.attr("disabled",a||!Q.isConnectionOK()||Q.manager.getModelHandler().isDiagramEmpty()),Xe.attr("disabled",!Q.isCanvasVisible()),Ze.attr("disabled",!Q.isCanvasVisible()),Ye.attr("disabled",a||!Q.isCanvasVisible()),je.attr("disabled",!Q.manager.hasPreviousDiagram()),qe.attr("disabled",!Q.manager.hasNextDiagram()),at.attr("disabled",r.getAppMode()!==d.appMode().FLOW_MODE),e("#btnFlowHId").attr("disabled",a),e("#btnFlowVId").attr("disabled",a),"visible"!==document.getElementById("blockResizeId").style.visibility||ve?ve&&(document.getElementById("blockResizeId").style.visibility="hidden",ve=!1):ve=!0,"visible"!==document.getElementById("switchResizeId").style.visibility||De?De&&(document.getElementById("switchResizeId").style.visibility="hidden",De=!1):De=!0,Q.manager.isInitialResizeMode()&&Q.manager.getModelHandler().isDiagramEmpty()?(ie.spinner("enable"),oe.spinner("enable")):(ie.spinner("disable"),oe.spinner("disable")),Q.disableInactiveTypeButtons(!Q.manager.getModelHandler().isDiagramEmpty())},Q.initData=function(){Q.updateWindow()},Q.galleryFlowNodes=n.pureComputed(function(){return Q.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getFlowNodesH():c.getFlowNodesV()}),Q.galleryMiscNodes=n.pureComputed(function(){return Q.updateTrigger(),r.getFlowDirection()===d.flow().HORIZONTAL?c.getMiscNodesH():c.getMiscNodesV()}),Q.galleryERDNodes=n.pureComputed(function(){return Q.updateTrigger(),c.getERDNodes()}),Q.galleryLOGNodes=n.pureComputed(function(){return Q.updateTrigger(),c.getLOGNodes()}),Q.galleryProcNodes=n.pureComputed(function(){return Q.updateTrigger(),c.getProcNodes()}),Q.pageNodes=n.pureComputed(function(){Q.updateTrigger();for(var e=[],t=r.getFlowDirection()===d.flow().HORIZONTAL?c.getHPageItems():c.getVPageItems(),a=0;a<t.length;a++)e.push(t[a]);return e}),Q.diagramDisplayName=n.observable(ce),Q.setDiagramDisplayName=function(e){e&&e.length>0?(Q.showTemplatesOnly()&&(e=d.templateToken()+": "+e),Q.diagramDisplayName(e)):Q.diagramDisplayName(ce)},Q.cnxInfo=n.observable(!1),Q.taskActionInputValue=n.observable(""),Q.taskServiceInputValue=n.observable(""),Q.taskSubscribeInputValue=n.observable(""),Q.taskPublishInputValue=n.observable(""),Q.taskOperationInputValue=n.observable(""),Q.taskExpressionInputValue=n.observable(""),Q.showTaskAction=n.observable(!0),Q.showTaskService=n.observable(!0),Q.showTaskSubscribe=n.observable(!0),Q.showTaskPublish=n.observable(!0),Q.showTaskOperation=n.observable(!0),Q.showTaskExpression=n.observable(!0),Q.taskActionSelected=n.observable(!0),Q.taskServiceSelected=n.observable(!1),Q.taskSubscribeSelected=n.observable(!1),Q.taskPublishSelected=n.observable(!1),Q.taskOperationSelected=n.observable(!1),Q.taskExpressionSelected=n.observable(!1),Q.nodeActionList=n.observableArray(),Q.nodeOperationList=n.observableArray(),Q.nodeServiceList=n.observableArray(),Q.nodePublishList=n.observableArray(),Q.nodeSubscribeList=n.observableArray(),Q.showTaskEditorOnLeft=n.observable(!1),Q.aboutTitle=n.observable(""),Q.aboutVersion=n.observable(""),Q.aboutText=n.observable(""),Q.aboutSources=n.observable(""),Q.aboutCopyright=n.observable(""),Q.showAboutBox=function(t,a,n,i,o){Q.aboutTitle(t),Q.aboutVersion(a),Q.aboutText(n),Q.aboutSources(i),e("#aboutDialogId").dialog("open")},Q.welcomeTitle=n.observable(""),Q.welcomeGreeting=n.observable(""),Q.welcomeTo=n.observable(""),Q.welcomeTip=n.observable(""),Q.showWelcomeBox=function(t,a,n,i){Q.welcomeTitle(t),Q.welcomeGreeting(a),Q.welcomeTo(n),Q.welcomeTip(i),e("#welcomeDialogId").dialog("open")},Q.isStartPage=n.observable(!1);document.getElementById("startToTopBtn");Q.setStartPageOpen=function(e){Q.isStartPage(e)},Q.onStartToTopClick=function(t){e("#navbarId").show(),setTimeout(function(){e("#topContainerId").show(),Q.manager.refreshDiagramOnEdit(!0)},20)},Q.startTitle=n.observable(""),Q.startTopText1=n.observable(""),Q.startTopText2=n.observable(""),Q.startFlowTitle=n.observable(""),Q.startERDTitle=n.observable(""),Q.startLOGTitle=n.observable(""),Q.startProcessTitle=n.observable(""),Q.showStartPage=function(e,t,a,n,i,o,s){Q.startTitle(e),Q.startTopText1(t),Q.startTopText2(a),Q.startFlowTitle(n),Q.startERDTitle(i),Q.startLOGTitle(o),Q.startProcessTitle(s),Q.manager.getStartPageEditor().showStartPageEditor(Q.manager)},Q.callStartPage=function(e){var t=M.getTitle(),a=M.getTopText1(),n=M.getTopText2(),i=M.getFlowTitle(),o=M.getERDTitle(),s=M.getLOGTitle();procTitle=M.getProcessTitle(),Q.showDBName(!1),Q.getFlowManager().clearDiagram(),Q.getFlowManager().refreshDiagram(),Q.showStartPage(t,a,n,i,o,s,procTitle)},Q.templatesList=n.observableArray([""]),Q.flowTemplates=n.observableArray(Q.manager.getTemplates().getFlowTemplatesList()),Q.dbTemplates=n.observableArray(),Q.logTemplates=n.observableArray(Q.manager.getTemplates().getLOGTemplatesList()),Q.procTemplates=n.observableArray(Q.manager.getTemplates().getPROCTemplatesList()),Q.showFlowTemplates=n.observable(r.getDiagramType()===d.diagramType().FLOWCHART),Q.showDBTemplates=n.observable(r.getDiagramType()===d.diagramType().ERD_DB),Q.showLOGTemplates=n.observable(r.getDiagramType()===d.diagramType().ERD_LOG),Q.showPROCTemplates=n.observable(r.getDiagramType()===d.diagramType().PROCESS),Q.flowTabVisible=n.observable(),Q.erdTabVisible=n.observable(),Q.logTabVisible=n.observable(),Q.procTabVisible=n.observable(),Q.setFlowTabVisible=function(){Y(),Q.flowTabVisible(!0)},Q.setERDTabVisible=function(){Y(),Q.erdTabVisible(!0)},Q.setLOGTabVisible=function(){Y(),Q.logTabVisible(!0)},Q.setPROCTabVisible=function(){Y(),Q.procTabVisible(!0)},Q.infoMessage=n.observable(""),Q.infoMessageVisible=n.observable(),Q.showInfoMessage=function(t,a){Q.infoMessage(t),Q.infoMessageVisible(!1),e("#infoDialogId").dialog("open"),a&&e("#infoDialogId").dialog("option","title",a)},e("#infoDialogId").on("dialogopen",function(t,a){setTimeout(function(){Q.infoMessageVisible(!0),e("#infoTextId").scrollTop(0)},200)});var nt;Q.getConfirmFlag=function(){return nt},Q.setConfirmFlag=function(e){nt=e},Q.confirmMessage=n.observable(""),Q.showConfirmMessage=function(t,a,n){k.initDialog(Q.manager),Q.confirmMessage(t),a&&se.dialog("option","title",a),n&&(e(e("button",se.parent())[1]).text(n.first),e(e("button",se.parent())[2]).text(n.second)),se.dialog("open")},Q.isShowThumbnail=n.observable(),Q.btnThumbnailShow=function(){Q.isShowThumbnail(!0),e("#thumbnailDialogId").dialog("open"),Q.repaintDiagram()},Q.btnThumbnailHide=function(){Q.isShowThumbnail(!1),Q.repaintDiagram()},Q.overlayText=n.observable("");var it=e("#saveOverlayId");Q.showOverlayMessage=function(e,t){var a=t||800;Q.overlayText(e),it.show(),setTimeout(function(){it.fadeOut(a)},a+200)},Q.bottomMessageText=n.observable("");var ot=e("#bottomOverlayId");Q.showBottomMessage=function(e,t){var a=t||1e3;Q.bottomMessageText(e),ot.show(),setTimeout(function(){ot.fadeOut(a)},a+200)},re.addEventListener("mousemove",function(e){j()},!1),re.onchange=function(){j()};var st;Q.getDraggedPaletteId=function(){return st},Q.setDraggedPaletteId=function(e){st=e},Q.onPaletteDragStart=function(e){parseInt(e.target.id)===d.flowType().DB_TABLE_2||parseInt(e.target.id)===d.flowType().DB_TABLE_3||parseInt(e.target.id)===d.flowType().DB_TABLE_4?(st=d.flowType().DB_TABLE,e.dataTransfer.setData("text",d.flowType().DB_TABLE),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ENTITY_W?(st=d.flowType().ENTITY,e.dataTransfer.setData("text",d.flowType().ENTITY),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().RELATION_W?(st=d.flowType().RELATION,e.dataTransfer.setData("text",d.flowType().RELATION),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===d.flowType().ATTR_MULTI||parseInt(e.target.id)===d.flowType().ATTR_DRV?(st=d.flowType().ATTRIBUTE,e.dataTransfer.setData("text",d.flowType().ATTRIBUTE),e.dataTransfer.setData("altType",e.target.id)):(st=e.target.id,e.dataTransfer.setData("text",e.target.id))},Q.onPaletteDragEnd=function(e){var t=$.getBoundingClientRect();e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom||Q.manager.getDnDHandler().resetDrag()},Q.requestFocus=function(){},Q.isControlPressed=function(){return ue},Q.setControlPressed=function(e){ue=e},Q.isEditControlPressed=function(){return be},Q.setEditControlPressed=function(e){be=e},Q.isShiftPressed=function(){return ge},Q.setShiftPressed=function(e){ge=e},window.onresize=function(){de.style.height=window.innerHeight+"px",e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),q(),Q.manager.getInlineInputEditor().relocateInlineFieldEditor(),Q.manager.getInlineAreaEditor().relocateInlineAreaEditor(),Q.manager.getDBTableEditor().relocateDBTableEditor(),Q.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),Q.manager.getDecisionLayoutEditor().relocateDecisionLayoutEditor(),Q.manager.getFlowTasksEditor().relocateFlowTasksEditor(),w.relocateDialog(),j(),Q.repaintDiagram()},window.onscroll=function(){Q.manager.getInlineInputEditor().relocateInlineFieldEditor(),Q.manager.getInlineAreaEditor().relocateInlineAreaEditor(),Q.manager.getDBTableEditor().relocateDBTableEditor(),Q.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),Q.repaintDiagram()};var rt=0,lt=e("#containerId");return Q.repaintDiagram=function(){Q.hideContainerBar(),Q.hideSwitchBar(),Q.manager.paintDiagram()},n.applyBindings(Q),Q.initData(),{initFlowDemo:function(){window.scrollTo(0,0),e(window).trigger("resize"),Q.setProgressBarVisible(!1),Q.showOverlayMessage("Connecting to server...",1e3),i.checkServerConnection(Q.manager)}}});