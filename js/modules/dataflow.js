//self.aboutCopyright(copy);

define(["jquery","jqueryui","jqueryuictxm","knockout","modules/server/ioHandler","modules/server/ioHelper","modules/fs/directories","modules/html/toolbar","modules/settings/config","modules/actions/frameActions","modules/graph/graphConstants","modules/gallery/components","modules/gallery/iconOptionsPicker","modules/gallery/portIconPicker","modules/gallery/cardinalityPicker","modules/gallery/decisionEnds","modules/erd/dbRecords","modules/flow/flowManager","modules/flow/flowUtils","modules/fs/fsBrowser","modules/diagram/mouseInteractor","modules/dialogs/newFlowDialog","modules/dialogs/newFolderDialog","modules/dialogs/openFlowDialog","modules/dialogs/nodePropsDialog","modules/dialogs/importExportDialog","modules/dialogs/findDialog","modules/dialogs/linkPropsDialog","modules/dialogs/dbTableEditor","modules/dialogs/aboutDialog","modules/util/welcomeText","modules/util/startText","modules/dialogs/welcomeDialog","modules/dialogs/infoDialog","modules/dialogs/confirmDialog","modules/dialogs/thumbnailDialog","modules/settings/settingsDialog","modules/geometry/point","modules/util/utils","modules/draw/draw","modules/controller/flowCache","modules/exportLayout/demoFlow","modules/util/integrationText"],function(e,t,a,n,o,i,s,r,l,d,c,u,g,b,m,p,v,T,f,I,h,y,w,D,E,C,N,S,L,B,M,k,O,F,x,P,R,A,V,H,_,K,G){function W(e){e===c.flow().VERTICAL?(he.removeClass("block-extendV"),he.addClass("block-extendH"),ye.removeClass("block-extendH"),ye.addClass("block-extendV"),we.removeClass("block-shrinkV"),we.addClass("block-shrinkH"),De.removeClass("block-shrinkH"),De.addClass("block-shrinkV")):e===c.flow().HORIZONTAL&&(he.removeClass("block-extendH"),he.addClass("block-extendV"),ye.removeClass("block-extendV"),ye.addClass("block-extendH"),we.removeClass("block-shrinkH"),we.addClass("block-shrinkV"),De.removeClass("block-shrinkV"),De.addClass("block-shrinkH"))}function z(e){e===c.flow().VERTICAL?(Ne.removeClass("block-extendV"),Ne.addClass("block-extendH"),Se.removeClass("block-shrinkV"),Se.addClass("block-shrinkH")):e===c.flow().HORIZONTAL&&(Ne.removeClass("block-extendH"),Ne.addClass("block-extendV"),Se.removeClass("block-shrinkH"),Se.addClass("block-shrinkV"))}function U(e){if(J.selectedFileType()===c.fileTypes().ALL)return e;var t=[],a=J.selectedFileType().split(".").pop();return e.forEach(function(e){e.split(".").pop()===a&&t.push(e)}),t}function Z(){e("#openSaveButtonOK").button("option","disabled",J.isFlowSaveBlocked())}function X(e){l.setFlowDirection(e),Y(e),J.setFlowDirectionChange(),W(e),z(e),J.getFlowManager().hasDiagramOpen()&&J.manager.setDirty(!0),J.setConfirmFlag(c.bValue().FALSE),J.getFlowManager().setSettingsChanged(!0),setTimeout(function(){J.getFlowManager().refreshDiagramOnEdit(!0),J.getFlowManager().refreshDiagramOnEdit(!0)},200)}function Y(e){e===c.flow().VERTICAL?f.updateDecisionInputs(J.manager.getModelHandler().getFlowNodes(),c.decisionInputs().NORTH):e===c.flow().HORIZONTAL&&f.updateDecisionInputs(J.manager.getModelHandler().getFlowNodes(),c.decisionInputs().WEST)}function j(){J.flowTabVisible(!1),J.erdTabVisible(!1),J.logTabVisible(!1),J.procTabVisible(!1)}function q(){var e=document.getElementById("containerId").clientWidth;$.width>e&&l.hasShowBottomMessages()&&J.showBottomMessage("Drag the mouse on canvas to scroll")}function Q(){var t=e(window).height();e(window).scrollTop();ct.height(t-dt)}var J=this,$=document.getElementById("canvasId"),ee=document.getElementById("canvasThId"),te=$.getContext("2d"),ae=document.getElementById("containerId"),ne=document.getElementById("topContainerId"),oe=e("#openFlowDialogId"),ie=e("#spinnerLevelsId"),se=e("#spinnerLanesId"),re=(e("#spinnerSpaceId"),e("#confirmDialogId")),le=(e("#thumbnailDialogId"),document.getElementById("scaleId")),de=e("#nodePropsTabId"),ce=document.getElementById("paletteCtrId"),ue="[Select Type, Start... / Open... / Template...]",ge=!1,be=!1,me=!1;J.accHdrFlowTitle=n.observable(c.appTitles().FLOW_TITLE),J.accHdrSideTitle=n.observable(c.appTitles().SIDE_TITLE),J.accHdrMiscTitle=n.observable(c.appTitles().MISC_TITLE),J.accHdrERDTitle=n.observable(c.appTitles().DB_ERD_TITLE),J.accHdrLOGTitle=n.observable(c.appTitles().DB_LOG_TITLE),J.accHdrPROCTitle=n.observable(c.appTitles().PROCESS_TITLE),J.accHdrPagesTitle=n.observable(c.appTitles().PAGES_TITLE),J.accHdrBpelTitle=n.observable(c.appTitles().BPEL_TITLE),J.accHdrK8sTitle=n.observable(c.appTitles().K8S_TITLE),J.getCanvas=function(){return $},J.setCanvas=function(e){$=e},J.getCanvasContext=function(){return te},J.getCanvasTh=function(){return ee},J.setCanvasTh=function(e){ee=e},J.getCanvasContext=function(){return te},J.getCanvasContainer=function(){return ae},J.getTopContainer=function(){return ne},J.manager=new T(J),J.interactor=J.manager.getMouseInteractor(),J.dndHandler=J.manager.getDnDHandler(),J.updateTrigger=n.observable(!1);var pe=new I(J);J.getFlowManager=function(){return J.manager};var ve=Date.now(),Te=!1;J.isConnectionOK=n.observable(Te),J.cnxResultOK=function(){Te=!0,J.showOverlayMessage("Connected",500),J.isConnectionOK(Te),setTimeout(function(){J.updateWindow()},200),J.isFirstCall(!0),J.manager.getInstallSettings(),J.callStartPage(!0),J.cnxInfo(!0)},J.cnxResultFAIL=function(e){Date.now()-ve<3e3?(Te=!1,console.log("*** connection FAIL: "+e.readyState),setTimeout(function(){J.showOverlayMessage("No server connection",500)},200)):(Te=!0,J.showOverlayMessage("Connected",500)),J.isConnectionOK(Te),setTimeout(function(){console.clear(),J.updateWindow()},200),J.isFirstCall(!0),J.manager.getInstallSettings(),J.callStartPage(!0),J.cnxInfo(!1)},J.isFirstCall=n.observable(),e(document).ready(function(){function t(e){J.isDgmFlow(e)}function a(t){return e("<img>",{style:"margin: 0 6px -2px -22px;",src:g.getIconURL(t.value)})}function o(t){return e("<img>",{style:"margin: 0 6px -2px 0;",src:g.getIconURL(t.value)})}function i(t){return e("<img>",{style:"margin: 0px 6px 2px 10px; ",src:b.getPortIconURL(t.value)})}function s(t){return e("<img>",{style:"margin: 0 6px -2px 6px; background-color: white; }",src:b.getPortIconURL(t.value)})}te.canvas.width=0,te.canvas.height=0,y.initDialog(J.manager),w.initDialog(J.manager),D.initDialog(J.manager),R.initDialog(J.manager),E.initDialog(J.manager),C.initDialog(J.manager),N.initDialog(J.manager),S.initDialog(J.manager),B.initDialog(J.manager),F.initDialog(J.manager),x.initDialog(J.manager),P.initDialog(J.manager),O.initDialog(J.manager),r.initButtons(J),d.initActions(J),e("#canvasId").contextmenu(J.interactor.getContextMenu()),ne.addEventListener("mousemove",function(t){J.interactor.isOverCanvas(t)||(e("#canvasId").contextmenu("close"),J.manager.getFlowDiagram().setMousePoint(void 0))}),e("#paletteAccordionId").accordion({heightStyle:"fill",animate:{easing:"swing",duration:200},collapsible:!0,create:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header").css("height","12"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE")},activate:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE");a.newHeader.context&&a.newHeader.context.innerText;J.updateWindow()}}),setTimeout(function(){e("#paletteAccordionId").accordion("option","icons",{header:"ui-icon-triangle-1-e",activeHeader:"ui-icon-triangle-1-s"})},100),e("#accTableFlowId").height(262),e("#accTableMiscsId").height(184),e("#accTableERDId").height(80),e("#accTableLOGId").height(184),e("#accTablePROCId").height(28),J.isDgmFlow=n.observable(!1),e("#btnDgmModeDId").click(function(e,a){t(!0)}),e("#btnDgmModeUId").click(function(e,a){t(!1)}),J.hasDiagram=n.observable(!1),J.setDiagramOpen=function(e){J.hasDiagram(e)},e("#settingsTabId").tabs({}),e("#integrationTabId").tabs({}),e("textarea").keydown(function(t){33==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),t.target.setSelectionRange(0,0),e(this).scrollTop(0)),34==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),textareaLength=e(this).val().length,t.target.setSelectionRange(textareaLength,textareaLength),e(this).scrollTop(9999))}),de.tabs({activate:function(e,t){1===t.newTab.index()?de.css({overflow:"auto"}):de.css({overflow:"hidden"})}}),e("#infoTextId").attr("visibility","hidden"),ie.spinner({step:1,min:c.canvasRange().MIN,max:c.canvasRange().MAX,numberFormat:"n"}),ie.spinner("value",c.initial().LEVELS),ie.spinner("enable"),se.spinner({step:1,min:c.canvasRange().MIN,max:c.canvasRange().MAX,numberFormat:"n"}),se.spinner("value",c.initial().LANES),se.spinner("enable");var u=e("#progressBarId");u.progressbar({value:!1}),u.height(14),e.widget("nodeIcons.iconselectmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{text:g.getIconLabel(t.value)});return o(t).prependTo(a),a},_renderItem:function(t,n){var o=e("<li>"),i=e("<div>",{text:g.getIconLabel(n.value)});return a(n).prependTo(i),o.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,o=g.getOptionItems(a);e.each(o,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e,t){if(l.getDiagramType()===c.diagramType().FLOWCHART){var a=g.getIndexValue(e,t);this.element[0].selectedIndex=a,this.refresh()}}}),e("#nodeIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e("#settingIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e.widget("portImages.porticonmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{style:"padding-left: 16px; height: 16px; width: 100px; background-color: white"});return i(t).prependTo(a),a},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{style:"height: 16px; width: 120px"});return s(a).prependTo(o),n.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this,o=b.getPortOptionItems(a);e.each(o,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=b.getPortIndexValue(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#selectPortIconsId").porticonmenu().porticonmenu("menuWidget").addClass("ui-menu-icons porticons"),e.widget("settings.schemenames",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.value})},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{text:a.value});return n.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this,o=J.manager.getSettingsManager().getOptionsPicker().getOptions();e.each(o,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=J.manager.getSettingsManager().getOptionsPicker().getIndex(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#settingSchemesId").schemenames({width:240}).schemenames("menuWidget").addClass("ui-menu-icons schemenames"),e("#selectPartitionId").selectmenu({select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;console.log("$$$ disk select: "+a),J.selectedPartition(a)}},change:function(e,t){var a=e.currentTarget.textContent;console.log("### disk change: "+a)},create:function(e,t){setTimeout(function(){J.manager.getDiskNames()},1e3)}}).addClass("settingsDiskMenu").css("fontSize","16px"),e("#selectFileTypeId").selectmenu({create:function(t,a){setTimeout(function(){J.selectedFileType(c.fileTypes().JSON),e("#selectFileTypeId").selectmenu("refresh")},1e3)},select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;J.selectedFileType(a),J.manager.getDirContent()}}}).addClass("settingsDiskMenu"),e.widget("dbScripts.inOutmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{text:a.label});return n.append(o).appendTo(t)}}),e("#importExportId").inOutmenu({icons:{button:"ui-icon-blank"},width:160,background:"white",select:function(e,t){C.setDBSelected(document.getElementById("importExportId").value)}}).inOutmenu("menuWidget"),J.refreshImportMenu=function(){e("#importExportId").inOutmenu("refresh")},e.widget("demomenu.demofilesmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},refreshButtonItem:function(e){this.refresh()}}),e("#selectFileId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#flowMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#dbMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#logMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#procMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#cnstrDBTypeId").selectmenu(),e("#dbCPKTypeId").selectmenu(),e("#dbCPKCol1").selectmenu(),e("#dbCPKCol2").selectmenu(),e("#dbCPKCol3").selectmenu(),e.widget("dbScripts.cstrtypes",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{text:a.label});return n.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this;e.each(a,function(e,a){n._renderItemData(t,a)})}}),e("#cnstrDBTypeId").cstrtypes({icons:{button:"ui-icon-blank"},width:18}).cstrtypes("menuWidget").addClass("ui-menu-icons cstrtypes")}),J.startHereVisible=n.pureComputed(function(){return!J.hasDiagram()&&!J.isStartPage()&&!J.hasDialogsOpen()}),J.hasDialogsOpen=n.observable(!1),J.setHasDialogsOpen=function(e){J.hasDialogsOpen(e)},J.disableInactiveTypeButtons=function(e){e?l.getDiagramType()===c.diagramType().ERD_DB?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=!e,document.getElementById("btnLOGId").disabled=e):l.getDiagramType()===c.diagramType().ERD_LOG?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=!e):(document.getElementById("btnFlowId").disabled=!e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e):(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e)},e("#btnFlowId").prop("checked",!0),e('input[id="btnFlowId"]').on("change",function(e){J.enforceDiagramType(c.diagramTypeText().FLOWCHART)}),e('input[id="btnERDId"]').on("change",function(e){J.enforceDiagramType(c.diagramTypeText().ERD_DB)}),e('input[id="btnLOGId"]').on("change",function(e){J.enforceDiagramType(c.diagramTypeText().ERD_LOG)}),J.diagramTypeFlow=n.observable(c.diagramTypeText().FLOWCHART),J.diagramTypeERD=n.observable(c.diagramTypeText().ERD_DB),J.diagramTypeLOG=n.observable(c.diagramTypeText().ERD_LOG),J.diagramTypeProc=n.observable(c.diagramTypeText().PROCESS),J.enforceDiagramType=function(t){t===c.diagramTypeText().ERD_DB?(e("#btnERDId").prop("checked",!0),l.setDiagramType(c.diagramType().ERD_DB),l.setFlowDirection(c.flow().VERTICAL),J.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",2),l.setShowNodeTasks(!1),l.setShowDBRecords(!0),l.setShowCardinality(!0),l.setShowRefHandles(!1),l.setShowNodeIcons(!1),l.setHideNodeNames(!1),l.setLinkStyle(c.linkStyle().STRAIGHT_LINE),l.setSegmentsGap(c.segmentsGap().MAX),l.setGridSpace(c.gridSpace().MAX),J.isFirstCall(!1),J.setERDTabVisible(),J.selectedDBName().length):t===c.diagramTypeText().ERD_LOG?(e("#btnLOGId").prop("checked",!0),l.setDiagramType(c.diagramType().ERD_LOG),l.setFlowDirection(c.flow().VERTICAL),J.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",3),l.setShowNodeTasks(!1),l.setShowDBRecords(!0),l.setShowCardinality(!0),l.setShowRefHandles(!1),l.setShowNodeIcons(!1),l.setHideNodeNames(!1),l.setLinkStyle(c.linkStyle().STRAIGHT_LINE),l.setSegmentsGap(c.segmentsGap().MIN),l.setGridSpace(c.gridSpace().MIN),J.isFirstCall(!1),J.showDBName(!1),J.selectedDBName(""),J.setLOGTabVisible()):(e("#btnFlowId").prop("checked",!0),l.setDiagramType(c.diagramType().FLOWCHART),e("#btnHorizontal").prop("disabled",!1),document.getElementById("btnFlowVId").disabled=!1,e("#paletteAccordionId").accordion("option","active",0),l.setSegmentsGap(c.segmentsGap().MIN),l.setGridSpace(c.gridSpace().MIN),l.setShowDBRecords(!1),l.setShowCardinality(!1),l.setShowNodeTasks(!1),J.isFirstCall(!1),J.showDBName(!1),J.selectedDBName(""),J.setFlowTabVisible()),J.updateWindow()},J.showIconSelection=n.pureComputed(function(){return l.getDiagramType()===c.diagramType().FLOWCHART}),J.dbsToImport=n.observableArray(C.dbScriptTypes()),J.dbsToExport=n.observableArray(C.dbScriptTypes()),J.showDBName=n.observable(!1),J.selectedDBName=n.observable(""),J.dbCallParams={},J.isSelectedMySQL=n.computed(function(){return"MySQL"===J.selectedDBName()}),J.isExportMySQL=n.computed(function(){return"MySQL"===J.selectedDBName()&&J.fsDialogMode()===c.fsDialogMode().EXPORT_DB}),J.callInOutDialog=function(){e("#importExportDialogId").dialog("open")},J.isAutoLayoutAllowed=n.observable(l.isAllowAuto()),J.forceTestAutoMode=function(e){l.setLayoutMode(c.layoutMode().AUTO),J.manager.getSelectionManager().clearSelections(),J.manager.resetScale(),J.runTestAutoMode()},J.resetTestAutoMode=function(){J.manager.clearDiagram(),l.setLayoutMode(c.layoutMode().MANUAL)},J.runTestAutoMode=function(){},J.dbNodeRecords=n.observableArray(),J.showDBTableEditorOnLeft=n.observable(!1),J.showDBCardinalityOnLeft=n.observable(!1),J.showDBTable=n.observable(!0),J.dbTableErrorMsg=n.observable(!1),J.dbColumnKeys=n.observableArray(J.manager.getDBTableEditor().dbColumnKeys()),J.keyId=n.observable(""),J.dbColumnTypes=n.observableArray(J.manager.getDBTableEditor().dbColumnTypes()),J.typeId=n.observable(""),J.dbTableLength=n.observable(""),J.dbColumnAutoIncr=n.observableArray(J.manager.getDBTableEditor().dbColumnAutoIncr()),J.autoIncrId=n.observable(""),J.dbColumnNotNull=n.observableArray(J.manager.getDBTableEditor().dbColumnNotNull()),J.notNullId=n.observable(""),J.showDBConstraints=n.observable(!1),J.dbTableConstraints=n.observableArray(J.manager.getDBTableEditor().dbTypeConstraints()),J.showDBKeys=n.observable(!0),J.showDBIndexes=n.observable(!1),J.dbTableIndexes=n.observableArray(),J.dbCompositePKs=n.observableArray(),J.dbCompositePKTypes=n.observableArray(),J.showDBCompositePK=n.observable(!0),J.compositePKColumns=n.observableArray(),J.isDefault=function(e){return console.log(e),"DEFAULT"!==e},J.showDecisionEditorOnLeft=n.observable(!1),J.nodeEmojiItems=n.pureComputed(function(){return g.getNodeIconOptions()}),J.portIcons=n.pureComputed(function(){return b.getPortIconOptions()}),J.cardinalityItems=n.pureComputed(function(){return m.getCardinalityList()}),J.enableShowCardinality=n.observable(!1),J.setEnableShowCardinality=function(e){J.enableShowCardinality(e)},J.enableShowDB=n.observable(!1),J.setEnableShowDB=function(e){J.enableShowDB(e)},J.onOpsActionChange=function(e){},J.isProgressBarVisible=n.observable(!1),J.isProgressBarVisible.extend({notify:"always"}),J.setProgressBarVisible=function(e){J.isProgressBarVisible(e)},J.showPageMode=n.observable(l.hasPageMode()),J.isCanvasVisible=n.observable(!1),J.setCanvasVisible=function(e){J.isCanvasVisible(e)},J.scaleValue=n.observable(l.getScale()),e("#scaleId").slider(),le.oninput=function(){l.setScale(this.value/c.scale().FACTOR),J.scaleValue(l.getScale()),J.manager.clearClipboard(),J.manager.getFlowDiagram().clearCanvas(),J.manager.rebuildFlowData()},J.editModeText=n.observable(l.isEditMode()?c.editModeText().EDIT:c.editModeText().VIEW),J.setEditModeText=function(e){e===c.editMode().EDIT_ALL?J.editModeText(c.editModeText().EDIT):J.editModeText(c.editModeText().VIEW)},J.setTooltipBox=function(e,t){e.length>0&&l.isEditMode()&&1===l.getScale()&&H.drawTooltip(te,$.getBoundingClientRect(),t,e)},J.showTooltipBox=function(e){},J.getCurrentShortFileName=function(){var e=J.manager.getFileName(),t=e.indexOf(".json"),a=e.substring(0,t),n=a.lastIndexOf("/");return a.substring(n+1)};var fe,Ie=document.getElementById("blockResizeId"),he=e("#extendBlockAcrossId"),ye=e("#extendBlockAlongId"),we=e("#shrinkBlockAcrossId"),De=e("#shrinkBlockAlongId");J.showBlockResizeBar=function(e){var t=e.getExpandedShape(),a=l.getScale();Ie.style.left=$.getBoundingClientRect().left+t.x*a+"px",Ie.style.top=$.getBoundingClientRect().top+t.y*a-24+"px",he.attr("disabled",!l.isEditMode()||!e.canExtendAcross()),ye.attr("disabled",!l.isEditMode()||!e.canExtendAlong()),we.attr("disabled",!l.isEditMode()||!e.canShrinkAcross()),De.attr("disabled",!l.isEditMode()||!e.canShrinkAlong()),Ie.style.visibility="visible"},J.doResizeContainer=function(e){var t=J.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===c.flowType().CONTAINER&&t[0].resizeOutline(e),Ie.style.visibility="hidden",fe=!1},J.isBlockResizeBarVisible=function(){return fe},J.hideContainerBar=function(){Ie.style.visibility="hidden"};var Ee,Ce=document.getElementById("switchResizeId"),Ne=e("#extendSwitchAcrossId"),Se=e("#shrinkSwitchAcrossId");J.showSwitchResizeBar=function(e){var t=e.getMenuBarPosition(),a=l.getScale();Ce.style.left=$.getBoundingClientRect().left+t.x*a+"px",Ce.style.top=$.getBoundingClientRect().top+t.y*a-24+"px",Ne.attr("disabled",!l.isEditMode()||!e.canExtendAcross()),Se.attr("disabled",!l.isEditMode()||!e.canShrinkAcross()),Ce.style.visibility="visible"},J.doResizeSwitch=function(e){var t=J.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===c.flowType().SWITCH&&t[0].resizeOutline(e),Ce.style.visibility="hidden",Ee=!1},J.isSwitchResizeBarVisible=function(){return Ee},J.hideSwitchBar=function(){Ce.style.visibility="hidden"},J.showSearchList=n.observable(!1),J.showFindOptions=n.observable(!0),J.searchContentList=n.observableArray(),J.foundMatches=n.observable(),J.onFindTableClick=function(e){var t=e.target.innerText;N.selectedNewDisk(t)},J.onFindTableDblClick=function(e){J.onFindTableClick(e)},J.onPasteSearchText=function(e){N.selectedNewDisk(label)},J.currentPath=n.observable(),J.fsContentList=n.observableArray(),J.selectedPath=n.observable(),J.isOpenMode=n.observable(),J.isSaveMode=n.observable(),J.isImportDBMode=n.observable(),J.isExportDBMode=n.observable(),J.showPartitions=n.observable(!1),J.partitionsList=n.observableArray([""]),J.selectedPartition=n.observable(),J.filesTypes=n.observableArray([c.fileTypes().JSON,c.fileTypes().ALL]),J.selectedFileType=n.observable(c.fileTypes().JSON);J.showTemplatesOnly=n.observable(!1),J.setShowTemplatesOnly=function(e){J.showTemplatesOnly(e)},J.callOpenFlowDialog=function(e,t){e?(J.setFSDialogMode(c.fsDialogMode().OPEN),J.setShowTemplatesOnly(!0),setTimeout(function(){oe.dialog("open"),oe.dialog({height:180})},200)):t===c.importExportMode().IMPORT?(J.setShowTemplatesOnly(!1),setTimeout(function(){J.isConnectionOK()&&(oe.dialog({height:440}),J.manager.getRootDir(),oe.dialog("open"))},20)):(J.setShowTemplatesOnly(!1),setTimeout(function(){J.isConnectionOK()?oe.dialog({height:440}):oe.dialog({height:180}),J.manager.getRootDir(),oe.dialog("open")},20))},J.onDiskTableClick=function(e){var t=e.target.innerText;D.selectedNewDisk(t)},J.setFSDialogMode=function(e){pe.setFSDialogMode(e),J.fsDialogMode(e)},J.getFSDialogMode=function(){return pe.getFSDialogMode()},J.fsDialogMode=n.observable(),J.restoreWorkDir=function(){pe.restoreWorkDir()},J.setWorkDir=function(e){pe.setWorkDir(e)},J.getWorkDir=function(){return pe.getWorkDir()},J.getSelectedFSDir=function(){return pe.getSelectedFSDir()},J.getSelectedFSFile=function(){return pe.getSelectedFSFile()},J.onDirTableClick=function(e){pe.onDirTableClick(e)},J.deleteFSItem=function(){pe.deleteFSItem()},J.onDirTableDblClick=function(e){pe.onDirTableDblClick(e)},J.updateMainFSLocation=function(){pe.updateMainFSLocation()},J.goOneDirBack=function(){pe.goOneDirBack()},J.setDirsList=function(e,t){pe.setDirsList(e,t)},J.setFolderContent=function(e,t){pe.setFolderContent(e,t)},J.onFileTypeChange=function(e){pe.onFileTypeChange(e)},J.showForegroundSelection=n.observable(!0),J.showBackgroundSelection=n.observable(!0),J.settingsSchemes=n.observableArray([]),J.removeFromSettingsSchemes=function(e){for(var t=-1,a=0;a<J.settingsSchemes().length;a++)if(J.settingsSchemes()[a]===e){t=a;break}a>-1?J.settingsSchemes.splice(t,1):alert("bad index for settingsSchemes: "+t)};var Le;J.setNewAction=function(e){Le=e},J.isNewAction=function(){return Le},J.filesList=n.observableArray();var Be=[];J.setFilesList=function(t){if(Be=t,J.filesList(t),J.filesList(U(t)),Le)e("#newFlowDialogId").dialog("open");else;},J.selectedFile=n.observable(),J.getSelectedFile=function(){return J.isConnectionOK()?_selectedFile:J.selectedFile()},J.isInputInvalid=n.observable(!1),J.validateMessage=n.observable(""),J.newFSNameValue=n.observable(""),J.nameValueEmpty=n.observable(""),J.validateFSName=function(t,a){var n=V.trimMultipleSpaces(J.newFSNameValue()),o=a?s.getDirectoriesLabels():J.filesList();J.nameValueEmpty(0===n.length);var i=(J.isInputInvalid(),V.containsFSName(o,n)),r=V.isFSNameValid(J.newFSNameValue()),l=n.length>0&&(!r||i);J.isInputInvalid(l),e("#newFlowButtonOK").button("option","disabled",J.isInputInvalid()||J.nameValueEmpty()),e("#newFolderButtonOK").button("option","disabled",J.isInputInvalid()||J.nameValueEmpty()),r?i?J.validateMessage("Duplicate name"):J.validateMessage(""):J.validateMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces"),t&&n.length>0&&r&&"Enter"===t.code&&(Le?(y.createNewDiagram(J.manager),e("#newFlowDialogId").dialog("close")):(w.createNewFolder(J.manager),e("#newFolderDialogId").dialog("close")))},J.saveAsInputInvalid=n.observable(!1),J.saveAsMessage=n.observable(""),J.saveAsFileNameValue=n.observable(""),J.saveAsNameEmpty=n.observable(""),J.validateSaveAsFileName=function(e){var t=V.trimMultipleSpaces(J.editNameValue());if(t.length>0){var a=V.containsFSName(J.filesList(),t),n=V.isFSNameValid(t),o=!a&&n;J.isEditNameInvalid(!o)}else J.isEditNameInvalid(!0);a?J.validateNameMessage("Duplicate name"):n?J.validateNameMessage(""):J.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},J.saveAsNewVersion=n.observable(1),J.versionInputInvalid=n.observable(!1),J.validateAsVersion=function(e){var t=(J.saveAsNewVersion(),V.isVersionNumber(J.saveAsNewVersion()));J.versionInputInvalid(!t),Z()},J.isFlowSaveBlocked=function(){return J.saveAsInputInvalid()||J.saveAsNameEmpty()||J.saveAsNewVersion()&&J.versionInputInvalid()};var Me=n.observable();J.propsLinkSourceName=n.observable(),J.propsLinkSourceLabel=n.observable(),J.propsLinkTargetName=n.observable(),J.propsLinkTargetLabel=n.observable(),J.propsLinkLabel=n.observable(),J.getPropsLink=function(){return Me()},J.getPropsLinkLabelValue=function(){return J.propsLinkLabel()},J.showLinkProps=function(t){Me(t),J.propsLinkSourceName(Me().getLinkSourcePortName()),J.propsLinkSourceLabel(Me().getLinkSourcePortLabel()),J.propsLinkTargetName(Me().getLinkTargetPortName()),J.propsLinkTargetLabel(Me().getLinkTargetPortLabel()),J.propsLinkLabel(Me().getLinkLabel()),e("#linkPropsDialogId").dialog("open")},J.propsFgndVisible=n.observable(!0),J.setPropsFgndVisible=function(e){J.propsFgndVisible(e)},J.propsNodeInputs=n.observableArray();var ke,Oe;J.getPropsNodeInputsIdx=function(){return ke},J.getPropsNodeInputsValue=function(){return Oe},J.propsNodeOutputs=n.observableArray();var Fe,xe;J.getPropsNodeOutputsIdx=function(){return Fe},J.getPropsNodeOutputsValue=function(){return xe},J.propsNodeRefInputs=n.observableArray();var Pe,Re;J.getPropsNodeRefInputsIdx=function(){return Pe},J.getPropsNodeRefInputsValue=function(){return Re},J.propsNodeRefOutputs=n.observableArray();var Ae,Ve;J.getPropsNodeRefOutputsIdx=function(){return Ae},J.getPropsNodeRefOutputsValue=function(){return Ve};var He=n.observable();J.setPropsNode=function(e){He(e)},J.getPropsNode=function(){return He()},J.propsNodeName=n.computed(function(){return He()?He().getName():"?"},this),J.showNodeProps=function(t){He(t),t.getFlowType()===c.flowType().DB_TABLE&&t.closeDBEditors(),g.setNodeCategory(t.getNodeCategory()),J.propsNodeInputs(He().getInputPortsProperties()),J.propsNodeOutputs(He().getOutputPortsProperties()),J.propsNodeRefInputs(He().getRefInPortsProperties()),J.propsNodeRefOutputs(He().getRefOutPortsProperties()),J.dbNodeRecords(He().getDBRecords()),e("#nodePropsDialogId").dialog("open")},J.dbEditorPath=n.observable("?"),J.setDBEditorPath=function(e){dbEditorPath(e)};var _e=n.observable();J.setPropsPort=function(e){_e(e)},J.getPropsPort=function(){return _e()},J.propsPortName=n.observable(""),J.editPropsNodeInputLabel=function(e){ke=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeInputsTableId"),a=t.getElementsByTagName("tr");Oe=a[ke].cells[2].getElementsByTagName("input")[0].value},J.checkPortInputCardinality=function(e){E.editPortInputCardinality(e)},J.editPropsNodeOutputLabel=function(e){Fe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeOutputsTableId"),a=t.getElementsByTagName("tr");xe=a[Fe].cells[2].getElementsByTagName("input")[0].value},J.checkPortOutputCardinality=function(e){E.editPortOutputCardinality(e)},J.editPropsNodeRefInputLabel=function(e){Pe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefInputsTableId"),a=t.getElementsByTagName("tr");Re=a[Pe].cells[2].getElementsByTagName("input")[0].value},J.checkPortRefInputCardinality=function(e){E.editPortRefInputCardinality(e)},J.editPropsNodeRefOutputLabel=function(e){Ae=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefOutputsTableId"),a=t.getElementsByTagName("tr");Ve=a[Ae].cells[2].getElementsByTagName("input")[0].value},J.checkPortRefOutputCardinality=function(e){E.editPortRefOutputCardinality(e)},J.isEditNameInvalid=n.observable(!1),J.editNameValue=n.observable(""),J.newFlowNameValue=n.observable(""),J.validateNameMessage=n.observable("");var Ke;J.setOldName=function(e){Ke=e},J.validateInlineNodeName=function(){var e=J.manager.getInlineInputEditor().getCurrentValue(),t=V.trimMultipleSpaces(e);J.validateEditName(t)},J.validateDialogNodeName=function(){var e=V.trimMultipleSpaces(J.editNameValue());J.validateEditName(e)},J.validateNewFlowName=function(){var e=V.trimMultipleSpaces(J.editNameValue());J.validateEditName(e)},J.validateNewFolderName=function(){var e=V.trimMultipleSpaces(J.editNameValue());J.validateEditName(e)},J.validateEditName=function(e){if(e.length>0){var t=V.getAllNames(J.manager.getNodeNamesMap()),a=V.isDuplicateName(Ke,e,t),n=V.isNewNodeNameValid(e),o=!a&&n;J.isEditNameInvalid(!o)}else J.isEditNameInvalid(!0);a?J.validateNameMessage("Duplicate name"):n?J.validateNameMessage(""):J.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},J.isSchemeNameInvalid=n.observable(!1),J.schemeNameValue=n.observable(""),J.validateSchemeMessage=n.observable(""),J.validateSchemeName=function(){var e=document.getElementById("newSchemeId").value;if(e.length>0){var t=J.manager.getSettingsManager().getSchemeNames(),a=t.includes(e),n=V.isSchemeNameValid(e),o=!a&&n;J.isSchemeNameInvalid(!o)}else J.isSchemeNameInvalid(!1);a?J.validateSchemeMessage("Duplicate name"):n?J.validateSchemeMessage(""):J.validateSchemeMessage("Only alphanumericals, dots, dashes and underscores")},J.isLinkLabelInvalid=n.observable(!1),J.linkLabelValue=n.observable(""),J.validateLinkMessage=n.observable("");var Ge;J.setOldLinkLabel=function(e){Ge=e},J.validateLinkLabelName=function(e){var t=V.trimMultipleSpaces(J.linkLabelValue());if(t.length>0){var a=t===Ge||V.isNewLinkLabelValid(t);J.isLinkLabelInvalid(!a)}else J.isLinkLabelInvalid(!1);a?J.validateLinkMessage(""):J.validateLinkMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},J.isFieldInvalid=n.observable(!1),J.fieldValue=n.observable(""),J.validateFieldMessage=n.observable(""),J.validateFieldName=function(){
var e=document.getElementById("inputFieldId").value;if(e.length>0){var t=J.manager.getDBTableEditor().getDBRecordsFields(),a=J.manager.getDBTableEditor().getOldFieldValue(),n=t.includes(e),o=V.isDBFieldValid(e),i=e===a||!n&&o;J.isFieldInvalid(!i)}else J.isFieldInvalid(!1);n?J.validateFieldMessage("Duplicate field"):o?J.validateFieldMessage(""):J.validateFieldMessage("Only alphanumericals, dots, dashes and underscores")},J.isKeyInvalid=n.observable(!1),J.validateKeyMessage=n.observable(""),J.validateKeyValue=function(){var e=document.getElementById("inputKeyId").value,t=J.manager.getDBTableEditor().getLabelById(J.manager.getDBTableEditor().dbColumnKeys(),e);if(J.isKeyInvalid(!1),t.length>0){var a=J.manager.getDBTableEditor().getDBRecordsKeys(),n="PK"===t&&a.includes(t);J.isKeyInvalid(n)}return n?J.validateKeyMessage("Only composite primary key is allowed"):J.validateKeyMessage(""),!n},J.isCPKNameInvalid=n.observable(!1),J.fieldCPKValue=n.observable(""),J.validateCPKMessage=n.observable(""),J.validateCPKName=function(){var e=J.manager.getDBTableEditor().getNewCPKName();if(e.length>0){var t=J.manager.getDBTableEditor().getOldCPKName(),a=V.isDBFieldValid(e),n=e===t||a;J.isCPKNameInvalid(!n)}else J.isCPKNameInvalid(!1);a?J.validateCPKMessage(""):J.validateCPKMessage("Only alphanumericals, dots, dashes and underscores")},J.isDuplicateType=n.observable(!1),J.duplicateConstraintMessage=n.observable("Duplicate constraint"),J.pictureURLValue=n.observable(""),J.isPictureURLInvalid=n.observable(!1),J.validatePictureURL=function(e){J.isPictureURLInvalid(!1)},J.showNewFileName=n.observable(),J.showEditedInfo=n.observable(),J.showDecisionInfo=n.observable(),J.decisionInputPicture=n.observable(),J.decisionEndsPicture=n.observable(),J.isNodeNameInvalid=n.observable(!1),J.newNodeNameValue=n.observable(""),J.invalidNameMessage=n.observable(""),J.resetDecisionIndices=function(){J.updateTrigger(!J.updateTrigger()),p.resetCurrentIndices(),J.decisionInputPicture(p.getCurrentInputPicture()),J.decisionEndsPicture(p.getCurrentEndsPicture())},J.btnFlowH2click=function(){l.getDiagramType()!=c.diagramType().ERD_DB&&l.getDiagramType()!=c.diagramType().ERD_LOG&&J.changeFlowDirection(c.flow().VERTICAL)},J.btnFlowV2click=function(){l.getDiagramType()!=c.diagramType().ERD_DB&&l.getDiagramType()!=c.diagramType().ERD_LOG&&J.changeFlowDirection(c.flow().HORIZONTAL)},J.changeFlowDirection=function(e){X(e)};var We=!1;J.hasFlowDirectionChange=function(){return We},J.setFlowDirectionChange=function(){We=!0},J.resetFlowDirectionChange=function(){We=!1},J.isHorizontal=n.observable(!1),J.layoutModeText=n.observable(l.getLayoutModeText()),J.diagramModeText=n.observable(l.getDiagramModeText());var ze=(e("#newId"),e("#openId")),Ue=(e("#templatetId"),e("#inOutId")),Ze=e("#undoId"),Xe=e("#redoId"),Ye=e("#findId"),je=e("#refreshId"),qe=e("#clearId"),Qe=e("#leftId"),Je=e("#rightId"),$e=e("#deleteId"),et=e("#copyId"),tt=e("#pasteId"),at=e("#saveId"),nt=e("#saveAsId"),ot=e("#btnFlowVId");e("#btnThumbnailId");J.updateWindow=function(t){J.updateTrigger(!J.updateTrigger()),J.isHorizontal(l.getFlowDirection()===c.flow().HORIZONTAL),J.layoutModeText(l.getLayoutModeText()),J.diagramModeText(l.getDiagramModeText());var a=!l.isEditMode();r.updateMenus(J),ze.attr("disabled",!J.isConnectionOK()),Ue.attr("disabled",l.getDiagramType()!==c.diagramType().ERD_DB||J.startHereVisible()||J.isStartPage()||J.manager.isTemplate()||J.manager.isDirty()),Ze.attr("disabled",a||!J.manager.canUndo()).attr("title",J.manager.getUndoName()),Xe.attr("disabled",a||!J.manager.canRedo()).attr("title",J.manager.getRedoName()),$e.attr("disabled",a||!J.manager.getSelectionManager().hasSelections()),et.attr("disabled",a||!J.manager.canCopy()),tt.attr("disabled",a||!J.manager.readyToPaste()),at.attr("disabled",a||!J.isConnectionOK()||!J.manager.isDirty()||J.manager.isTemplate()),nt.attr("disabled",a||!J.isConnectionOK()||J.manager.getModelHandler().isDiagramEmpty()),je.attr("disabled",!J.isCanvasVisible()),Ye.attr("disabled",!J.isCanvasVisible()),qe.attr("disabled",a||!J.isCanvasVisible()),Qe.attr("disabled",!J.manager.hasPreviousDiagram()),Je.attr("disabled",!J.manager.hasNextDiagram()),ot.attr("disabled",l.getAppMode()!==c.appMode().FLOW_MODE),e("#btnFlowHId").attr("disabled",a),e("#btnFlowVId").attr("disabled",a),"visible"!==document.getElementById("blockResizeId").style.visibility||fe?fe&&(document.getElementById("blockResizeId").style.visibility="hidden",fe=!1):fe=!0,"visible"!==document.getElementById("switchResizeId").style.visibility||Ee?Ee&&(document.getElementById("switchResizeId").style.visibility="hidden",Ee=!1):Ee=!0,J.manager.isInitialResizeMode()&&J.manager.getModelHandler().isDiagramEmpty()?(ie.spinner("enable"),se.spinner("enable")):(ie.spinner("disable"),se.spinner("disable")),J.disableInactiveTypeButtons(!J.manager.getModelHandler().isDiagramEmpty())},J.initData=function(){J.updateWindow()},J.galleryFlowNodes=n.pureComputed(function(){return J.updateTrigger(),l.getFlowDirection()===c.flow().HORIZONTAL?u.getFlowNodesH():u.getFlowNodesV()}),J.galleryMiscNodes=n.pureComputed(function(){return J.updateTrigger(),l.getFlowDirection()===c.flow().HORIZONTAL?u.getMiscNodesH():u.getMiscNodesV()}),J.galleryERDNodes=n.pureComputed(function(){return J.updateTrigger(),u.getERDNodes()}),J.galleryLOGNodes=n.pureComputed(function(){return J.updateTrigger(),u.getLOGNodes()}),J.galleryProcNodes=n.pureComputed(function(){return J.updateTrigger(),u.getProcNodes()}),J.pageNodes=n.pureComputed(function(){J.updateTrigger();for(var e=[],t=l.getFlowDirection()===c.flow().HORIZONTAL?u.getHPageItems():u.getVPageItems(),a=0;a<t.length;a++)e.push(t[a]);return e}),J.diagramDisplayName=n.observable(ue),J.setDiagramDisplayName=function(e){e&&e.length>0?(J.showTemplatesOnly()&&(e=c.templateToken()+": "+e),J.diagramDisplayName(e)):J.diagramDisplayName(ue)},J.cnxInfo=n.observable(!1),J.taskActionInputValue=n.observable(""),J.taskServiceInputValue=n.observable(""),J.taskSubscribeInputValue=n.observable(""),J.taskPublishInputValue=n.observable(""),J.taskOperationInputValue=n.observable(""),J.taskExpressionInputValue=n.observable(""),J.showTaskAction=n.observable(!0),J.showTaskService=n.observable(!0),J.showTaskSubscribe=n.observable(!0),J.showTaskPublish=n.observable(!0),J.showTaskOperation=n.observable(!0),J.showTaskExpression=n.observable(!0),J.taskActionSelected=n.observable(!0),J.taskServiceSelected=n.observable(!1),J.taskSubscribeSelected=n.observable(!1),J.taskPublishSelected=n.observable(!1),J.taskOperationSelected=n.observable(!1),J.taskExpressionSelected=n.observable(!1),J.nodeActionList=n.observableArray(),J.nodeOperationList=n.observableArray(),J.nodeServiceList=n.observableArray(),J.nodePublishList=n.observableArray(),J.nodeSubscribeList=n.observableArray(),J.showTaskEditorOnLeft=n.observable(!1),J.aboutTitle=n.observable(""),J.aboutVersion=n.observable(""),J.aboutText=n.observable(""),J.aboutSources=n.observable(""),J.aboutCopyright=n.observable(""),J.showAboutBox=function(t,a,n,o,i){J.aboutTitle(t),J.aboutVersion(a),J.aboutText(n),J.aboutSources(o),e("#aboutDialogId").dialog("open")},J.welcomeTitle=n.observable(""),J.welcomeGreeting=n.observable(""),J.welcomeTo=n.observable(""),J.welcomeTip=n.observable(""),J.showWelcomeBox=function(t,a,n,o){J.welcomeTitle(t),J.welcomeGreeting(a),J.welcomeTo(n),J.welcomeTip(o),e("#welcomeDialogId").dialog("open")},J.isStartPage=n.observable(!1);document.getElementById("startToTopBtn");J.setStartPageOpen=function(e){J.isStartPage(e)},J.onStartToTopClick=function(t){e("#navbarId").show(),setTimeout(function(){e("#topContainerId").show(),J.manager.refreshDiagramOnEdit(!0)},20)},J.startTitle=n.observable(""),J.startTopText1=n.observable(""),J.startTopText2=n.observable(""),J.startFlowTitle=n.observable(""),J.startERDTitle=n.observable(""),J.startLOGTitle=n.observable(""),J.startProcessTitle=n.observable(""),J.showStartPage=function(e,t,a,n,o,i,s){J.startTitle(e),J.startTopText1(t),J.startTopText2(a),J.startFlowTitle(n),J.startERDTitle(o),J.startLOGTitle(i),J.startProcessTitle(s),J.manager.getStartPageEditor().showStartPageEditor(J.manager)},J.callStartPage=function(e){var t=k.getTitle(),a=k.getTopText1(),n=k.getTopText2(),o=k.getFlowTitle(),i=k.getERDTitle(),s=k.getLOGTitle();procTitle=k.getProcessTitle(),J.manager.clearNamesCache(),J.getFlowManager().clearDiagram(),J.getFlowManager().refreshDiagram(),J.showStartPage(t,a,n,o,i,s,procTitle)},J.templatesList=n.observableArray([""]),J.flowTemplates=n.observableArray(J.manager.getTemplates().getFlowTemplatesList()),J.dbTemplates=n.observableArray(J.manager.getTemplates().getDBTemplatesList()),J.logTemplates=n.observableArray(J.manager.getTemplates().getLOGTemplatesList()),J.procTemplates=n.observableArray(J.manager.getTemplates().getPROCTemplatesList()),J.showFlowTemplates=n.observable(l.getDiagramType()===c.diagramType().FLOWCHART),J.showDBTemplates=n.observable(l.getDiagramType()===c.diagramType().ERD_DB),J.showLOGTemplates=n.observable(l.getDiagramType()===c.diagramType().ERD_LOG),J.showPROCTemplates=n.observable(l.getDiagramType()===c.diagramType().PROCESS),J.flowTabVisible=n.observable(),J.erdTabVisible=n.observable(),J.logTabVisible=n.observable(),J.procTabVisible=n.observable(),J.setFlowTabVisible=function(){j(),J.flowTabVisible(!0)},J.setERDTabVisible=function(){j(),J.erdTabVisible(!0)},J.setLOGTabVisible=function(){j(),J.logTabVisible(!0)},J.setPROCTabVisible=function(){j(),J.procTabVisible(!0)},J.infoMessage=n.observable(""),J.infoMessageVisible=n.observable(),J.showInfoMessage=function(t,a){J.infoMessage(t),J.infoMessageVisible(!1),e("#infoDialogId").dialog("open"),a&&e("#infoDialogId").dialog("option","title",a)},e("#infoDialogId").on("dialogopen",function(t,a){setTimeout(function(){J.infoMessageVisible(!0),e("#infoTextId").scrollTop(0)},200)});var it;J.getConfirmFlag=function(){return it},J.setConfirmFlag=function(e){it=e},J.confirmMessage=n.observable(""),J.showConfirmMessage=function(t,a,n){x.initDialog(J.manager),J.confirmMessage(t),a&&re.dialog("option","title",a),n&&(e(e("button",re.parent())[1]).text(n.first),e(e("button",re.parent())[2]).text(n.second)),re.dialog("open")},J.isShowThumbnail=n.observable(),J.btnThumbnailShow=function(){J.isShowThumbnail(!0),e("#thumbnailDialogId").dialog("open"),J.repaintDiagram()},J.btnThumbnailHide=function(){J.isShowThumbnail(!1),J.repaintDiagram()},J.overlayText=n.observable("");var st=e("#saveOverlayId");J.showOverlayMessage=function(e,t){var a=t||400;J.overlayText(e),st.show(),setTimeout(function(){st.fadeOut(a)},a+200)},J.bottomMessageText=n.observable("");var rt=e("#bottomOverlayId");J.showBottomMessage=function(e,t){var a=t||1e3;J.bottomMessageText(e),rt.show(),setTimeout(function(){rt.fadeOut(a)},a+200)},ae.addEventListener("scroll",function(e){e.currentTarget.scrollLeft||e.currentTarget.scrollRight}),le.addEventListener("mousemove",function(e){q()},!1),le.onchange=function(){q()};var lt;J.getDraggedPaletteId=function(){return lt},J.setDraggedPaletteId=function(e){lt=e},J.onPaletteDragStart=function(e){parseInt(e.target.id)===c.flowType().DB_TABLE_2||parseInt(e.target.id)===c.flowType().DB_TABLE_3||parseInt(e.target.id)===c.flowType().DB_TABLE_4?(lt=c.flowType().DB_TABLE,e.dataTransfer.setData("text",c.flowType().DB_TABLE),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===c.flowType().ENTITY_W?(lt=c.flowType().ENTITY,e.dataTransfer.setData("text",c.flowType().ENTITY),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===c.flowType().RELATION_W?(lt=c.flowType().RELATION,e.dataTransfer.setData("text",c.flowType().RELATION),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===c.flowType().ATTR_MULTI||parseInt(e.target.id)===c.flowType().ATTR_DRV?(lt=c.flowType().ATTRIBUTE,e.dataTransfer.setData("text",c.flowType().ATTRIBUTE),e.dataTransfer.setData("altType",e.target.id)):(lt=e.target.id,e.dataTransfer.setData("text",e.target.id))},J.onPaletteDragEnd=function(e){var t=$.getBoundingClientRect();e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom||J.manager.getDnDHandler().resetDrag()},J.requestFocus=function(){},J.isControlPressed=function(){return ge},J.setControlPressed=function(e){ge=e},J.isEditControlPressed=function(){return me},J.setEditControlPressed=function(e){me=e},J.isShiftPressed=function(){return be},J.setShiftPressed=function(e){be=e},window.onresize=function(){ce.style.height=window.innerHeight+"px",e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),Q(),J.manager.getInlineInputEditor().relocateInlineFieldEditor(),J.manager.getInlineAreaEditor().relocateInlineAreaEditor(),J.manager.getDBTableEditor().relocateDBTableEditor(),J.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),J.manager.getDecisionLayoutEditor().relocateDecisionLayoutEditor(),J.manager.getFlowTasksEditor().relocateFlowTasksEditor(),E.relocateDialog(),q(),J.repaintDiagram()},window.onscroll=function(){J.manager.getDBTableEditor().relocateDBTableEditor(),e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),J.repaintDiagram()};var dt=0,ct=e("#containerId");return J.repaintDiagram=function(){J.hideContainerBar(),J.hideSwitchBar(),J.manager.paintDiagram()},n.applyBindings(J),J.initData(),{initFlowDemo:function(){window.scrollTo(0,0),e(window).trigger("resize"),J.setProgressBarVisible(!1),J.showOverlayMessage("Connecting to server...",1e3),o.checkServerConnection(J.manager)}}});