//self.aboutCopyright(copy);

define(["jquery","jqueryui","jqueryuictxm","knockout","modules/server/ioHandler","modules/server/ioHelper","modules/fs/directories","modules/html/toolbar","modules/settings/config","modules/actions/frameActions","modules/graph/graphConstants","modules/gallery/components","modules/gallery/iconOptionsPicker","modules/gallery/portIconPicker","modules/gallery/cardinalityPicker","modules/gallery/decisionEnds","modules/erd/dbRecords","modules/flow/flowManager","modules/flow/flowUtils","modules/fs/fsBrowser","modules/diagram/mouseInteractor","modules/dialogs/newFlowDialog","modules/dialogs/newFolderDialog","modules/dialogs/openFlowDialog","modules/dialogs/nodePropsDialog","modules/dialogs/importExportDialog","modules/dialogs/findDialog","modules/dialogs/linkPropsDialog","modules/dialogs/dbTableEditor","modules/dialogs/aboutDialog","modules/util/welcomeText","modules/util/startText","modules/dialogs/welcomeDialog","modules/dialogs/infoDialog","modules/dialogs/confirmDialog","modules/dialogs/thumbnailDialog","modules/settings/settingsDialog","modules/geometry/point","modules/util/utils","modules/draw/draw","modules/controller/flowCache","modules/exportLayout/demoFlow","modules/util/integrationText"],function(e,t,a,n,o,i,s,r,l,d,c,u,g,b,m,p,v,T,f,I,h,y,w,D,E,N,S,L,C,B,k,O,F,M,x,R,P,A,V,H,_,G,W){function K(e){e===c.flow().VERTICAL?(he.removeClass("block-extendV"),he.addClass("block-extendH"),ye.removeClass("block-extendH"),ye.addClass("block-extendV"),we.removeClass("block-shrinkV"),we.addClass("block-shrinkH"),De.removeClass("block-shrinkH"),De.addClass("block-shrinkV")):e===c.flow().HORIZONTAL&&(he.removeClass("block-extendH"),he.addClass("block-extendV"),ye.removeClass("block-extendV"),ye.addClass("block-extendH"),we.removeClass("block-shrinkH"),we.addClass("block-shrinkV"),De.removeClass("block-shrinkV"),De.addClass("block-shrinkH"))}function z(e){e===c.flow().VERTICAL?(Se.removeClass("block-extendV"),Se.addClass("block-extendH"),Le.removeClass("block-shrinkV"),Le.addClass("block-shrinkH")):e===c.flow().HORIZONTAL&&(Se.removeClass("block-extendH"),Se.addClass("block-extendV"),Le.removeClass("block-shrinkH"),Le.addClass("block-shrinkV"))}function U(e){if($.selectedFileType()===c.fileTypes().ALL)return e;var t=[],a=$.selectedFileType().split(".").pop();return e.forEach(function(e){e.split(".").pop()===a&&t.push(e)}),t}function Z(){e("#openSaveButtonOK").button("option","disabled",$.isFlowSaveBlocked())}function Y(e){l.setFlowDirection(e),X(e),$.setFlowDirectionChange(),K(e),z(e),$.getFlowManager().hasDiagramOpen()&&$.manager.setDirty(!0),$.setConfirmFlag(c.bValue().FALSE),$.getFlowManager().setSettingsChanged(!0),setTimeout(function(){$.getFlowManager().refreshDiagramOnEdit(!0),$.getFlowManager().refreshDiagramOnEdit(!0)},200)}function X(e){e===c.flow().VERTICAL?f.updateDecisionInputs($.manager.getModelHandler().getFlowNodes(),c.decisionInputs().NORTH):e===c.flow().HORIZONTAL&&f.updateDecisionInputs($.manager.getModelHandler().getFlowNodes(),c.decisionInputs().WEST)}function j(){$.flowTabVisible(!1),$.erdTabVisible(!1),$.logTabVisible(!1),$.procTabVisible(!1)}function q(){var e=document.getElementById("containerId").clientWidth;Q.width>e&&l.hasShowBottomMessages()&&$.showBottomMessage("Drag the mouse on canvas to scroll")}function J(){var t=e(window).height();e(window).scrollTop();ct.height(t-dt)}var $=this,Q=document.getElementById("canvasId"),ee=document.getElementById("canvasThId"),te=Q.getContext("2d"),ae=document.getElementById("containerId"),ne=document.getElementById("topContainerId"),oe=e("#openFlowDialogId"),ie=e("#spinnerLevelsId"),se=e("#spinnerLanesId"),re=(e("#spinnerSpaceId"),e("#confirmDialogId")),le=(e("#thumbnailDialogId"),document.getElementById("scaleId")),de=e("#nodePropsTabId"),ce=document.getElementById("paletteCtrId"),ue="[Select diagram type or 'Open Diagram / Template...']",ge=!1,be=!1,me=!1;$.accHdrFlowTitle=n.observable(c.appTitles().FLOW_TITLE),$.accHdrSideTitle=n.observable(c.appTitles().SIDE_TITLE),$.accHdrMiscTitle=n.observable(c.appTitles().MISC_TITLE),$.accHdrERDTitle=n.observable(c.appTitles().DB_ERD_TITLE),$.accHdrLOGTitle=n.observable(c.appTitles().DB_LOG_TITLE),$.accHdrPROCTitle=n.observable(c.appTitles().PROCESS_TITLE),$.accHdrPagesTitle=n.observable(c.appTitles().PAGES_TITLE),$.accHdrBpelTitle=n.observable(c.appTitles().BPEL_TITLE),$.accHdrK8sTitle=n.observable(c.appTitles().K8S_TITLE),$.getCanvas=function(){return Q},$.setCanvas=function(e){Q=e},$.getCanvasContext=function(){return te},$.getCanvasTh=function(){return ee},$.setCanvasTh=function(e){ee=e},$.getCanvasContext=function(){return te},$.getCanvasContainer=function(){return ae},$.getTopContainer=function(){return ne},$.manager=new T($),$.interactor=$.manager.getMouseInteractor(),$.dndHandler=$.manager.getDnDHandler(),$.updateTrigger=n.observable(!1);var pe=new I($);$.getFlowManager=function(){return $.manager};var ve=Date.now(),Te=!1;$.isConnectionOK=n.observable(Te),$.cnxResultOK=function(){Te=!0,$.showOverlayMessage("Connected",500),$.isConnectionOK(Te),setTimeout(function(){$.updateWindow()},200),$.manager.getInstallSettings(),$.callStartPage(!0),$.cnxInfo(!0)},$.cnxResultFAIL=function(e){Date.now()-ve<3e3?(Te=!1,console.log("*** connection FAIL: "+e.readyState),setTimeout(function(){$.showOverlayMessage("No server connection",500)},200)):(Te=!0,$.showOverlayMessage("Connected",500)),$.isConnectionOK(Te),setTimeout(function(){console.clear(),$.updateWindow()},200),$.manager.getInstallSettings(),$.callStartPage(!0),$.cnxInfo(!1)},e(document).ready(function(){function t(e){$.isDgmFlow(e)}function a(t){return e("<img>",{style:"margin: 0 6px -2px -22px;",src:g.getIconURL(t.value)})}function o(t){return e("<img>",{style:"margin: 0 6px -2px 0;",src:g.getIconURL(t.value)})}function i(t){return e("<img>",{style:"margin: 0px 6px 2px 10px; ",src:b.getPortIconURL(t.value)})}function s(t){return e("<img>",{style:"margin: 0 6px -2px 6px; background-color: white; }",src:b.getPortIconURL(t.value)})}te.canvas.width=0,te.canvas.height=0,y.initDialog($.manager),w.initDialog($.manager),D.initDialog($.manager),P.initDialog($.manager),E.initDialog($.manager),N.initDialog($.manager),S.initDialog($.manager),L.initDialog($.manager),B.initDialog($.manager),M.initDialog($.manager),x.initDialog($.manager),R.initDialog($.manager),F.initDialog($.manager),r.initButtons($),d.initActions($),e("#canvasId").contextmenu($.interactor.getContextMenu()),ne.addEventListener("mousemove",function(t){$.interactor.isOverCanvas(t)||(e("#canvasId").contextmenu("close"),$.manager.getFlowDiagram().setMousePoint(void 0))}),e("#paletteAccordionId").accordion({heightStyle:"fill",animate:{easing:"swing",duration:200},collapsible:!0,create:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header").css("height","12"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE")},activate:function(t,a){e(".ui-accordion-header").css("background","#b5e0fd"),e(".ui-accordion-header.ui-state-active ").css("background","#408DEE");a.newHeader.context&&a.newHeader.context.innerText;$.updateWindow()}}),setTimeout(function(){e("#paletteAccordionId").accordion("option","icons",{header:"ui-icon-triangle-1-e",activeHeader:"ui-icon-triangle-1-s"})},100),e("#accTableFlowId").height(262),e("#accTableMiscsId").height(184),e("#accTableERDId").height(80),e("#accTableLOGId").height(184),e("#accTablePROCId").height(28),$.isDgmFlow=n.observable(!1),e("#btnDgmModeDId").click(function(e,a){t(!0)}),e("#btnDgmModeUId").click(function(e,a){t(!1)}),$.hasDiagram=n.observable(!1),$.setDiagramOpen=function(e){$.hasDiagram(e)},e("#settingsTabId").tabs({}),e("#integrationTabId").tabs({}),e("#importExportTabId").tabs({}),e("textarea").keydown(function(t){33==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),t.target.setSelectionRange(0,0),e(this).scrollTop(0)),34==t.which&&(window.scrollTo(0,window.scrollY),t.preventDefault(),textareaLength=e(this).val().length,t.target.setSelectionRange(textareaLength,textareaLength),e(this).scrollTop(9999))}),de.tabs({activate:function(e,t){1===t.newTab.index()?de.css({overflow:"auto"}):de.css({overflow:"hidden"})}}),e("#infoTextId").attr("visibility","hidden"),ie.spinner({step:1,min:c.canvasRange().MIN,max:c.canvasRange().MAX,numberFormat:"n"}),ie.spinner("value",c.initial().LEVELS),ie.spinner("enable"),se.spinner({step:1,min:c.canvasRange().MIN,max:c.canvasRange().MAX,numberFormat:"n"}),se.spinner("value",c.initial().LANES),se.spinner("enable");var u=e("#progressBarId");u.progressbar({value:!1}),u.height(14),e.widget("nodeIcons.iconselectmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{text:g.getIconLabel(t.value)});return o(t).prependTo(a),a},_renderItem:function(t,n){var o=e("<li>"),i=e("<div>",{text:g.getIconLabel(n.value)});return a(n).prependTo(i),o.append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,o=g.getOptionItems(a);e.each(o,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e,t){if(l.getDiagramType()===c.diagramType().FLOWCHART){var a=g.getIndexValue(e,t);this.element[0].selectedIndex=a,this.refresh()}}}),e("#nodeIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e("#settingIconItemsId").iconselectmenu().iconselectmenu("menuWidget").addClass("ui-menu-icons customicons"),e.widget("portImages.porticonmenu",e.ui.selectmenu,{_renderButtonItem:function(t){var a=e("<div>",{style:"padding-left: 16px; height: 16px; width: 100px; background-color: white"});return i(t).prependTo(a),a},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{style:"height: 16px; width: 120px"});return s(a).prependTo(o),n.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this,o=b.getPortOptionItems(a);e.each(o,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=b.getPortIndexValue(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#selectPortIconsId").porticonmenu().porticonmenu("menuWidget").addClass("ui-menu-icons porticons");document.getElementById("settingSchemesId");e.widget("settings.schemenames",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.value})},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{text:a.value});return n.append(o).appendTo(t)},_renderMenu:function(t,a){var n=this,o=$.manager.getSettingsManager().getOptionsPicker().getOptions();e.each(o,function(e,a){n._renderItemData(t,a)})},refreshButtonItem:function(e){var t=$.manager.getSettingsManager().getOptionsPicker().getIndex(e);this.element[0].selectedIndex=t,this.refresh()}}),e("#settingSchemesId").schemenames({width:240}).schemenames("menuWidget").addClass("ui-menu-icons schemenames"),e("#selectPartitionId").selectmenu({select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;console.log("$$$ disk select: "+a),$.selectedPartition(a)}},change:function(e,t){var a=e.currentTarget.textContent;console.log("### disk change: "+a)},create:function(e,t){setTimeout(function(){$.manager.getDiskNames()},1e3)}}).addClass("settingsDiskMenu").css("fontSize","16px"),e("#selectFileTypeId").selectmenu({create:function(t,a){setTimeout(function(){$.selectedFileType(c.fileTypes().JSON),e("#selectFileTypeId").selectmenu("refresh")},1e3)},select:function(e,t){if(e.currentTarget){var a=e.currentTarget.textContent;$.selectedFileType(a),$.manager.getDirContent()}}}).addClass("settingsDiskMenu"),e.widget("dbScripts.inOutmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{text:a.label});return n.append(o).appendTo(t)}}),e("#importExportId").inOutmenu({icons:{button:"ui-icon-blank"},width:160,select:function(e,t){N.setDBSelected(document.getElementById("importExportId").value)}}).inOutmenu("menuWidget"),$.refreshImportMenu=function(){e("#importExportId").inOutmenu("refresh")},e.widget("demomenu.demofilesmenu",e.ui.selectmenu,{_renderButtonItem:function(t){return e("<div>",{text:t.label})},refreshButtonItem:function(e){this.refresh()}}),e("#selectFileId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#flowMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#dbMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#logMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles"),e("#procMenuId").demofilesmenu().demofilesmenu("menuWidget").addClass("ui-menu-icons demofiles")}),$.startHereVisible=n.pureComputed(function(){return!$.hasDiagram()&&!$.isStartPage()&&!$.someDialogsOpen()}),$.someDialogsOpen=n.observable(!1),$.setSomeDialogsOpen=function(e){$.someDialogsOpen(e)},$.disableInactiveTypeButtons=function(e){e?l.getDiagramType()===c.diagramType().ERD_DB?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=!e,document.getElementById("btnLOGId").disabled=e):l.getDiagramType()===c.diagramType().ERD_LOG?(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=!e):(document.getElementById("btnFlowId").disabled=!e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e):(document.getElementById("btnFlowId").disabled=e,document.getElementById("btnERDId").disabled=e,document.getElementById("btnLOGId").disabled=e)},e("#btnFlowId").prop("checked",!0),e('input[id="btnFlowId"]').on("change",function(e){$.enforceDiagramType(c.diagramTypeText().FLOWCHART)}),e('input[id="btnERDId"]').on("change",function(e){$.enforceDiagramType(c.diagramTypeText().ERD_DB)}),e('input[id="btnLOGId"]').on("change",function(e){$.enforceDiagramType(c.diagramTypeText().ERD_LOG)}),$.diagramTypeFlow=n.observable(c.diagramTypeText().FLOWCHART),$.diagramTypeERD=n.observable(c.diagramTypeText().ERD_DB),$.diagramTypeLOG=n.observable(c.diagramTypeText().ERD_LOG),$.diagramTypeProc=n.observable(c.diagramTypeText().PROCESS),$.enforceDiagramType=function(t){t===c.diagramTypeText().ERD_DB?(e("#btnERDId").prop("checked",!0),l.setDiagramType(c.diagramType().ERD_DB),l.setFlowDirection(c.flow().VERTICAL),$.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",2),l.setShowNodeTasks(!1),l.setShowDBRecords(!0),l.setShowCardinality(!0),l.setShowRefHandles(!1),l.setShowNodeIcons(!1),l.setHideNodeNames(!1),l.setLinkStyle(c.linkStyle().STRAIGHT_LINE),l.setSegmentsGap(c.segmentsGap().MAX),l.setGridSpace(c.gridSpace().MAX),$.setERDTabVisible()):t===c.diagramTypeText().ERD_LOG?(e("#btnLOGId").prop("checked",!0),l.setDiagramType(c.diagramType().ERD_LOG),l.setFlowDirection(c.flow().VERTICAL),$.isHorizontal(!1),e("#btnVertical").prop("checked",!0),document.getElementById("btnHorizontal").disabled=!0,document.getElementById("btnFlowVId").disabled=!0,e("#paletteAccordionId").accordion("option","active",3),l.setShowNodeTasks(!1),l.setShowDBRecords(!0),l.setShowCardinality(!0),l.setShowRefHandles(!1),l.setShowNodeIcons(!1),l.setHideNodeNames(!1),l.setLinkStyle(c.linkStyle().STRAIGHT_LINE),l.setSegmentsGap(c.segmentsGap().MIN),l.setGridSpace(c.gridSpace().MIN),$.showDBName(!1),$.selectedDBName(""),$.setLOGTabVisible()):(e("#btnFlowId").prop("checked",!0),l.setDiagramType(c.diagramType().FLOWCHART),e("#btnHorizontal").prop("disabled",!1),document.getElementById("btnFlowVId").disabled=!1,e("#paletteAccordionId").accordion("option","active",0),l.setSegmentsGap(c.segmentsGap().MIN),l.setGridSpace(c.gridSpace().MIN),l.setShowDBRecords(!1),l.setShowCardinality(!1),l.setShowNodeTasks(!1),$.showDBName(!1),$.selectedDBName(""),$.setFlowTabVisible()),$.updateWindow()},$.showIconSelection=n.pureComputed(function(){return l.getDiagramType()===c.diagramType().FLOWCHART}),$.dbsToImport=n.observableArray(N.dbScriptTypes()),$.dbsToExport=n.observableArray(N.dbScriptTypes()),$.showDBName=n.observable(!1),$.selectedDBName=n.observable(""),$.showInOutDialog=function(){e("#importExportDialogId").dialog("open")},$.isAutoLayoutAllowed=n.observable(l.isAllowAuto()),$.forceTestAutoMode=function(e){l.setLayoutMode(c.layoutMode().AUTO),$.manager.getSelectionManager().clearSelections(),$.manager.resetScale(),$.runTestAutoMode()},$.resetTestAutoMode=function(){$.manager.clearDiagram(),l.setLayoutMode(c.layoutMode().MANUAL)},$.runTestAutoMode=function(){},$.dbNodeRecords=n.observableArray(),$.showDBTableEditorOnLeft=n.observable(!1),$.showDBCardinalityOnLeft=n.observable(!1),$.dbTableErrorMsg=n.observable(!1),$.dbColumnKeys=n.observableArray($.manager.getDBTableEditor().dbColumnKeys()),$.keyId=n.observable(""),$.dbColumnTypes=n.observableArray($.manager.getDBTableEditor().dbColumnTypes()),$.typeId=n.observable(""),$.dbTableLength=n.observable(""),$.dbColumnAutoIncr=n.observableArray($.manager.getDBTableEditor().dbColumnAutoIncr()),$.autoIncrId=n.observable(""),$.dbColumnNotNull=n.observableArray($.manager.getDBTableEditor().dbColumnNotNull()),$.notNullId=n.observable(""),$.showDBConstraints=n.observable(!1),$.dbTableConstraints=n.observableArray(),$.showDBIndexes=n.observable(!1),$.dbTableIndexes=n.observableArray(),$.isDefault=function(e){return console.log(e),"DEFAULT"!==e},$.showDecisionEditorOnLeft=n.observable(!1),$.nodeEmojiItems=n.pureComputed(function(){return g.getNodeIconOptions()}),$.portIcons=n.pureComputed(function(){return b.getPortIconOptions()}),$.cardinalityItems=n.pureComputed(function(){return m.getCardinalityList()}),$.enableShowCardinality=n.observable(!1),$.setEnableShowCardinality=function(e){$.enableShowCardinality(e)},$.enableShowDB=n.observable(!1),$.setEnableShowDB=function(e){$.enableShowDB(e)},$.onOpsActionChange=function(e){},$.isProgressBarVisible=n.observable(!1),$.isProgressBarVisible.extend({notify:"always"}),$.setProgressBarVisible=function(e){$.isProgressBarVisible(e)},$.showPageMode=n.observable(l.hasPageMode()),$.isCanvasVisible=n.observable(!1),$.setCanvasVisible=function(e){$.isCanvasVisible(e)},$.scaleValue=n.observable(l.getScale()),e("#scaleId").slider(),le.oninput=function(){l.setScale(this.value/c.scale().FACTOR),$.scaleValue(l.getScale()),$.manager.clearClipboard(),$.manager.getFlowDiagram().clearCanvas(),$.manager.rebuildFlowData()},$.editModeText=n.observable(l.isEditMode()?c.editModeText().EDIT:c.editModeText().VIEW),$.setEditModeText=function(e){e===c.editMode().EDIT_ALL?$.editModeText(c.editModeText().EDIT):$.editModeText(c.editModeText().VIEW)},$.setTooltipBox=function(e,t){e.length>0&&l.isEditMode()&&1===l.getScale()&&H.drawTooltip(te,Q.getBoundingClientRect(),t,e)},$.showTooltipBox=function(e){},$.getCurrentShortFileName=function(){var e=$.manager.getFileName(),t=e.indexOf(".json"),a=e.substring(0,t),n=a.lastIndexOf("/");return a.substring(n+1)};var fe,Ie=document.getElementById("blockResizeId"),he=e("#extendBlockAcrossId"),ye=e("#extendBlockAlongId"),we=e("#shrinkBlockAcrossId"),De=e("#shrinkBlockAlongId");$.showBlockResizeBar=function(e){var t=e.getExpandedShape(),a=l.getScale();Ie.style.left=Q.getBoundingClientRect().left+t.x*a+"px",Ie.style.top=Q.getBoundingClientRect().top+t.y*a-24+"px",he.attr("disabled",!l.isEditMode()||!e.canExtendAcross()),ye.attr("disabled",!l.isEditMode()||!e.canExtendAlong()),we.attr("disabled",!l.isEditMode()||!e.canShrinkAcross()),De.attr("disabled",!l.isEditMode()||!e.canShrinkAlong()),Ie.style.visibility="visible"},$.doResizeContainer=function(e){var t=$.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===c.flowType().CONTAINER&&t[0].resizeOutline(e),Ie.style.visibility="hidden",fe=!1},$.isBlockResizeBarVisible=function(){return fe},$.hideContainerBar=function(){Ie.style.visibility="hidden"};var Ee,Ne=document.getElementById("switchResizeId"),Se=e("#extendSwitchAcrossId"),Le=e("#shrinkSwitchAcrossId");$.showSwitchResizeBar=function(e){var t=e.getMenuBarPosition(),a=l.getScale();Ne.style.left=Q.getBoundingClientRect().left+t.x*a+"px",Ne.style.top=Q.getBoundingClientRect().top+t.y*a-24+"px",Se.attr("disabled",!l.isEditMode()||!e.canExtendAcross()),Le.attr("disabled",!l.isEditMode()||!e.canShrinkAcross()),Ne.style.visibility="visible"},$.doResizeSwitch=function(e){var t=$.getFlowManager().getSelectionManager().getSelections();t[0].getFlowType()===c.flowType().SWITCH&&t[0].resizeOutline(e),Ne.style.visibility="hidden",Ee=!1},$.isSwitchResizeBarVisible=function(){return Ee},$.hideSwitchBar=function(){Ne.style.visibility="hidden"},$.showSearchList=n.observable(!1),$.showFindOptions=n.observable(!0),$.searchContentList=n.observableArray(),$.foundMatches=n.observable(),$.onFindTableClick=function(e){var t=e.target.innerText;S.selectedNewDisk(t)},$.onFindTableDblClick=function(e){$.onFindTableClick(e)},$.onPasteSearchText=function(e){S.selectedNewDisk(label)},$.currentPath=n.observable(),$.fsContentList=n.observableArray(),$.selectedPath=n.observable(),$.isOpenMode=n.observable(),$.isSaveMode=n.observable(),$.isImportDBMode=n.observable(),$.isExportDBMode=n.observable(),$.showPartitions=n.observable(!1),$.partitionsList=n.observableArray([""]),$.selectedPartition=n.observable(),$.filesTypes=n.observableArray([c.fileTypes().JSON,c.fileTypes().ALL]),$.selectedFileType=n.observable(c.fileTypes().JSON);$.showTemplatesOnly=n.observable(!1),$.setShowTemplatesOnly=function(e){$.showTemplatesOnly(e)},$.callOpenFlowDialog=function(e,t){e?($.setFSDialogMode(c.fsDialogMode().OPEN),$.setShowTemplatesOnly(!0),setTimeout(function(){oe.dialog("open"),oe.dialog({height:180})},200)):t?($.setShowTemplatesOnly(!1),setTimeout(function(){$.isConnectionOK()&&(oe.dialog({height:440}),$.manager.getRootDir(),oe.dialog("open"))},200)):($.setShowTemplatesOnly(!1),setTimeout(function(){$.isConnectionOK()?oe.dialog({height:440}):oe.dialog({height:180}),$.manager.getRootDir(),oe.dialog("open")},200))},$.onDiskTableClick=function(e){var t=e.target.innerText;D.selectedNewDisk(t)},$.setFSDialogMode=function(e){pe.setFSDialogMode(e)},$.getFSDialogMode=function(){return pe.getFSDialogMode()},$.restoreWorkDir=function(){pe.restoreWorkDir()},$.setWorkDir=function(e){pe.setWorkDir(e)},$.getWorkDir=function(){return pe.getWorkDir()},$.getSelectedFSDir=function(){return pe.getSelectedFSDir()},$.getSelectedFSFile=function(){return pe.getSelectedFSFile()},$.onDirTableClick=function(e){pe.onDirTableClick(e)},$.deleteFSItem=function(){pe.deleteFSItem()},$.onDirTableDblClick=function(e){pe.onDirTableDblClick(e)},$.updateMainFSLocation=function(){pe.updateMainFSLocation()},$.goOneDirBack=function(){pe.goOneDirBack()},$.setDirsList=function(e,t){pe.setDirsList(e,t)},$.setFolderContent=function(e,t){pe.setFolderContent(e,t)},$.onFileTypeChange=function(e){pe.onFileTypeChange(e)},$.showForegroundSelection=n.observable(!0),$.showBackgroundSelection=n.observable(!0),$.settingsSchemes=n.observableArray([]),$.removeFromSettingsSchemes=function(e){for(var t=-1,a=0;a<$.settingsSchemes().length;a++)if($.settingsSchemes()[a]===e){t=a;break}a>-1?$.settingsSchemes.splice(t,1):alert("bad index for settingsSchemes: "+t)};var Ce;$.setNewAction=function(e){Ce=e},$.isNewAction=function(){return Ce},$.filesList=n.observableArray();var Be=[];$.setFilesList=function(t){if(Be=t,$.filesList(t),$.filesList(U(t)),Ce)e("#newFlowDialogId").dialog("open");else;},$.selectedFile=n.observable(),$.getSelectedFile=function(){return $.isConnectionOK()?_selectedFile:$.selectedFile()},$.isInputInvalid=n.observable(!1),$.validateMessage=n.observable(""),$.newFSNameValue=n.observable(""),$.nameValueEmpty=n.observable(""),$.validateFSName=function(t,a){var n=V.trimMultipleSpaces($.newFSNameValue()),o=a?s.getDirectoriesLabels():$.filesList();$.nameValueEmpty(0===n.length);var i=($.isInputInvalid(),V.containsFSName(o,n)),r=V.isFSNameValid($.newFSNameValue()),l=n.length>0&&(!r||i);$.isInputInvalid(l),e("#newFlowButtonOK").button("option","disabled",$.isInputInvalid()||$.nameValueEmpty()),e("#newFolderButtonOK").button("option","disabled",$.isInputInvalid()||$.nameValueEmpty()),r?i?$.validateMessage("Duplicate name"):$.validateMessage(""):$.validateMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces"),t&&n.length>0&&r&&"Enter"===t.code&&(Ce?(y.createNewDiagram($.manager),e("#newFlowDialogId").dialog("close")):(w.createNewFolder($.manager),e("#newFolderDialogId").dialog("close")))},$.saveAsInputInvalid=n.observable(!1),$.saveAsMessage=n.observable(""),$.saveAsFileNameValue=n.observable(""),$.saveAsNameEmpty=n.observable(""),$.validateSaveAsFileName=function(e){var t=V.trimMultipleSpaces($.editNameValue());if(t.length>0){var a=V.containsFSName($.filesList(),t),n=V.isFSNameValid(t),o=!a&&n;$.isEditNameInvalid(!o)}else $.isEditNameInvalid(!0);a?$.validateNameMessage("Duplicate name"):n?$.validateNameMessage(""):$.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},$.saveAsNewVersion=n.observable(1),$.versionInputInvalid=n.observable(!1),$.validateAsVersion=function(e){var t=($.saveAsNewVersion(),V.isVersionNumber($.saveAsNewVersion()));$.versionInputInvalid(!t),Z()},$.isFlowSaveBlocked=function(){return $.saveAsInputInvalid()||$.saveAsNameEmpty()||$.saveAsNewVersion()&&$.versionInputInvalid()};var ke=n.observable();$.propsLinkSourceName=n.observable(),$.propsLinkSourceLabel=n.observable(),$.propsLinkTargetName=n.observable(),$.propsLinkTargetLabel=n.observable(),$.propsLinkLabel=n.observable(),$.getPropsLink=function(){return ke()},$.getPropsLinkLabelValue=function(){return $.propsLinkLabel()},$.showLinkProps=function(t){ke(t),$.propsLinkSourceName(ke().getLinkSourcePortName()),$.propsLinkSourceLabel(ke().getLinkSourcePortLabel()),$.propsLinkTargetName(ke().getLinkTargetPortName()),$.propsLinkTargetLabel(ke().getLinkTargetPortLabel()),$.propsLinkLabel(ke().getLinkLabel()),e("#linkPropsDialogId").dialog("open")},$.propsFgndVisible=n.observable(!0),$.setPropsFgndVisible=function(e){$.propsFgndVisible(e)},$.propsNodeInputs=n.observableArray();var Oe,Fe;$.getPropsNodeInputsIdx=function(){return Oe},$.getPropsNodeInputsValue=function(){return Fe},$.propsNodeOutputs=n.observableArray();var Me,xe;$.getPropsNodeOutputsIdx=function(){return Me},$.getPropsNodeOutputsValue=function(){return xe},$.propsNodeRefInputs=n.observableArray();var Re,Pe;$.getPropsNodeRefInputsIdx=function(){return Re},$.getPropsNodeRefInputsValue=function(){return Pe},$.propsNodeRefOutputs=n.observableArray();var Ae,Ve;$.getPropsNodeRefOutputsIdx=function(){return Ae},$.getPropsNodeRefOutputsValue=function(){return Ve};var He=n.observable();$.setPropsNode=function(e){He(e)},$.getPropsNode=function(){return He()},$.propsNodeName=n.computed(function(){return He()?He().getName():"?"},this),$.showNodeProps=function(t){He(t),t.getFlowType()===c.flowType().DB_TABLE&&t.closeDBEditors(),g.setNodeCategory(t.getNodeCategory()),$.propsNodeInputs(He().getInputPortsProperties()),$.propsNodeOutputs(He().getOutputPortsProperties()),$.propsNodeRefInputs(He().getRefInPortsProperties()),$.propsNodeRefOutputs(He().getRefOutPortsProperties()),$.dbNodeRecords(He().getDBRecords()),e("#nodePropsDialogId").dialog("open")},$.dbEditorPath=n.observable("?"),$.setDBEditorPath=function(e){dbEditorPath(e)};var _e=n.observable();$.setPropsPort=function(e){_e(e)},$.getPropsPort=function(){return _e()},$.propsPortName=n.observable(""),$.editPropsNodeInputLabel=function(e){Oe=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeInputsTableId"),a=t.getElementsByTagName("tr");Fe=a[Oe].cells[2].getElementsByTagName("input")[0].value},$.checkPortInputCardinality=function(e){E.editPortInputCardinality(e)},$.editPropsNodeOutputLabel=function(e){Me=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeOutputsTableId"),a=t.getElementsByTagName("tr");xe=a[Me].cells[2].getElementsByTagName("input")[0].value},$.checkPortOutputCardinality=function(e){E.editPortOutputCardinality(e)},$.editPropsNodeRefInputLabel=function(e){Re=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefInputsTableId"),a=t.getElementsByTagName("tr");Pe=a[Re].cells[2].getElementsByTagName("input")[0].value},$.checkPortRefInputCardinality=function(e){E.editPortRefInputCardinality(e)},$.editPropsNodeRefOutputLabel=function(e){Ae=e.target.parentNode.parentNode.rowIndex;var t=document.getElementById("nodeRefOutputsTableId"),a=t.getElementsByTagName("tr");Ve=a[Ae].cells[2].getElementsByTagName("input")[0].value},$.checkPortRefOutputCardinality=function(e){E.editPortRefOutputCardinality(e)},$.isEditNameInvalid=n.observable(!1),$.editNameValue=n.observable(""),$.newFlowNameValue=n.observable(""),$.validateNameMessage=n.observable("");var Ge;$.setOldName=function(e){Ge=e},$.validateInlineNodeName=function(){var e=$.manager.getInlineInputEditor().getCurrentValue(),t=V.trimMultipleSpaces(e);$.validateEditName(t)},$.validateDialogNodeName=function(){var e=V.trimMultipleSpaces($.editNameValue());$.validateEditName(e)},$.validateNewFlowName=function(){var e=V.trimMultipleSpaces($.editNameValue());$.validateEditName(e)},$.validateNewFolderName=function(){var e=V.trimMultipleSpaces($.editNameValue());$.validateEditName(e)},$.validateEditName=function(e){if(e.length>0){var t=V.getAllNames($.manager.getNodeNamesMap()),a=V.isDuplicateName(Ge,e,t),n=V.isNewNodeNameValid(e),o=!a&&n;$.isEditNameInvalid(!o)}else $.isEditNameInvalid(!0);a?$.validateNameMessage("Duplicate name"):n?$.validateNameMessage(""):$.validateNameMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},$.isSchemeNameInvalid=n.observable(!1),$.schemeNameValue=n.observable(""),$.validateSchemeMessage=n.observable(""),$.validateSchemeName=function(){var e=document.getElementById("newSchemeId").value;if(e.length>0){var t=$.manager.getSettingsManager().getSchemeNames(),a=t.includes(e),n=V.isSchemeNameValid(e),o=!a&&n;$.isSchemeNameInvalid(!o)}else $.isSchemeNameInvalid(!1);a?$.validateSchemeMessage("Duplicate name"):n?$.validateSchemeMessage(""):$.validateSchemeMessage("Only alphanumericals, dots, dashes and underscores")},$.isLinkLabelInvalid=n.observable(!1),$.linkLabelValue=n.observable(""),$.validateLinkMessage=n.observable("");var We;$.setOldLinkLabel=function(e){We=e},$.validateLinkLabelName=function(e){var t=V.trimMultipleSpaces($.linkLabelValue());if(t.length>0){var a=t===We||V.isNewLinkLabelValid(t);$.isLinkLabelInvalid(!a)}else $.isLinkLabelInvalid(!1);a?$.validateLinkMessage(""):$.validateLinkMessage("Only alphanumericals, slashes, dots, dashes, underscores and single spaces")},$.isFieldInvalid=n.observable(!1),$.fieldValue=n.observable(""),$.validateFieldMessage=n.observable(""),$.validateFieldName=function(){var e=document.getElementById("inputFieldId").value;if(e.length>0){var t=$.manager.getDBTableEditor().getDBRecordsFields(),a=$.manager.getDBTableEditor().getOldFieldValue(),n=t.includes(e),o=V.isDBFieldValid(e),i=e===a||!n&&o;$.isFieldInvalid(!i)}else $.isFieldInvalid(!1);n?$.validateFieldMessage("Duplicate field"):o?$.validateFieldMessage(""):$.validateFieldMessage("Only alphanumericals, dots, \tdashes and underscores")},$.isKeyInvalid=n.observable(!1),$.validateKeyMessage=n.observable(""),$.validateKeyValue=function(){var e=document.getElementById("inputKeyId").value,t=$.manager.getDBTableEditor().getLabelById($.manager.getDBTableEditor().dbColumnKeys(),e);if($.isKeyInvalid(!1),t.length>0){var a=$.manager.getDBTableEditor().getDBRecordsKeys(),n="PK"===t&&a.includes(t);$.isKeyInvalid(n)}return n?$.validateKeyMessage("Only composite primary key is allowed"):$.validateKeyMessage(""),!n},$.isDuplicateType=n.observable(!1),$.duplicateConstraintMessage=n.observable("Duplicate constraint"),$.pictureURLValue=n.observable(""),$.isPictureURLInvalid=n.observable(!1),$.validatePictureURL=function(e){$.isPictureURLInvalid(!1)},$.showNewFileName=n.observable(),$.showEditedInfo=n.observable(),
$.showDecisionInfo=n.observable(),$.decisionInputPicture=n.observable(),$.decisionEndsPicture=n.observable(),$.isNodeNameInvalid=n.observable(!1),$.newNodeNameValue=n.observable(""),$.invalidNameMessage=n.observable(""),$.resetDecisionIndices=function(){$.updateTrigger(!$.updateTrigger()),p.resetCurrentIndices(),$.decisionInputPicture(p.getCurrentInputPicture()),$.decisionEndsPicture(p.getCurrentEndsPicture())},$.btnFlowH2click=function(){l.getDiagramType()!=c.diagramType().ERD_DB&&l.getDiagramType()!=c.diagramType().ERD_LOG&&$.changeFlowDirection(c.flow().VERTICAL)},$.btnFlowV2click=function(){l.getDiagramType()!=c.diagramType().ERD_DB&&l.getDiagramType()!=c.diagramType().ERD_LOG&&$.changeFlowDirection(c.flow().HORIZONTAL)},$.changeFlowDirection=function(e){Y(e)};var Ke=!1;$.hasFlowDirectionChange=function(){return Ke},$.setFlowDirectionChange=function(){Ke=!0},$.resetFlowDirectionChange=function(){Ke=!1},$.isHorizontal=n.observable(!1),$.layoutModeText=n.observable(l.getLayoutModeText()),$.diagramModeText=n.observable(l.getDiagramModeText());var ze=(e("#newId"),e("#openId")),Ue=(e("#importId"),e("#inOutId")),Ze=e("#undoId"),Ye=e("#redoId"),Xe=e("#findId"),je=e("#refreshId"),qe=e("#clearId"),Je=e("#leftId"),$e=e("#rightId"),Qe=e("#deleteId"),et=e("#copyId"),tt=e("#pasteId"),at=e("#saveId"),nt=e("#saveAsId"),ot=e("#btnFlowVId");e("#btnThumbnailId");$.updateWindow=function(t){$.updateTrigger(!$.updateTrigger()),$.isHorizontal(l.getFlowDirection()===c.flow().HORIZONTAL),$.layoutModeText(l.getLayoutModeText()),$.diagramModeText(l.getDiagramModeText());var a=!l.isEditMode();r.updateMenus($),ze.attr("disabled",!$.isConnectionOK()),Ue.attr("disabled",l.getDiagramType()!==c.diagramType().ERD_DB),Ze.attr("disabled",a||!$.manager.canUndo()).attr("title",$.manager.getUndoName()),Ye.attr("disabled",a||!$.manager.canRedo()).attr("title",$.manager.getRedoName()),Qe.attr("disabled",a||!$.manager.getSelectionManager().hasSelections()),et.attr("disabled",a||!$.manager.canCopy()),tt.attr("disabled",a||!$.manager.readyToPaste()),at.attr("disabled",a||!$.isConnectionOK()||!$.manager.isDirty()||$.manager.isTemplate()),nt.attr("disabled",a||!$.isConnectionOK()||$.manager.getModelHandler().isDiagramEmpty()),je.attr("disabled",!$.isCanvasVisible()),Xe.attr("disabled",!$.isCanvasVisible()),qe.attr("disabled",a||!$.isCanvasVisible()),Je.attr("disabled",!$.manager.hasPreviousDiagram()),$e.attr("disabled",!$.manager.hasNextDiagram()),ot.attr("disabled",l.getAppMode()!==c.appMode().FLOW_MODE),e("#btnFlowHId").attr("disabled",a),e("#btnFlowVId").attr("disabled",a),"visible"!==document.getElementById("blockResizeId").style.visibility||fe?fe&&(document.getElementById("blockResizeId").style.visibility="hidden",fe=!1):fe=!0,"visible"!==document.getElementById("switchResizeId").style.visibility||Ee?Ee&&(document.getElementById("switchResizeId").style.visibility="hidden",Ee=!1):Ee=!0,$.manager.isInitialResizeMode()&&$.manager.getModelHandler().isDiagramEmpty()?(ie.spinner("enable"),se.spinner("enable")):(ie.spinner("disable"),se.spinner("disable")),$.disableInactiveTypeButtons(!$.manager.getModelHandler().isDiagramEmpty())},$.initData=function(){$.updateWindow()},$.galleryFlowNodes=n.pureComputed(function(){return $.updateTrigger(),l.getFlowDirection()===c.flow().HORIZONTAL?u.getFlowNodesH():u.getFlowNodesV()}),$.galleryMiscNodes=n.pureComputed(function(){return $.updateTrigger(),l.getFlowDirection()===c.flow().HORIZONTAL?u.getMiscNodesH():u.getMiscNodesV()}),$.galleryERDNodes=n.pureComputed(function(){return $.updateTrigger(),u.getERDNodes()}),$.galleryLOGNodes=n.pureComputed(function(){return $.updateTrigger(),u.getLOGNodes()}),$.galleryProcNodes=n.pureComputed(function(){return $.updateTrigger(),u.getProcNodes()}),$.pageNodes=n.pureComputed(function(){$.updateTrigger();for(var e=[],t=l.getFlowDirection()===c.flow().HORIZONTAL?u.getHPageItems():u.getVPageItems(),a=0;a<t.length;a++)e.push(t[a]);return e}),$.diagramDisplayName=n.observable(ue),$.setDiagramDisplayName=function(e){e&&e.length>0?($.showTemplatesOnly()&&(e=c.templateToken()+": "+e),$.diagramDisplayName(e)):$.diagramDisplayName(ue)},$.cnxInfo=n.observable(!1),$.taskActionInputValue=n.observable(""),$.taskServiceInputValue=n.observable(""),$.taskSubscribeInputValue=n.observable(""),$.taskPublishInputValue=n.observable(""),$.taskOperationInputValue=n.observable(""),$.taskExpressionInputValue=n.observable(""),$.showTaskAction=n.observable(!0),$.showTaskService=n.observable(!0),$.showTaskSubscribe=n.observable(!0),$.showTaskPublish=n.observable(!0),$.showTaskOperation=n.observable(!0),$.showTaskExpression=n.observable(!0),$.taskActionSelected=n.observable(!0),$.taskServiceSelected=n.observable(!1),$.taskSubscribeSelected=n.observable(!1),$.taskPublishSelected=n.observable(!1),$.taskOperationSelected=n.observable(!1),$.taskExpressionSelected=n.observable(!1),$.nodeActionList=n.observableArray(),$.nodeOperationList=n.observableArray(),$.nodeServiceList=n.observableArray(),$.nodePublishList=n.observableArray(),$.nodeSubscribeList=n.observableArray(),$.showTaskEditorOnLeft=n.observable(!1),$.aboutTitle=n.observable(""),$.aboutVersion=n.observable(""),$.aboutText=n.observable(""),$.aboutSources=n.observable(""),$.aboutCopyright=n.observable(""),$.showAboutBox=function(t,a,n,o,i){$.aboutTitle(t),$.aboutVersion(a),$.aboutText(n),$.aboutSources(o),e("#aboutDialogId").dialog("open")},$.welcomeTitle=n.observable(""),$.welcomeGreeting=n.observable(""),$.welcomeTo=n.observable(""),$.welcomeTip=n.observable(""),$.showWelcomeBox=function(t,a,n,o){$.welcomeTitle(t),$.welcomeGreeting(a),$.welcomeTo(n),$.welcomeTip(o),e("#welcomeDialogId").dialog("open")},$.isStartPage=n.observable(!1);document.getElementById("startToTopBtn");$.isStartPageOpen=function(){return $.isStartPage()},$.setStartPageOpen=function(e){$.isStartPage(e)},$.onStartToTopClick=function(t){e("#navbarId").show(),setTimeout(function(){e("#topContainerId").show(),$.manager.refreshDiagramOnEdit(!0)},20)},$.startTitle=n.observable(""),$.startTopText1=n.observable(""),$.startTopText2=n.observable(""),$.startFlowTitle=n.observable(""),$.startERDTitle=n.observable(""),$.startLOGTitle=n.observable(""),$.startProcessTitle=n.observable(""),$.showStartPage=function(e,t,a,n,o,i,s){$.startTitle(e),$.startTopText1(t),$.startTopText2(a),$.startFlowTitle(n),$.startERDTitle(o),$.startLOGTitle(i),$.startProcessTitle(s),$.manager.getStartPageEditor().showStartPageEditor($.manager)},$.callStartPage=function(t){var a=O.getTitle(),n=O.getTopText1(),o=O.getTopText2(),i=O.getFlowTitle(),s=O.getERDTitle(),r=O.getLOGTitle();procTitle=O.getProcessTitle(),e("#paletteCtrId").hide(),$.manager.clearNamesCache(),$.getFlowManager().clearDiagram(),$.getFlowManager().refreshDiagram(),$.showStartPage(a,n,o,i,s,r,procTitle)},$.templatesList=n.observableArray([""]),$.flowTemplates=n.observableArray($.manager.getTemplates().getFlowTemplatesList()),$.dbTemplates=n.observableArray($.manager.getTemplates().getDBTemplatesList()),$.logTemplates=n.observableArray($.manager.getTemplates().getLOGTemplatesList()),$.procTemplates=n.observableArray($.manager.getTemplates().getPROCTemplatesList()),$.showFlowTemplates=n.observable(l.getDiagramType()===c.diagramType().FLOWCHART),$.showDBTemplates=n.observable(l.getDiagramType()===c.diagramType().ERD_DB),$.showLOGTemplates=n.observable(l.getDiagramType()===c.diagramType().ERD_LOG),$.showPROCTemplates=n.observable(l.getDiagramType()===c.diagramType().PROCESS),$.flowTabVisible=n.observable(),$.erdTabVisible=n.observable(),$.logTabVisible=n.observable(),$.procTabVisible=n.observable(),$.setFlowTabVisible=function(){j(),$.flowTabVisible(!0)},$.setERDTabVisible=function(){j(),$.erdTabVisible(!0)},$.setLOGTabVisible=function(){j(),$.logTabVisible(!0)},$.setPROCTabVisible=function(){j(),$.procTabVisible(!0)},$.infoMessage=n.observable(""),$.infoMessageVisible=n.observable(),$.showInfoMessage=function(t,a){$.infoMessage(t),$.infoMessageVisible(!1),e("#infoDialogId").dialog("open"),a&&e("#infoDialogId").dialog("option","title",a)},e("#infoDialogId").on("dialogopen",function(t,a){setTimeout(function(){$.infoMessageVisible(!0),e("#infoTextId").scrollTop(0)},200)});var it;$.getConfirmFlag=function(){return it},$.setConfirmFlag=function(e){it=e},$.confirmMessage=n.observable(""),$.showConfirmMessage=function(t,a,n){x.initDialog($.manager),$.confirmMessage(t),a&&re.dialog("option","title",a),n&&(e(e("button",re.parent())[1]).text(n.first),e(e("button",re.parent())[2]).text(n.second)),re.dialog("open")},$.isShowThumbnail=n.observable(),$.btnThumbnailShow=function(){$.isShowThumbnail(!0),e("#thumbnailDialogId").dialog("open"),$.repaintDiagram()},$.btnThumbnailHide=function(){$.isShowThumbnail(!1),$.repaintDiagram()},$.overlayText=n.observable("");var st=e("#saveOverlayId");$.showOverlayMessage=function(e,t){var a=t||400;$.overlayText(e),st.show(),setTimeout(function(){st.fadeOut(a)},a+200)},$.bottomMessageText=n.observable("");var rt=e("#bottomOverlayId");$.showBottomMessage=function(e,t){var a=t||1e3;$.bottomMessageText(e),rt.show(),setTimeout(function(){rt.fadeOut(a)},a+200)},ae.addEventListener("scroll",function(e){e.currentTarget.scrollLeft||e.currentTarget.scrollRight}),le.addEventListener("mousemove",function(e){q()},!1),le.onchange=function(){q()};var lt;$.getDraggedPaletteId=function(){return lt},$.setDraggedPaletteId=function(e){lt=e},$.onPaletteDragStart=function(e){parseInt(e.target.id)===c.flowType().DB_TABLE_2||parseInt(e.target.id)===c.flowType().DB_TABLE_3||parseInt(e.target.id)===c.flowType().DB_TABLE_4?(lt=c.flowType().DB_TABLE,e.dataTransfer.setData("text",c.flowType().DB_TABLE),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===c.flowType().ENTITY_W?(lt=c.flowType().ENTITY,e.dataTransfer.setData("text",c.flowType().ENTITY),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===c.flowType().RELATION_W?(lt=c.flowType().RELATION,e.dataTransfer.setData("text",c.flowType().RELATION),e.dataTransfer.setData("altType",e.target.id)):parseInt(e.target.id)===c.flowType().ATTR_MULTI||parseInt(e.target.id)===c.flowType().ATTR_DRV?(lt=c.flowType().ATTRIBUTE,e.dataTransfer.setData("text",c.flowType().ATTRIBUTE),e.dataTransfer.setData("altType",e.target.id)):(lt=e.target.id,e.dataTransfer.setData("text",e.target.id))},$.onPaletteDragEnd=function(e){var t=Q.getBoundingClientRect();e.clientX>t.left&&e.clientX<t.right&&e.clientY>t.top&&e.clientY<t.bottom||$.manager.getDnDHandler().resetDrag()},$.requestFocus=function(){},$.isControlPressed=function(){return ge},$.setControlPressed=function(e){ge=e},$.isEditControlPressed=function(){return me},$.setEditControlPressed=function(e){me=e},$.isShiftPressed=function(){return be},$.setShiftPressed=function(e){be=e},window.onresize=function(){ce.style.height=window.innerHeight+"px",e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),J(),$.manager.getInlineInputEditor().relocateInlineFieldEditor(),$.manager.getInlineAreaEditor().relocateInlineAreaEditor(),$.manager.getDBTableEditor().relocateDBTableEditor(),$.manager.getDBCardinalityEditor().relocateDBCardinalityEditor(),$.manager.getDecisionLayoutEditor().relocateDecisionLayoutEditor(),$.manager.getFlowTasksEditor().relocateFlowTasksEditor(),E.relocateDialog(),q(),$.repaintDiagram()},window.onscroll=function(){$.manager.getDBTableEditor().relocateDBTableEditor(),e("#thumbnailDialogId").dialog({position:{my:"right bottom",at:"right-8 bottom-6",of:window}}),$.repaintDiagram()};var dt=0,ct=e("#containerId");return $.repaintDiagram=function(){$.hideContainerBar(),$.hideSwitchBar(),$.manager.paintDiagram()},n.applyBindings($),$.initData(),{initFlowDemo:function(){window.scrollTo(0,0),e(window).trigger("resize"),$.setProgressBarVisible(!1),$.showOverlayMessage("Connecting to server...",1e3),o.checkServerConnection($.manager)}}});